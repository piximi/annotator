{"version":3,"sources":["types/ToolType.ts","types/AnnotationModeType.ts","reportWebVitals.ts","store/selectors/annotatingSelector.ts","store/selectors/boundingClientRectSelector.ts","store/selectors/categoryCountsSelector.ts","store/selectors/categoriesSelector.ts","store/selectors/createdCategoriesSelector.ts","store/selectors/imageInstancesSelector.ts","store/selectors/imageSelector.ts","store/selectors/imageOriginalSrcSelector.ts","store/selectors/invertModeSelector.ts","store/selectors/selectedCategorySelector.ts","store/selectors/selectionModeSelector.ts","store/selectors/stageHeightSelector.ts","store/selectors/stageScaleSelector.ts","store/selectors/stageWidthSelector.ts","store/selectors/toolTypeSelector.ts","store/selectors/unknownCategorySelector.ts","store/selectors/zoomToolOptionsSelector.ts","store/selectors/zoomSelectionSelector.ts","images/texture.png","components/ImageViewer/CategoriesList/CategoriesList/CategoriesList.css.ts","components/ImageViewer/CategoriesList/CollapsibleList/CollapsibleList.tsx","images/cell-painting.png","types/LanguageType.ts","types/ZoomModeType.ts","image/rle.ts","image/imageHelper.ts","store/slices/applicationSlice.ts","store/slices/toolOptionsSlice.ts","store/reducer/reducer.ts","store/stores/store.ts","store/thunks/echoThunk.ts","store/thunks/loadLayersModelThunk.ts","components/ImageViewer/CategoriesList/CategoryListItemCheckbox/CategoryListItemCheckbox.tsx","store/selectors/languageSelector.ts","translations/de.ts","translations/en.ts","translations/fas.ts","translations/fi.ts","translations/gr.ts","translations/hi.ts","translations/hu.ts","translations/se.ts","translations/fr.ts","hooks/useTranslation/useTranslation.tsx","components/ImageViewer/CategoriesList/CategoryMenu/HideOrShowCategoryMenuItem/HideOrShowCategoryMenuItem.tsx","components/ImageViewer/CategoriesList/CategoryMenu/HideOtherCategoriesMenuItem/HideOtherCategoriesMenuItem.tsx","store/selectors/imagesSelector.ts","components/ImageViewer/CategoriesList/CategoryMenu/CategoryMenu/CategoryMenu.tsx","components/ImageViewer/CategoriesList/DeleteCategoryDialog/DeleteCategoryDialog.tsx","components/ImageViewer/CategoriesList/ColorIcon/ColorIcon.css.ts","components/ImageViewer/CategoriesList/ColorIcon/ColorIcon.tsx","components/ImageViewer/CategoriesList/EditCategoryDialog/EditCategoryDialog.css.ts","components/ImageViewer/CategoriesList/EditCategoryDialog/EditCategoryDialog.tsx","image/Tool/Tool/Tool.ts","image/simplify/simplify.ts","image/polygon-fill/util.ts","image/polygon-fill/slpf.ts","image/Tool/AnnotationTool/AnnotationTool/AnnotationTool.ts","image/flood.ts","image/Tool/AnnotationTool/ColorAnnotationTool/ColorAnnotationTool.ts","image/Tool/AnnotationTool/EllipticalAnnotationTool/EllipticalAnnotationTool.ts","image/Tool/AnnotationTool/LassoAnnotationTool/LassoAnnotationTool.ts","image/pathfinder/NodeHeap.ts","image/pathfinder/PathFinder.ts","image/GraphHelper.ts","image/Tool/AnnotationTool/MagneticAnnotationTool/MagneticAnnotationTool.ts","image/Tool/AnnotationTool/RectangularAnnotationTool/RectangularAnnotationTool.ts","image/Tool/AnnotationTool/ObjectAnnotationTool/ObjectAnnotationTool.ts","image/Tool/AnnotationTool/PenAnnotationTool/PenAnnotationTool.ts","image/Tool/AnnotationTool/PolygonalAnnotationTool/PolygonalAnnotationTool.ts","image/Tool/AnnotationTool/QuickAnnotationTool/QuickAnnotationTool.ts","image/slic.ts","store/selectors/penSelectionBrushSizeSelector.ts","store/selectors/quickSelectionBrushSizeSelector.ts","store/selectors/imageSrcSelector.ts","hooks/useCursor/useCursor.ts","hooks/useDialog/useDialog.ts","hooks/useMarchingAnts/useMarchingAnts.ts","store/selectors/scaledImageWidthSelector.ts","store/selectors/soundEnabledSelector.ts","components/ImageViewer/SettingsButton/SettingsDialog/SettingsDialog.css.ts","components/ImageViewer/SettingsButton/SettingsDialog/SettingsDialog.tsx","components/ImageViewer/CategoriesList/CreateCategoryListItem/CreateCategoryDialog/CreateCategoryDialog.css.ts","components/ImageViewer/CategoriesList/CreateCategoryListItem/CreateCategoryDialog/CreateCategoryDialog.tsx","store/selectors/selectedAnnotationsIdsSelector.ts","store/selectors/activeImageIdSelector.ts","components/ImageViewer/CategoriesList/ImageMenu/ImageMenu.tsx","components/ImageViewer/CategoriesList/DeleteAllAnnotationsDialog/DeleteAllAnnotationsDialog.tsx","store/selectors/allSerializedAnnotationsSelector.ts","components/ImageViewer/CategoriesList/SaveMenu/SaveProjectFileMenuItem.tsx","components/ImageViewer/CategoriesList/SaveMenu/ExportAnnotationsAsImagesMenuItem.tsx","components/ImageViewer/CategoriesList/SaveMenu/ExportAnnotationsAsMatrixMenuItem.tsx","components/ImageViewer/CategoriesList/SaveMenu/SaveMenu.tsx","components/ImageViewer/CategoriesList/OpenMenu/OpenImageMenuItem.tsx","components/ImageViewer/CategoriesList/OpenMenu/OpenProjectFileMenuItem.tsx","images/malaria.png","components/ImageViewer/CategoriesList/ExampleImageDialog/ExampleImageDialog.tsx","components/ImageViewer/CategoriesList/OpenMenu/OpenExampleImageMenuItem.tsx","components/ImageViewer/CategoriesList/OpenMenu/OpenMenu.tsx","components/ImageViewer/CategoriesList/HelpDialog/HelpDialog.tsx","components/ImageViewer/CategoriesList/HelpDialog/OpenImageHelpDialog.tsx","components/ImageViewer/CategoriesList/HelpDialog/HelpDialog.css.ts","components/ImageViewer/CategoriesList/HelpDialog/KeyboardKey.tsx","components/ImageViewer/CategoriesList/HelpDialog/HelpWindowToolTitle.tsx","components/ImageViewer/CategoriesList/HelpDialog/MakeAnnotationsHelpDialog.tsx","components/ImageViewer/CategoriesList/HelpDialog/ManipulateCanvasHelpDialog.tsx","components/ImageViewer/CategoriesList/HelpDialog/ChangingAnnotationsHelpDialog.tsx","components/ImageViewer/CategoriesList/HelpDialog/SavingProjectHelpDialog.tsx","components/ImageViewer/CategoriesList/CategoriesList/CategoriesList.tsx","components/ImageViewer/ToolOptions/ToolOptions/ToolOptions.css.ts","components/icons/CheckboxChecked.svg","components/icons/CheckboxUnchecked.svg","components/icons/ColorAdjustment.svg","components/icons/ColorAnnotation.svg","components/icons/EllipticalAnnotation.svg","components/icons/Hand.svg","components/icons/LassoAnnotation.svg","components/icons/MagneticAnnotation.svg","components/icons/ObjectAnnotation.svg","components/icons/FreehandAnnotation.svg","components/icons/PolygonalAnnotation.svg","components/icons/QuickAnnotation.svg","components/icons/RadioChecked.svg","components/icons/RadioUnchecked.svg","components/icons/RectangularAnnotation.svg","components/icons/Selection.svg","components/icons/Zoom.svg","components/ImageViewer/ToolOptions/AnnotationMode/AnnotationModeTooltip/AnnotationModeTooltip.css.ts","components/ImageViewer/ToolOptions/AnnotationMode/AnnotationModeTooltip/AnnotationModeTooltip.tsx","components/ImageViewer/ToolOptions/AnnotationMode/NewTooltip/NewTooltip.tsx","components/ImageViewer/ToolOptions/AnnotationMode/AddTooltip/AddTooltip.tsx","components/ImageViewer/ToolOptions/AnnotationMode/SubtractTooltip/SubtractTooltip.tsx","components/ImageViewer/ToolOptions/AnnotationMode/IntersectionTooltip/IntersectionTooltip.tsx","components/ImageViewer/ToolOptions/AnnotationMode/AnnotationMode/AnnotationMode.tsx","components/ImageViewer/ToolOptions/InformationBox/InformationBox.css.ts","components/ImageViewer/ToolOptions/InformationBox/InformationBox.tsx","components/icons/InvertAnnotation.svg","components/ImageViewer/ToolOptions/InvertAnnotation/InvertAnnotation.tsx","components/ImageViewer/ToolOptions/RectangularAnnotationOptions/RectangularAnnotationOptions.tsx","components/ImageViewer/ToolOptions/EllipticalAnnotationOptions/EllipticalAnnotationOptions.tsx","components/ImageViewer/ToolOptions/FreehandAnnotationOptions/FreehandAnnotationOptions.tsx","components/ImageViewer/ToolOptions/LassoAnnotationOptions/LassoAnnotationOptions.tsx","components/ImageViewer/ToolOptions/PolygonalAnnotationOptions/PolygonalAnnotationOptions.tsx","components/ImageViewer/ToolOptions/MagneticAnnotationOptions/MagneticAnnotationOptions.tsx","components/ImageViewer/ToolOptions/ColorAnnotationOptions/ColorAnnotationOptions.tsx","components/ImageViewer/ToolOptions/QuickAnnotationOptions/QuickAnnotationOptions.tsx","components/ImageViewer/ToolOptions/ObjectAnnotationOptions/ObjectAnnotationOptions.tsx","store/selectors/offsetSelector.ts","components/ImageViewer/ToolOptions/ZoomOptions/ZoomOptions.tsx","components/ImageViewer/ToolOptions/HandToolOptions/HandToolOptions.tsx","store/selectors/intensityRangeSelector.ts","store/selectors/imageShapeSelector.ts","components/ImageViewer/ToolOptions/ColorAdjustmentOptions/ChannelsList/ChannelsList.tsx","components/ImageViewer/ToolOptions/ColorAdjustmentOptions/ColorAdjustmentOptions/ColorAdjustmentOptions.tsx","store/selectors/selectedAnnotationsSelector.ts","store/selectors/unselectedAnnotationsSelector.ts","components/ImageViewer/ToolOptions/PointerSelectionOptions/PointerSelectionOptions.tsx","components/ImageViewer/ToolOptions/ToolOptions/ToolOptions.tsx","components/ImageViewer/Tools/Tool/Tool.css.ts","components/ImageViewer/Tools/Tool/ToolBarToolTitle.tsx","components/ImageViewer/Tools/Tool/Tool.tsx","components/ImageViewer/Tools/Tools/Tools.css.ts","components/ImageViewer/Tools/Tools/Tools.tsx","store/selectors/scaledImageHeightSelector.ts","components/ImageViewer/Content/Stage/Image/Image.tsx","components/ImageViewer/Content/Stage/Selection/EllipticalSelection/EllipticalSelection.tsx","components/ImageViewer/Content/Stage/Selection/LassoSelection/LassoSelection.tsx","components/ImageViewer/Content/Stage/Selection/MagneticSelection/MagneticSelection.tsx","components/ImageViewer/Content/Stage/Selection/ObjectSelection/ObjectSelection.tsx","components/ImageViewer/Content/Stage/Selection/PolygonalSelection/PolygonalSelection.tsx","components/ImageViewer/Content/Stage/Selection/RectangularSelection/RectangularSelection.tsx","components/ImageViewer/Content/Stage/Selection/ColorSelection/ColorSelection.tsx","components/ImageViewer/Content/Stage/Selection/QuickSelection/QuickSelection.tsx","components/ImageViewer/Content/Stage/Selection/PenSelection/PenSelection.tsx","components/ImageViewer/Content/Stage/Selection/ZoomSelection/ZoomSelection.tsx","components/ImageViewer/Content/Stage/Selection/Selection/Selection.tsx","store/selectors/annotatedSelector.ts","components/ImageViewer/Content/Stage/Selecting/Selecting.tsx","components/ImageViewer/Content/Stage/ColorAnnotationToolTip/ColorAnnotationToolTip.tsx","sounds/pop-up-on.mp3","sounds/pop-up-off.mp3","components/ImageViewer/Content/Stage/Layer/Layer.tsx","store/selectors/selectedAnnotationSelector.ts","store/selectors/imageWidthSelector.ts","store/selectors/imageHeightSelector.ts","components/ImageViewer/Content/Stage/Transformer/Transformer.tsx","components/ImageViewer/Content/Stage/Transformers/Transformers.tsx","store/selectors/stagePositionSelector.ts","components/ImageViewer/Content/Stage/PenAnnotationToolTip/PenAnnotationToolTip.tsx","store/selectors/visibleCategoriesSelector.ts","image/toRGBA.ts","components/ImageViewer/Content/Stage/Annotations/ConfirmedAnnotations/Annotation/Annotation.tsx","components/ImageViewer/Content/Stage/Annotations/ConfirmedAnnotations/ConfirmedAnnotations.tsx","components/ImageViewer/Content/Stage/Annotations/SelectedAnnotation/SelectedAnnotation.tsx","components/ImageViewer/Content/Stage/Annotations/SelectedAnnotations/SelectedAnnotations.tsx","components/ImageViewer/Content/Stage/Annotations/Annotations.tsx","store/selectors/pointerSelectionSelector.ts","components/ImageViewer/Content/Stage/Selection/PointerSelection/PointerSelection.tsx","store/selectors/currentIndexSelector.ts","hooks/usePointer/usePointer.ts","components/ImageViewer/Content/Stage/Stage/Stage.tsx","hooks/useZoom/useZoom.ts","hooks/useAnnotationTool/useAnnotationTool.ts","hooks/useWindowFocusHandler/useWindowFocusHandler.ts","hooks/useKeyboardShortcuts/useKeyboardShortcuts.tsx","hooks/useHandTool/useHandTool.tsx","components/ImageViewer/Content/Content/Content.css.ts","components/ImageViewer/Content/Content/Content.tsx","hooks/useBoundingClientRect/useBoundingClientRect.ts","components/ImageViewer/ImageViewer/ImageViewer.css.ts","components/ImageViewer/ImageViewer/theme.ts","components/ImageViewer/ImageViewer/ImageViewer.tsx","i18n.ts","index.tsx"],"names":["ToolType","AnnotationModeType","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","annotatingSelector","state","present","annotating","boundingClientRectSelector","boundingClientRect","categoryCountsSelector","catDict","categories","id","images","image","annotations","categoryId","categoriesSelector","createdCategoriesSelector","filter","category","sortBy","imageInstancesSelector","length","find","activeImageId","imageSelector","imageOriginalSrcSelector","originalSrc","invertModeSelector","invertMode","selectedCategorySelector","_","selectedCategory","selectionModeSelector","selectionMode","stageHeightSelector","stageHeight","stageScaleSelector","stageScale","stageWidthSelector","stageWidth","toolTypeSelector","toolType","unknownCategorySelector","zoomToolOptionsSelector","toolOptions","zoom","zoomSelectionSelector","zoomSelection","useStyles","makeStyles","theme","appBar","backgroundColor","borderBottom","boxShadow","position","drawer","flexShrink","width","spacing","iconButton","marginLeft","marginRight","paper","zIndex","toolbar","mixins","backgroundImage","texture","CollapsibleList","children","dense","closed","primary","React","useState","collapsed","setCollapsed","List","ListItem","button","onClick","ListItemIcon","ListItemText","Collapse","in","timeout","unmountOnExit","component","disablePadding","LanguageType","ZoomModeType","decode","encoded","decoded","background","i","j","push","Uint8ClampedArray","encode","lastElement","lastSequenceSize","connectPoints","coordinates","connectedPoints","slice","current","next","forEach","points","drawLine","p","q","x","y","x1","y1","dx","dy","step","coords","Math","round","abs","getIdx","nchannels","index","floor","colorOverlayROI","encodedMask","boundingBox","imageWidth","imageHeight","color","decodedData","endX","min","endY","boxWidth","boxHeight","croppedImage","ImageJS","components","alpha","colorROIImage","checkNeighbors","arr","getPixelXY","height","setPixelXY","src","toDataURL","useCanvas","Image","replaceDuplicateName","name","names","currentName","includes","saveAnnotationsAsMasks","zip","map","annotation","Promise","resolve","reject","mask","shape","boundingBoxWidth","boundingBoxHeight","roiMask","fullImageMaskData","Uint8Array","fill","fullImageMask","uri","canvas","document","createElement","ctx","getContext","categoryName","folder","onload","drawImage","toBlob","blob","file","base64","onerror","crossOrigin","flat","importSerializedAnnotations","existingCategories","annotationMask","split","parseInt","newCategories","annotationCategoryId","annotationCategoryColor","annotationCategoryName","visible","annotation_out","annotationBoundingBoxX","annotationBoundingBoxY","annotationBoundingBoxWidth","annotationBoundingBoxHeight","annotationId","initialCategories","initialState","annotated","DOMRect","brightness","channels","range","currentIndex","contrast","exposure","hue","undefined","language","English","offset","penSelectionBrushSize","pointerSelection","dragging","minimum","maximum","selecting","quickSelectionBrushSize","saturation","selectedAnnotation","selectedAnnotations","New","soundEnabled","stagePosition","RectangularAnnotation","vibrance","applicationSlice","createSlice","reducers","addImages","action","imageNames","updatedImages","payload","newImages","initialName","updatedName","deleteCategory","deleteImage","deleteAllInstances","deleteImageInstances","imageId","deleteImageInstance","updatedAnnotations","instance","openAnnotations","loaded","avatar","imageData","imageFilename","imageChannels","frames","imageFrames","planes","imagePlanes","setAnnotated","setAnnotating","setBoundingClientRect","setBrightness","setCategories","setCategoryVisibility","setContrast","setCurrentIndex","setExposure","setHue","setActiveImage","activeImage","defaultChannels","setImageInstances","instances","setImageSrc","setImages","setChannels","setInvertMode","setLanguage","setOffset","setOperation","operation","setPenSelectionBrushSize","setPointerSelection","setQuickSelectionBrushSize","setSaturation","setSelectedCategory","setSelectedAnnotations","setSelectionMode","setStageHeight","setStagePosition","setStageScale","setStageWidth","setSoundEnabled","setVibrance","setZoomSelection","extraReducers","console","info","actions","colorAdjustment","blackPoint","highlights","shadows","automaticCentering","mode","In","scale","toActualSize","toFit","toolOptionsSlice","setColorAdjustmentOptions","options","setZoomToolOptions","undoable","reducer","currentState","previousHistory","type","groupBy","groupByActionTypes","combineReducers","devTools","enhancers","Sentry","middleware","logger","thunk","preloadedState","store","configureStore","echo","message","a","createAsyncThunk","loadLayersModelThunk","path","tensorflow","CategoryListItemCheckbox","dispatch","useDispatch","Checkbox","checked","checkedIcon","style","disableRipple","edge","icon","tabIndex","languageSelector","de","translation","Cancel","Categories","Description","Edit","Help","Logo","Model","Open","Save","Settings","Unknown","en","fas","Create","Export","Intersection","Pointer","Name","Zoom","fi","gr","hi","hu","se","fr","useTranslation","useSelector","word","Farsi","Finnish","French","German","Greek","Hindi","Hungarian","HideOrShowCategoryMenuItem","onCloseCategoryMenu","t","translatedHide","translatedShow","MenuItem","event","Typography","variant","HideOtherCategoriesMenuItem","cat","imagesSelector","CategoryMenu","anchorElCategoryMenu","openCategoryMenu","onOpenDeleteCategoryDialog","onOpenEditCategoryDialog","Menu","anchorEl","anchorOrigin","horizontal","vertical","getContentAnchorEl","onClose","open","transformOrigin","MenuList","Divider","existAnnotations","DeleteCategoryDialog","selections","unknownCategory","Dialog","disableBackdropClick","fullWidth","DialogTitle","DialogContent","DialogActions","Button","alert","transition","transitions","create","duration","leavingScreen","easing","sharp","appBarShift","enteringScreen","easeOut","card","classifierSettingsDialogContent","marginTop","chip","borderWidth","fontSize","colorPicker","margin","container","paddingBottom","paddingTop","createCategoryDialogContent","paddingLeft","createCategoryDialogGrid","createCategoryDialogItem","drawerHeader","alignItems","display","drawerPaper","fileInput","gridList","transform","gridTileBar","gridTileBarIconButton","imageDialogAppBar","imageDialogContent","imageSelected","border","borderRadius","imageUnselected","main","flexGrow","padding","mainShift","media","progress","settingsDialogAppBar","slider","sliderInput","COLORS","ColorIcon","onColorChange","classes","colorMenuAnchorEl","setColorMenuAnchorEl","colorPopupOpen","Boolean","onCloseColorPicker","IconButton","currentTarget","Avatar","Popover","className","colors","onChange","EditCategoryDialog","onCloseDialog","openDialog","setColor","useEffect","setName","Grid","item","xs","hex","TextField","autoFocus","label","target","value","updatedCategories","v","Tool","this","getSqDist","p1","p2","getSqSegDist","simplifyDPStep","first","last","sqTolerance","simplified","maxSqDist","sqDist","simplifyDouglasPeucker","simplify","tolerance","highestQuality","prevPoint","newPoints","point","len","simplifyRadialDist","lerp","yScan","x2","y2","getYMin","getYMax","getXofYMin","getXofYMax","moveEdges","ET","AET","pop","removeEdges","getSpans","spans","drawSpans","img","fillSpan","AnnotationTool","manager","anchor","origin","buffer","_boundingBox","_mask","getRoiManager","newMaskImage","maskImage","newBoundingBox","encodedMaskData1","boundingBox1","maskData1","maskData2","boundingBox2","newBoundingBoxWidth","newBoundingBoxHeight","newMaskData","deltaX1","deltaY1","deltaX2","deltaY2","b1x","b1y","b2x","b2y","b1i","b2i","inBoundingBox","from","anchorIndex","segment","splice","computeBoundingBoxFromContours","computeMask","crop","data","error","decodedMask1","selectedMask","selectedBoundingBox","invertedBoundingBox","invertedMask","x_mask","y_mask","croppedInvertedMask","updatedBoundingBox","contour","pairs","bitDepth","edges","pointsToEdges","sort","e1","e2","cmp","slpf","getChannel","updatedMask","uuid","dirs","ColorAnnotationTool","roiContour","roiManager","overlayData","initialPosition","toleranceMap","floodMap","toleranceQueue","PriorityQueue","comparator","b","toolTipPosition","maxTol","seen","Set","clear","tol","red","green","blue","grey","maxValue","makeFloodMap","empty","Array","Infinity","queue","idx","add","updateOverlay","diff","ceil","hypot","fromMask","getMasks","roi","getRois","surface","minX","minY","maxX","maxY","imgMask","getBitXY","peek","currentPoint","dequeue","max","dir","newX","newY","has","doFlood","threshold","invert","colorOverlay","fillColor","overlay","EllipticalAnnotationTool","center","radius","resize","convertToPoints","convertToMask","beginPath","ellipse","PI","roiWidth","roiHeight","imageMask","fromCanvas","croppedImageMask","centerX","centerY","foo","sqrt","LassoAnnotationTool","distance","NodeHeap","fScore","node","heapIndex","setNodeId","_up","top","_down","pos","compare","parent","halfLength","left","right","best","NO_PATH","cachedAStarPathSearch","graph","factor","heuristic","fromNode","toNode","fromIdxToCoord","fromId","toId","getNode","cameFrom","to","dest","trace","openSet","distanceToSource","reconstructPath","forEachLinkedNode","visitNeighbour","otherNode","parentId","Number","POSITIVE_INFINITY","tentativeDistance","updateItem","searchNode","newCoord","parentNode","oldDirection","pathDirection","newDirection","log","validNeighbours","xoffsets","yoffsets","output","xoffset","yoffset","row","makeGraph","createGraph","cap","BYTES_PER_ELEMENT","startIdx","dist","addNode","pixels","pixel","addLink","createPathFinder","MagneticAnnotationTool","pathfinder","previous","response","source","destination","connected","sobelFilter","RectangularAnnotationTool","computeBoundingBox","ObjectAnnotationTool","prediction","predict","cropped","fromPixels","getCanvas","batch","resizeBilinear","div","expandDims","squeeze","tile","sub","sign","relu","pad","toPixels","clamped","greyMask","binaryMask","algorithm","rois","thresholded","optimizer","adam","compile","loss","metrics","PenAnnotationTool","brushSize","circlesData","outline","thresholdMask","bbox","arc","croppedRgbMask","computeCircleData","operator","PolygonalAnnotationTool","QuickAnnotationTool","brushsize","colorMasks","currentSuperpixels","lastSuperpixel","superpixels","superpixelsMap","currentMask","regionSize","minRegionSize","imWidth","imHeight","numRegionsX","String","numRegionsY","numRegions","numPixels","masses","currentCenters","Float32Array","newCenters","parameters","mcMap","msMap","distanceMap","xyz","gamma","r","pow","parseFloat","g","xw","yw","Yw","ix","iy","iz","lab","fx","fy","fz","gradient","k","c","d","u","centerx","centery","minEdgeValue","yp","xp","thisEdgeValue","iterations","segmentation","Int32Array","iteration","i1","region","cx","cy","spatial","dR","dG","dB","appearance","mc","ms","iMass","segmentSize","cleanedLabel","numExpanded","neighbor","cleaned","direction","count","slic","getRGBAData","flatPixelCoordinate","superpixel","setPixel","croppedGreyMask","update","penSelectionBrushSizeSelector","quickSelectionBrushSizeSelector","imageSrcSelector","useCursor","cursor","setCursor","EllipticalAnnotation","PenAnnotation","useDialog","setOpen","useCallback","onOpen","useMarchingAnts","dashOffset","setDashOffset","timer","setTimeout","clearTimeout","scaledImageWidthSelector","soundEnabledSelector","form","maginLeft","content","boxLayout","justifyContent","typography","fontWeight","textAlign","menuButton","title","SettingsDialog","fullScreen","AppBar","Toolbar","aria-label","FormControl","InputLabel","shrink","Select","labelId","Arabic","Spanish","FormGroup","FormControlLabel","control","Switch","CreateCategoryDialog","sample","maxWidth","onSubmit","preventDefault","categoryNames","v4","toString","selectedAnnotationsIdsSelector","activeImageIdSelector","ImageMenu","anchorElImageMenu","onCloseImageMenu","openImageMenu","currentImageId","JSZip","all","generateAsync","saveAs","DeleteAllAnnotationsDialog","allSerializedAnnotationsSelector","columns","imageChecksum","serializedAnnotations","findIndex","join","SaveProjectFileMenuItem","popupState","serializedProject","Blob","JSON","stringify","close","ExportAnnotationsAsImagesMenuItem","ExportAnnotationsAsMatrixMenuItem","fullLabelImage","n","saveAnnotationsAsMatrix","SaveMenu","bindMenu","OpenImageMenuItem","accept","hidden","multiple","persist","files","arrayBuffer","load","imageDataURL","onOpenImage","OpenProjectFileMenuItem","reader","FileReader","result","project","parse","serializedImage","readAsText","onOpenProjectFile","ExampleImageDialog","categories_in","examples","description","malaria","malariaAnnotations","cellpainting","cellpaintingAnnotations","role","example","divider","newAnnotations","serializedAnnotation","secondary","OpenExampleImageMenuItem","OpenMenu","HelpDialog","onOpenOpenImagesHelpDialog","onOpenMakeAnnotationsHelpDialog","onOpenManipulatingCanvasHelpDialog","onOpenChangingAnnotationsHelpDialog","onOpenSavingProjectHelpDialog","OpenImageHelpDialog","kbd","paddingInline","whiteSpace","borderColor","borderStyle","lineHeight","KeyboardKey","letter","HelpWindowToolTitle","toolName","MakeAnnotationsHelpDialog","ManipulateCanvasHelpDialog","ChangingAnnotationsHelpDialog","SavingProjectHelpDialog","CategoriesList","createdCategories","selectedAnnotationsIds","categoryCounts","currentImage","onCloseDeleteCategoryDialog","openDeleteCategoryDialog","onCloseEditCategoryDialog","openEditCategoryDialog","onCloseDeleteAllAnnotationsDialog","onOpenDeleteAllAnnotationsDialog","openDeleteAllAnnotationsDialog","setAnchorEl","imageAnchorEl","setImageAnchorEl","onCategoryClick","onCategoryMenuOpen","onCategoryMenuClose","onImageItemClick","evt","Drawer","Box","px","selected","ListItemAvatar","alt","primaryTypographyProps","noWrap","Chip","size","ListItemSecondaryAction","onImageMenuOpen","onOpenCategoryMenu","CreateCategoryListItem","Fragment","HelpListItem","onCloseOpenImagesHelpDialog","openOpenImagesHelpDialog","onCloseManipulatingCanvasHelpDialog","openManipulatingCanvasHelpDialog","onCloseMakeAnnotationsHelpDialog","openMakeAnnotationsHelpDialog","onCloseChangingAnnotationsHelpDialog","openChangingAnnotationsHelpDialog","onCloseSavingProjectHelpDialog","openSavingProjectHelpDialog","OpenListItem","bindTrigger","SaveListItem","SendFeedbackDialog","onSend","input","setInput","DialogContentText","e","multiline","rows","SendFeedbackListItem","text","url","encodeURIComponent","window","SettingsListItem","root","palette","default","settingsPaper","settingsToolbar","operations","operationsPaper","operationsToolbar","logo","applicationDrawer","applicationDrawerHeader","applicationDrawerPaper","_extends","Object","assign","arguments","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","stroke","strokeWidth","fillRule","strokeLinecap","strokeLinejoin","SvgCheckboxChecked","_ref","svgRef","titleId","props","viewBox","xmlns","xmlnsXlink","ref","ForwardRef","SvgCheckboxUnchecked","SvgColorAdjustment","SvgColorAnnotation","SvgEllipticalAnnotation","SvgHand","SvgLassoAnnotation","SvgMagneticAnnotation","SvgObjectAnnotation","SvgFreehandAnnotation","SvgPolygonalAnnotation","SvgQuickAnnotation","SvgRadioChecked","SvgRadioUnchecked","SvgRectangularAnnotation","SvgSelection","SvgZoom","tooltip","AnnotationModeTooltip","Tooltip","placement","NewTooltip","AddTooltip","SubtractTooltip","IntersectionTooltip","AnnotationMode","annotationMode","onClickLabel","RadioGroup","subheader","ListSubheader","Radio","Add","Subtract","Intersect","InformationBox","disableGutters","SvgInvertAnnotation","InvertAnnotation","SvgIcon","RectangularAnnotationOptions","EllipticalAnnotationOptions","FreehandAnnotationOptions","penSelectionBrushSizeBrushSize","Slider","aria-labelledby","changed","LassoAnnotationOptions","PolygonalAnnotationOptions","MagneticAnnotationOptions","ColorAnnotationOptions","QuickAnnotationOptions","setBrushSize","onChangeCommitted","ObjectAnnotationOptions","offsetSelector","ZoomOptions","onModeClick","defaultValue","onSliderChange","valueLabelDisplay","Out","centerOffset","HandToolOptions","channelsSelector","imageShapeSelector","ChannelsList","displayedValues","updateDisplayedValues","imageShape","visibleChannelsIndices","channel","reduce","concat","handler","debounce","values","copiedValues","updatedChannels","onCheckboxChanged","updated","copiedChannels","colorAdjustmentSlider","displayedValue","disabled","newValue","handleSliderChange","sliders","allSliders","ColorAdjustmentOptions","setDisplayedValues","generateDefaultChannels","selectedAnnotationsSelector","unselectedAnnotationsSelector","ids","PointerSelectionOptions","unselectedAnnotations","allAnnotations","desiredAnnotations","onSelectCategory","ToolOptions","activeOperation","method","ColorAdjustment","LassoAnnotation","PolygonalAnnotation","MagneticAnnotation","ColorAnnotation","QuickAnnotation","ObjectAnnotation","Hand","cardContent","cardHeader","cardMedia","ToolBarToolTitle","TooltipCard","Card","raised","CardActionArea","CardContent","child","Tools","OperationType","scaledImageHeightSelector","forwardRef","useImage","filters","setFilters","isEqual","clearCache","IntensityFilter","scaleIntensity","createIntensityFilter","cache","ReactKonva","EllipticalSelection","dash","radiusX","radiusY","LassoSelection","MagneticSelection","ObjectSelection","PolygonalSelection","RectangularSelection","ColorSelection","setImage","QuickSelection","PenSelection","lineJoin","lineCap","ZoomSelection","Selection","tool","annotatedSelector","Selecting","ColorAnnotationToolTip","setText","opacity","Layer","setPosition","imageSmoothingEnabled","selectedAnnotationSelector","imageWidthSelector","imageHeightSelector","Transformer","transformPosition","transformerRef","useRef","boundBox","setBoundBox","rotation","startBox","setStartBox","setCenter","useSound","createAnnotationSoundEffect","playCreateAnnotationSoundEffect","deleteAnnotationSoundEffect","playDeleteAnnotationSoundEffect","getRelativeBox","relativePosition","updateSelectedAnnotation","updatedAnnotation","onMouseEnter","getStage","onMouseLeave","posX","posY","boundBoxFunc","oldBox","newBox","relativeNewBox","onTransform","oppositeAnchorPosition","getActiveAnchor","findOne","getOppositeAnchorPosition","scaledOppositeAnchorPosition","relativeStartBox","onTransformEnd","relativeBoundBox","scaleX","scaleY","roiX","roiY","resizedMaskROI","preserveAspectRatio","scaledOffset","el","getScaledCoordinate","resizedMask","onTransformStart","rotateEnabled","detach","getLayer","batchDraw","cornerRadius","shadowColor","shadowBlur","shadowOffset","Transformers","stagePositionSelector","PenAnnotationToolTip","annotationTool","currentPosition","strokewidth","visibleCategoriesSelector","toRGBA","Annotation","setImageMask","ConfirmedAnnotations","visibleCategories","visibleAnnotations","setVisibleAnnotations","SelectedAnnotation","SelectedAnnotations","Annotations","pointerSelectionSelector","PointerSelection","currentIndexSelector","usePointer","overlappingAnnotationsIds","shift","setShift","useHotkeys","hotkeys","keyup","keydown","currentAnnotation","scaledCurrentPosition","getOverlappingAnnotations","nextAnnotationId","onMouseDown","onMouseUp","annotationsInBox","getAnnotationsInBox","additionalAnnotations","onMouseMove","onPointerClick","Stage","imageRef","stageRef","selectingRef","saveLabelRef","clearLabelRef","setCurrentPosition","scaledImageWidth","scaledImageHeight","zoomAndOffset","scaleBy","zoomIn","deselect","selectedWidth","onWheel","deltaY","useZoom","onZoomDeselect","onZoomMouseUp","onZoomMouseMove","onZoomMouseDown","onZoomWheel","onPointerMouseDown","onPointerMouseMove","onPointerMouseUp","setOperator","loadImage","setup","quickSelectionOperator","useAnnotationTool","useReducer","zoomDragging","zoomSelecting","pointerDragging","pointerSelecting","onBlur","addEventListener","removeEventListener","useWindowFocusHandler","deselectAllTransformers","toArray","tr","deselectAllAnnotations","deselectAnnotation","transformerId","transformer","detachTransformer","combinedMask","combinedBoundingBox","subtract","intersect","annotate","line","nodes","layer","getRelativePointerPosition","getAbsoluteTransform","copy","memoizedOnMouseDown","useMemo","throttled","getPointerPosition","relative","getText","rawImagePosition","func","connect","setTool","useKeyboardShortcuts","draggable","setDraggable","useHandTool","Consumer","getParent","DndProvider","backend","HTML5Backend","Content","onDrop","useLayoutEffect","getBoundingClientRect","useResizeObserver","entry","contentRect","useBoundingClientRect","useDrop","NativeTypes","FILE","drop","collect","monitor","isOver","canDrop","settings","createMuiTheme","overrides","MuiDrawer","paperAnchorDockedLeft","borderRight","paperAnchorDockedRight","borderLeft","MuiListItem","MuiListItemIcon","minWidth","MuiSlider","rail","thumb","track","ImageViewer","setDropped","ThemeProvider","CssBaseline","resources","interpolation","escapeValue","keySeparator","lng","i18n","use","initReactI18next","init","dsn","release","process","npm_package_version","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.375afd65.chunk.js","sourcesContent":["export enum ToolType {\n  ColorAdjustment,\n  ColorAnnotation,\n  EllipticalAnnotation,\n  Hand,\n  LassoAnnotation,\n  MagneticAnnotation,\n  ObjectAnnotation,\n  PenAnnotation,\n  Pointer,\n  PolygonalAnnotation,\n  QuickAnnotation,\n  RectangularAnnotation,\n  Zoom,\n}\n","export enum AnnotationModeType {\n  Add,\n  Intersect,\n  New,\n  Subtract,\n}\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const annotatingSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): boolean => {\n  return state.present.annotating;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const boundingClientRectSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.boundingClientRect;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const categoryCountsSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  const catDict: { [id: string]: number } = {};\n  for (let category of state.present.categories) {\n    catDict[category.id] = 0;\n  }\n  for (let image of state.present.images) {\n    for (let annotation of image.annotations) {\n      catDict[annotation.categoryId] += 1;\n    }\n  }\n  return catDict;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const categoriesSelector = ({ state }: { state: HistoryStateType }) => {\n  return state.present.categories;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { CategoryType } from \"../../types/CategoryType\";\nimport { sortBy } from \"underscore\";\n\nexport const createdCategoriesSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  const categories = state.present.categories.filter(\n    (category: CategoryType) => {\n      return category.id !== \"00000000-0000-0000-0000-000000000000\";\n    }\n  );\n\n  return sortBy(categories, \"name\");\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageInstancesSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.annotations;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageSelector = ({ state }: { state: HistoryStateType }) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageOriginalSrcSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.originalSrc;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const invertModeSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): boolean => {\n  return state.present.invertMode;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport * as _ from \"lodash\";\nimport { CategoryType } from \"../../types/CategoryType\";\n\nexport const selectedCategorySelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): CategoryType => {\n  const category = _.find(\n    state.present.categories,\n    (category: CategoryType) => {\n      return category.id === state.present.selectedCategory;\n    }\n  );\n\n  return category!;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\n\nexport const selectionModeSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): AnnotationModeType => {\n  return state.present.selectionMode;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const stageHeightSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): number => {\n  return state.present.stageHeight;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const stageScaleSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): number => {\n  return state.present.stageScale;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const stageWidthSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): number => {\n  return state.present.stageWidth;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ToolType } from \"../../types/ToolType\";\n\nexport const toolTypeSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): ToolType => {\n  return state.present.toolType;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { CategoryType } from \"../../types/CategoryType\";\n\nexport const unknownCategorySelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.categories.find((category: CategoryType) => {\n    return category.id === \"00000000-0000-0000-0000-000000000000\";\n  })!;\n};\n","import { ZoomToolOptionsType } from \"../../types/ZoomToolOptionsType\";\nimport { ToolOptionsStateType } from \"../../types/ToolOptionsStateType\";\n\nexport const zoomToolOptionsSelector = ({\n  toolOptions,\n}: {\n  toolOptions: ToolOptionsStateType;\n}): ZoomToolOptionsType => {\n  return toolOptions.zoom;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const zoomSelectionSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): {\n  dragging: boolean;\n  minimum: { x: number; y: number } | undefined;\n  maximum: { x: number; y: number } | undefined;\n  selecting: boolean;\n} => {\n  return state.present.zoomSelection;\n};\n","export default __webpack_public_path__ + \"static/media/texture.2ed6f96c.png\";","import { makeStyles } from \"@material-ui/core/styles\";\nimport texture from \"../../../../images/texture.png\";\n\nexport const useStyles = makeStyles((theme) => ({\n  appBar: {\n    backgroundColor: \"rgba(0, 0, 0, 0)\",\n    borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n    boxShadow: \"none\",\n    position: \"absolute\",\n  },\n  drawer: {\n    flexShrink: 0,\n    width: theme.spacing(32),\n  },\n  iconButton: {\n    marginLeft: 12,\n    marginRight: 20,\n  },\n  paper: {\n    boxShadow: \"inset 0 0 16px #000000\",\n    width: theme.spacing(32),\n    zIndex: 0,\n  },\n  toolbar: {\n    ...theme.mixins.toolbar,\n    backgroundImage: `url(${texture})`,\n  },\n}));\n","import React from \"react\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ExpandLessIcon from \"@material-ui/icons/ExpandLess\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Collapse from \"@material-ui/core/Collapse\";\n\ntype CollapsibleListProps = {\n  children: any;\n  dense: boolean;\n  primary: string;\n  closed?: boolean;\n};\n\nexport const CollapsibleList = ({\n  children,\n  dense,\n  closed,\n  primary,\n}: CollapsibleListProps) => {\n  const [collapsed, setCollapsed] = React.useState(closed);\n\n  const onClick = () => {\n    setCollapsed(!collapsed);\n  };\n\n  return (\n    <List dense={dense}>\n      <ListItem button onClick={onClick}>\n        <ListItemIcon>\n          {collapsed ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n        </ListItemIcon>\n\n        <ListItemText primary={primary} />\n      </ListItem>\n\n      <Collapse in={collapsed} timeout=\"auto\" unmountOnExit>\n        <List component=\"div\" dense={dense} disablePadding>\n          {children}\n        </List>\n      </Collapse>\n    </List>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/cell-painting.f118ef08.png\";","export enum LanguageType {\n  Arabic,\n  English,\n  Farsi,\n  Finnish,\n  French,\n  German,\n  Greek,\n  Hindi,\n  Hungarian,\n  Spanish,\n}\n","export enum ZoomModeType {\n  In,\n  Out,\n}\n","/*\n * Run-length encoding\n */\n\nexport const decode = (encoded: Array<number>): Uint8ClampedArray => {\n  let decoded = [];\n\n  let background = true;\n\n  for (let i = 0; i < encoded.length; i++) {\n    for (let j = 0; j < encoded[i]; j++) {\n      decoded.push(background ? 0 : 255);\n    }\n\n    background = !background;\n  }\n\n  return new Uint8ClampedArray(decoded);\n};\n\nexport const encode = (\n  decoded: Uint8Array | Uint8ClampedArray\n): Array<number> => {\n  let lastElement = decoded[0];\n\n  let lastSequenceSize = 1;\n\n  let encoded = [];\n\n  if (decoded[0] === 255) {\n    encoded.push(0);\n  }\n\n  for (let i = 1; i < decoded.length; i++) {\n    if (lastElement !== decoded[i]) {\n      encoded.push(lastSequenceSize);\n\n      lastElement = decoded[i];\n\n      lastSequenceSize = 1;\n    } else {\n      lastSequenceSize += 1;\n    }\n  }\n\n  encoded.push(lastSequenceSize);\n\n  return encoded;\n};\n\nexport const fromString = (s: Array<number>) => {\n  let counts = [];\n  let m = 0;\n  let p = 0;\n  let k;\n  let x;\n  let more;\n\n  while (s[p]) {\n    x = 0;\n    k = 0;\n    more = 1;\n\n    while (more) {\n      let c = s[p] - 48;\n      x = x | ((c & 0x1f) << (5 * k));\n      more = c & 0x20;\n      p += 1;\n      k += 1;\n\n      if (!more && c & 0x10) {\n        x = x | (-1 << (5 * k));\n      }\n    }\n\n    if (m > 2) {\n      x += counts[m - 2];\n    }\n\n    counts[m++] = x;\n  }\n\n  return counts;\n};\n\nexport const toImageData = (\n  decoded: Uint8ClampedArray,\n  width: number,\n  height: number\n) => {\n  let data = [];\n\n  for (let i = 0; i < decoded.length; i++) {\n    data.push(...[decoded[i], decoded[i], decoded[i], 255]);\n  }\n\n  const clamped = new Uint8ClampedArray(data);\n\n  return new ImageData(clamped, width, height);\n};\n","import * as _ from \"lodash\";\nimport * as ImageJS from \"image-js\";\nimport { AnnotationType } from \"../types/AnnotationType\";\nimport { decode } from \"./rle\";\nimport { isoLines } from \"marchingsquares\";\nimport { CategoryType } from \"../types/CategoryType\";\nimport { ImageType } from \"../types/ImageType\";\nimport { SerializedAnnotationType } from \"../types/SerializedAnnotationType\";\n\nexport const connectPoints = (\n  coordinates: Array<Array<number>>,\n  image: ImageJS.Image\n) => {\n  let connectedPoints: Array<Array<number>> = [];\n\n  const foo = _.filter(\n    _.zip(coordinates.slice(0, coordinates.length - 1), coordinates.slice(1)),\n    ([current, next]) => {\n      return !_.isEqual(current, next);\n    }\n  );\n  foo.forEach(([current, next]) => {\n    const points = drawLine(current!, next!);\n    connectedPoints = _.concat(connectedPoints, points);\n  });\n  return connectedPoints;\n};\n\nexport const drawLine = (p: Array<number>, q: Array<number>) => {\n  const coords: Array<Array<number>> = [];\n\n  let x: number,\n    y: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    dx: number,\n    dy: number,\n    step: number,\n    i: number;\n\n  x1 = Math.round(p[0]);\n  y1 = Math.round(p[1]);\n  x2 = Math.round(q[0]);\n  y2 = Math.round(q[1]);\n\n  dx = x2 - x1;\n  dy = y2 - y1;\n\n  step = Math.abs(dy);\n\n  if (Math.abs(dx) >= Math.abs(dy)) {\n    step = Math.abs(dx);\n  }\n\n  dx = dx / step;\n  dy = dy / step;\n  x = x1;\n  y = y1;\n  i = 1;\n\n  while (i <= step) {\n    coords.push([Math.round(x), Math.round(y)]);\n    x = x + dx;\n    y = y + dy;\n    i = i + 1;\n  }\n\n  return coords;\n};\n\nexport const getIdx = (width: number, nchannels: number) => {\n  return (x: number, y: number, index: number) => {\n    index = index || 0;\n    return Math.floor((width * y + x) * nchannels + index);\n  };\n};\n\n/*\nGiven a click at a position, return all overlapping annotations ids\n */\nexport const getOverlappingAnnotations = (\n  position: { x: number; y: number },\n  annotations: Array<AnnotationType>,\n  imageWidth: number,\n  imageHeight: number\n) => {\n  const overlappingAnnotations = annotations.filter(\n    (annotation: AnnotationType) => {\n      const boundingBox = annotation.boundingBox;\n      if (\n        position.x >= boundingBox[0] &&\n        position.x <= boundingBox[2] &&\n        position.y >= boundingBox[1] &&\n        position.y <= boundingBox[3]\n      ) {\n        //return annotation if clicked on actual selected data\n        const maskROI = new ImageJS.Image(\n          boundingBox[2] - boundingBox[0],\n          boundingBox[3] - boundingBox[1],\n          decode(annotation.mask),\n          { components: 1, alpha: 0 }\n        );\n        if (\n          maskROI.getPixelXY(\n            Math.round(position.x - boundingBox[0]),\n            Math.round(position.y - boundingBox[1])\n          )[0]\n        )\n          return annotation;\n      }\n    }\n  );\n  return overlappingAnnotations.map((annotation: AnnotationType) => {\n    return annotation.id;\n  });\n};\n\nexport const getAnnotationsInBox = (\n  minimum: { x: number; y: number },\n  maximum: { x: number; y: number },\n  annotations: Array<AnnotationType>\n) => {\n  return annotations.filter((annotation: AnnotationType) => {\n    return (\n      minimum.x <= annotation.boundingBox[0] &&\n      minimum.y <= annotation.boundingBox[1] &&\n      maximum.x >= annotation.boundingBox[2] &&\n      maximum.y >= annotation.boundingBox[3]\n    );\n  });\n};\n\nexport const computeContoursFromIsolines = (\n  data: Array<Array<number>>\n): Array<number> => {\n  //pad array to obtain better estimate of contours around mask\n  const pad = 10;\n  const padY = new Array(data[0].length + 2 * pad).fill(0);\n  const padX = new Array(pad).fill(0);\n\n  const paddedMatrix: Array<Array<number>> = [];\n\n  let i;\n  for (i = 0; i < pad; i++) {\n    paddedMatrix.push(padY);\n  }\n  data.forEach((row: Array<number>) => {\n    paddedMatrix.push(padX.concat(row).concat(padX));\n  });\n  for (i = 0; i < pad; i++) {\n    paddedMatrix.push(padY);\n  }\n\n  const largestIsolines = isoLines(paddedMatrix, 1).sort(\n    (a: Array<number>, b: Array<number>) => {\n      return b.length - a.length;\n    }\n  );\n\n  let largestIsoline = largestIsolines[0];\n\n  if (largestIsoline.length <= 5) return [];\n\n  return _.flatten(\n    largestIsoline.map((coord: Array<number>) => {\n      return [Math.round(coord[0] - pad), Math.round(coord[1] - pad)];\n    })\n  );\n};\n\n/*\n * From encoded mask data, get the decoded data and return results as an HTMLImageElement to be used by Konva.Image\n */\nexport const colorOverlayROI = (\n  encodedMask: Array<number>,\n  boundingBox: [number, number, number, number],\n  imageWidth: number,\n  imageHeight: number,\n  color: Array<number>\n): HTMLImageElement | undefined => {\n  if (!encodedMask) return undefined;\n\n  const decodedData = decode(encodedMask);\n\n  const endX = Math.min(imageWidth, boundingBox[2]);\n  const endY = Math.min(imageHeight, boundingBox[3]);\n\n  //extract bounding box params\n  const boxWidth = endX - boundingBox[0];\n  const boxHeight = endY - boundingBox[1];\n\n  const croppedImage = new ImageJS.Image(boxWidth, boxHeight, decodedData, {\n    components: 1,\n    alpha: 0,\n  });\n\n  const colorROIImage = new ImageJS.Image(boxWidth, boxHeight, {\n    components: 3,\n    alpha: 1,\n  });\n\n  const checkNeighbors = (\n    arr: ImageJS.Image,\n    x: number,\n    y: number\n  ): boolean => {\n    if (x === 0 || x === boxWidth - 1) return true;\n    for (let [dx, dy] of [\n      [0, 1],\n      [1, 0],\n      [0, -1],\n      [-1, 0],\n    ]) {\n      if (!arr.getPixelXY(x + dx, y + dy)[0]) return true;\n    }\n    return false;\n  };\n\n  for (let i = 0; i < croppedImage.width; i++) {\n    for (let j = 0; j < croppedImage.height; j++) {\n      if (croppedImage.getPixelXY(i, j)[0] > 0) {\n        if (checkNeighbors(croppedImage, i, j)) {\n          colorROIImage.setPixelXY(i, j, [color[0], color[1], color[2], 255]);\n        } else {\n          colorROIImage.setPixelXY(i, j, [color[0], color[1], color[2], 128]);\n        }\n      } else {\n        colorROIImage.setPixelXY(i, j, [0, 0, 0, 0]);\n      }\n    }\n  }\n\n  const src = colorROIImage.toDataURL(\"image-png\", {\n    useCanvas: true,\n  });\n  const image = new Image();\n  image.src = src;\n\n  return image;\n};\n\n/*\n * Method to rename a cateogry/image if a category/image with this name already exists\n * */\nexport const replaceDuplicateName = (name: string, names: Array<string>) => {\n  let currentName = name;\n  let i = 1;\n  while (names.includes(currentName)) {\n    currentName = name + `_${i}`;\n    i += 1;\n  }\n  return currentName;\n};\n\nexport const saveAnnotationsAsMasks = (\n  images: Array<ImageType>,\n  categories: Array<CategoryType>,\n  zip: any\n): Array<Promise<unknown>> => {\n  return images\n    .map((current: ImageType) => {\n      return current.annotations.map((annotation: AnnotationType) => {\n        return new Promise((resolve, reject) => {\n          const encoded = annotation.mask;\n\n          const decoded = decode(encoded);\n\n          const boundingBox = annotation.boundingBox;\n\n          const endX = Math.min(current.shape.width, boundingBox[2]);\n          const endY = Math.min(current.shape.height, boundingBox[3]);\n\n          //extract bounding box params\n          const boundingBoxWidth = endX - boundingBox[0];\n          const boundingBoxHeight = endY - boundingBox[1];\n\n          const roiMask = new ImageJS.Image(\n            boundingBoxWidth,\n            boundingBoxHeight,\n            decoded,\n            {\n              components: 1,\n              alpha: 0,\n            }\n          );\n\n          const fullImageMaskData = new Uint8Array().fill(0);\n          const fullImageMask = new ImageJS.Image(\n            current.shape.width,\n            current.shape.height,\n            fullImageMaskData,\n            { components: 1, alpha: 0 }\n          );\n\n          for (let i = 0; i < boundingBoxWidth; i++) {\n            for (let j = 0; j < boundingBoxHeight; j++) {\n              if (roiMask.getPixelXY(i, j)[0] > 0) {\n                fullImageMask.setPixelXY(\n                  i + annotation.boundingBox[0],\n                  j + annotation.boundingBox[1],\n                  [255, 255, 255]\n                );\n              }\n            }\n          }\n\n          const uri = fullImageMask.toDataURL(\"image/png\", {\n            useCanvas: true,\n          });\n\n          //draw to canvas\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = current.shape.width;\n          canvas.height = current.shape.height;\n\n          const ctx = canvas.getContext(\"2d\");\n\n          if (!ctx) return;\n\n          const category = categories.find((category: CategoryType) => {\n            return category.id === annotation.categoryId;\n          });\n\n          if (!category) return;\n\n          const categoryName = category.name;\n\n          zip.folder(`${current.name}/${categoryName}`);\n\n          //create image from Data URL\n          const image = new Image(current.shape.width, current.shape.height);\n          image.onload = () => {\n            ctx.drawImage(\n              image,\n              0,\n              0,\n              current.shape.width,\n              current.shape.height\n            );\n            canvas.toBlob((blob) => {\n              if (!blob) return;\n              zip.file(\n                `${current.name}/${categoryName}/${annotation.id}.png`,\n                blob,\n                {\n                  base64: true,\n                }\n              );\n              resolve(true);\n            }, \"image/png\");\n          };\n          image.onerror = reject;\n          image.crossOrigin = \"anonymous\";\n          image.src = uri;\n        });\n      });\n    })\n    .flat();\n};\n\nexport const saveAnnotationsAsMatrix = (\n  images: Array<ImageType>,\n  categories: Array<CategoryType>,\n  zip: any\n): Array<Promise<unknown>> => {\n  return images\n    .map((current: ImageType) => {\n      return categories.map((category: CategoryType) => {\n        return new Promise((resolve, reject) => {\n          const fullLabelImage = new ImageJS.Image(\n            current.shape.width,\n            current.shape.height,\n            new Uint8Array().fill(0),\n            { components: 1, alpha: 0 }\n          );\n          let n = 1;\n          for (let annotation of current.annotations) {\n            if (annotation.categoryId !== category.id) continue;\n            const encoded = annotation.mask;\n            const decoded = decode(encoded);\n            const boundingBox = annotation.boundingBox;\n            const endX = Math.min(current.shape.width, boundingBox[2]);\n            const endY = Math.min(current.shape.height, boundingBox[3]);\n\n            //extract bounding box params\n            const boundingBoxWidth = endX - boundingBox[0];\n            const boundingBoxHeight = endY - boundingBox[1];\n\n            const roiMask = new ImageJS.Image(\n              boundingBoxWidth,\n              boundingBoxHeight,\n              decoded,\n              {\n                components: 1,\n                alpha: 0,\n              }\n            );\n            for (let i = 0; i < boundingBoxWidth; i++) {\n              for (let j = 0; j < boundingBoxHeight; j++) {\n                if (roiMask.getPixelXY(i, j)[0] > 0) {\n                  fullLabelImage.setPixelXY(\n                    i + annotation.boundingBox[0],\n                    j + annotation.boundingBox[1],\n                    [n, n, n]\n                  );\n                }\n              }\n            }\n            n += 1;\n          }\n\n          const uri = fullLabelImage.toDataURL(\"image/png\", {\n            useCanvas: true,\n          });\n\n          //draw to canvas\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = current.shape.width;\n          canvas.height = current.shape.height;\n\n          const ctx = canvas.getContext(\"2d\");\n\n          if (!ctx) return;\n\n          zip.folder(`${current.name}`);\n\n          //create image from Data URL\n          const image = new Image(current.shape.width, current.shape.height);\n          image.onload = () => {\n            ctx.drawImage(\n              image,\n              0,\n              0,\n              current.shape.width,\n              current.shape.height\n            );\n            canvas.toBlob((blob) => {\n              if (!blob) return;\n              zip.file(`${current.name}/${category.name}.png`, blob, {\n                base64: true,\n              });\n              resolve(true);\n            }, \"image/png\");\n          };\n          image.onerror = reject;\n          image.crossOrigin = \"anonymous\";\n          image.src = uri;\n        });\n      });\n    })\n    .flat();\n};\n\nexport const importSerializedAnnotations = (\n  annotation: SerializedAnnotationType,\n  existingCategories: Array<CategoryType>\n): { annotation_out: AnnotationType; categories: Array<CategoryType> } => {\n  const mask = annotation.annotationMask\n    .split(\" \")\n    .map((x: string) => parseInt(x));\n\n  let newCategories = existingCategories;\n  //if category does not already exist in state, add it\n  if (\n    !existingCategories\n      .map((category: CategoryType) => category.id)\n      .includes(annotation.annotationCategoryId)\n  ) {\n    const category: CategoryType = {\n      color: annotation.annotationCategoryColor,\n      id: annotation.annotationCategoryId,\n      name: annotation.annotationCategoryName,\n      visible: true,\n    };\n    newCategories = [...newCategories, category];\n  }\n\n  return {\n    annotation_out: {\n      boundingBox: [\n        annotation.annotationBoundingBoxX,\n        annotation.annotationBoundingBoxY,\n        annotation.annotationBoundingBoxWidth,\n        annotation.annotationBoundingBoxHeight,\n      ],\n      categoryId: annotation.annotationCategoryId,\n      id: annotation.annotationId,\n      mask: mask,\n    },\n    categories: newCategories,\n  };\n};\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { CategoryType } from \"../../types/CategoryType\";\nimport { ImageType } from \"../../types/ImageType\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\nimport * as _ from \"lodash\";\nimport colorImage from \"../../images/cell-painting.png\";\nimport { LanguageType } from \"../../types/LanguageType\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport { StateType } from \"../../types/StateType\";\nimport { SerializedAnnotationType } from \"../../types/SerializedAnnotationType\";\nimport { ChannelType } from \"../../types/ChannelType\";\nimport { SerializedFileType } from \"../../types/SerializedFileType\";\nimport {\n  importSerializedAnnotations,\n  replaceDuplicateName,\n} from \"../../image/imageHelper\";\n\nconst initialImage =\n  process.env.NODE_ENV === \"development\"\n    ? {\n        avatar: colorImage,\n        id: \"f8eecf66-8776-4e14-acd2-94b44603a1a7\",\n        annotations: [],\n        name: \"example.png\",\n        shape: {\n          channels: 3,\n          frames: 1,\n          height: 512,\n          planes: 1,\n          width: 512,\n        },\n        originalSrc: colorImage,\n        src: colorImage,\n      }\n    : undefined;\n\nconst initialCategories =\n  process.env.NODE_ENV === \"development\"\n    ? [\n        {\n          color: \"#AAAAAA\",\n          id: \"00000000-0000-0000-0000-000000000000\",\n          name: \"Unknown\",\n          visible: true,\n        },\n        {\n          color: \"#a08cd2\",\n          id: \"00000000-0000-0000-0000-000000000001\",\n          name: \"Cell membrane\",\n          visible: true,\n        },\n        {\n          color: \"#b8ddf3\",\n          id: \"00000000-0000-0000-0000-000000000002\",\n          name: \"Cell nucleus\",\n          visible: true,\n        },\n      ]\n    : [\n        {\n          color: \"#AAAAAA\",\n          id: \"00000000-0000-0000-0000-000000000000\",\n          name: \"Unknown\",\n          visible: true,\n        },\n      ];\n\nconst initialState: StateType = {\n  annotated: false,\n  annotating: false,\n  boundingClientRect: new DOMRect(),\n  brightness: 0,\n  categories: initialCategories.length > 0 ? initialCategories : [],\n  channels: [\n    //R, G, and B channels by default\n    {\n      range: [0, 255],\n      visible: true,\n    },\n    {\n      range: [0, 255],\n      visible: true,\n    },\n    {\n      range: [0, 255],\n      visible: true,\n    },\n  ],\n  currentIndex: 0,\n  contrast: 0,\n  exposure: 0,\n  hue: 0,\n  activeImageId: initialImage ? initialImage.id : undefined,\n  images: initialImage ? [initialImage] : [],\n  invertMode: false,\n  language: LanguageType.English,\n  offset: { x: 0, y: 0 },\n  penSelectionBrushSize: 32,\n  pointerSelection: {\n    dragging: false,\n    minimum: undefined,\n    maximum: undefined,\n    selecting: false,\n  },\n  quickSelectionBrushSize: 40,\n  saturation: 0,\n  selectedAnnotation: undefined,\n  selectedAnnotations: [],\n  selectedCategory: \"00000000-0000-0000-0000-000000000000\",\n  selectionMode: AnnotationModeType.New,\n  soundEnabled: true,\n  stageHeight: 1000,\n  stageScale: 1,\n  stageWidth: 1000,\n  stagePosition: { x: 0, y: 0 },\n  toolType: ToolType.RectangularAnnotation,\n  vibrance: 0,\n  zoomSelection: {\n    dragging: false,\n    minimum: undefined,\n    maximum: undefined,\n    selecting: false,\n  },\n};\n\nexport const applicationSlice = createSlice({\n  initialState: initialState,\n  name: \"image-viewer-application\",\n  reducers: {\n    addImages(\n      state: StateType,\n      action: PayloadAction<{ newImages: Array<ImageType> }>\n    ) {\n      //we look for image name duplicates and append number if such duplicates are found\n      const imageNames = state.images.map((image: ImageType) => {\n        return image.name.split(\".\")[0];\n      });\n      const updatedImages = action.payload.newImages.map((image: ImageType) => {\n        const initialName = image.name.split(\".\")[0]; //get name before file extension\n        //add filename extension to updatedName\n        const updatedName =\n          replaceDuplicateName(initialName, imageNames) +\n          \".\" +\n          image.name.split(\".\")[1];\n        return { ...image, name: updatedName };\n      });\n\n      state.images.push(...updatedImages);\n    },\n    deleteCategory(\n      state: StateType,\n      action: PayloadAction<{ category: CategoryType }>\n    ) {\n      state.categories = state.categories.filter(\n        (category: CategoryType) => category.id !== action.payload.category.id\n      );\n    },\n    deleteImage(state: StateType, action: PayloadAction<{ id: string }>) {\n      state.images = state.images.filter(\n        (image: ImageType) => image.id !== action.payload.id\n      );\n      if (!state.images.length) state.activeImageId = undefined;\n      else if (\n        state.activeImageId === action.payload.id &&\n        state.images.length\n      ) {\n        state.activeImageId = state.images[0].id;\n      }\n    },\n    deleteAllInstances(\n      state: StateType,\n      action: PayloadAction<{ id: string }>\n    ) {\n      //deletes all instances across all images\n      state.images = state.images.map((image: ImageType) => {\n        return { ...image, annotations: [] };\n      });\n    },\n    deleteImageInstances(\n      state: StateType,\n      action: PayloadAction<{ imageId: string }>\n    ) {\n      //deletes all instances across a given image\n      state.images = state.images.map((image: ImageType) => {\n        if (image.id === action.payload.imageId) {\n          return { ...image, annotations: [] };\n        } else return image;\n      });\n    },\n    deleteImageInstance(\n      //deletes given instance on active image\n      state: StateType,\n      action: PayloadAction<{ id: string }>\n    ) {\n      if (!state.activeImageId) return;\n\n      state.images = state.images.map((image: ImageType) => {\n        if (image.id === state.activeImageId) {\n          const updatedAnnotations = image.annotations.filter(\n            (instance: AnnotationType) => instance.id !== action.payload.id\n          );\n          return { ...image, annotations: updatedAnnotations };\n        } else return image;\n      });\n    },\n    openAnnotations(\n      state: StateType,\n      action: PayloadAction<{ file: SerializedFileType }>\n    ) {\n      /*\n       * NOTE: The correct image to annotate is found by looking at the\n       * imageFilename property in the imported annotation file. -- Alice\n       */\n      if (!state.activeImageId) return;\n\n      const annotations = action.payload.file.annotations.map(\n        (annotation: SerializedAnnotationType): AnnotationType => {\n          const { annotation_out, categories } = importSerializedAnnotations(\n            annotation,\n            state.categories\n          );\n          state.categories = categories;\n          return annotation_out;\n        }\n      );\n\n      const loaded: ImageType = {\n        avatar: action.payload.file.imageData,\n        id: action.payload.file.imageId,\n        src: action.payload.file.imageData,\n        originalSrc: action.payload.file.imageData,\n        name: action.payload.file.imageFilename,\n        annotations: annotations,\n        shape: {\n          channels: action.payload.file.imageChannels,\n          frames: action.payload.file.imageFrames,\n          height: action.payload.file.imageHeight,\n          planes: action.payload.file.imagePlanes,\n          width: action.payload.file.imageWidth,\n        },\n      };\n\n      state.images.push(...[loaded]);\n    },\n    setAnnotated(\n      state: StateType,\n      action: PayloadAction<{ annotated: boolean }>\n    ) {\n      state.annotated = action.payload.annotated;\n    },\n    setAnnotating(\n      state: StateType,\n      action: PayloadAction<{ annotating: boolean }>\n    ) {\n      state.annotating = action.payload.annotating;\n    },\n    setBoundingClientRect(\n      state: StateType,\n      action: PayloadAction<{ boundingClientRect: DOMRect }>\n    ) {\n      state.boundingClientRect = action.payload.boundingClientRect;\n    },\n    setBrightness(\n      state: StateType,\n      action: PayloadAction<{ brightness: number }>\n    ) {\n      state.brightness = action.payload.brightness;\n    },\n    setCategories(\n      state: StateType,\n      action: PayloadAction<{ categories: Array<CategoryType> }>\n    ) {\n      state.categories = action.payload.categories;\n    },\n    setCategoryVisibility(\n      state: StateType,\n      action: PayloadAction<{ category: CategoryType; visible: boolean }>\n    ) {\n      const category = _.find(state.categories, (category) => {\n        return category.id === action.payload.category.id;\n      });\n      if (!category) return;\n      category.visible = action.payload.visible;\n      state.categories = [\n        ...state.categories.filter((category) => {\n          return category.id !== action.payload.category.id;\n        }),\n        category,\n      ];\n    },\n    setContrast(state: StateType, action: PayloadAction<{ contrast: number }>) {\n      state.contrast = action.payload.contrast;\n    },\n    setCurrentIndex(\n      state: StateType,\n      action: PayloadAction<{ currentIndex: number }>\n    ) {\n      state.currentIndex = action.payload.currentIndex;\n    },\n    setExposure(state: StateType, action: PayloadAction<{ exposure: number }>) {\n      state.exposure = action.payload.exposure;\n    },\n    setHue(state: StateType, action: PayloadAction<{ hue: number }>) {\n      state.hue = action.payload.hue;\n    },\n    setActiveImage(state: StateType, action: PayloadAction<{ image: string }>) {\n      state.activeImageId = action.payload.image;\n      const activeImage = state.images.find((image: ImageType) => {\n        return image.id === action.payload.image;\n      });\n      if (!activeImage) return;\n      const defaultChannels: Array<ChannelType> = []; //number of channels depends on whether image is greyscale or RGB\n      for (let i = 0; i < activeImage.shape.channels; i++) {\n        defaultChannels.push({\n          range: [0, 255],\n          visible: true,\n        });\n      }\n      state.channels = defaultChannels;\n    },\n    setImageInstances(\n      state: StateType,\n      action: PayloadAction<{ instances: Array<AnnotationType> }>\n    ) {\n      if (!state.activeImageId) return;\n\n      //update corresponding image object in array of Images stored in state\n      state.images = state.images.map((image: ImageType) => {\n        if (state.activeImageId !== image.id) {\n          return image;\n        } else {\n          return { ...image, annotations: action.payload.instances };\n        }\n      });\n    },\n    setImageSrc(state: StateType, action: PayloadAction<{ src: string }>) {\n      if (!state.activeImageId) return;\n      state.images = state.images.map((image: ImageType) => {\n        if (state.activeImageId !== image.id) {\n          return image;\n        } else {\n          return { ...image, src: action.payload.src };\n        }\n      });\n    },\n    setImages(\n      state: StateType,\n      action: PayloadAction<{ images: Array<ImageType> }>\n    ) {\n      state.images = action.payload.images;\n    },\n    setChannels(\n      state: StateType,\n      action: PayloadAction<{\n        channels: Array<ChannelType>;\n      }>\n    ) {\n      state.channels = action.payload.channels;\n    },\n    setInvertMode(\n      state: StateType,\n      action: PayloadAction<{ invertMode: boolean }>\n    ) {\n      state.invertMode = action.payload.invertMode;\n    },\n    setLanguage(\n      state: StateType,\n      action: PayloadAction<{ language: LanguageType }>\n    ) {\n      state.language = action.payload.language;\n    },\n    setOffset(\n      state: StateType,\n      action: PayloadAction<{ offset: { x: number; y: number } }>\n    ) {\n      state.offset = action.payload.offset;\n    },\n    setOperation(\n      state: StateType,\n      action: PayloadAction<{ operation: ToolType }>\n    ) {\n      state.toolType = action.payload.operation;\n    },\n    setPenSelectionBrushSize(\n      state: StateType,\n      action: PayloadAction<{ penSelectionBrushSize: number }>\n    ) {\n      state.penSelectionBrushSize = action.payload.penSelectionBrushSize;\n    },\n    setPointerSelection(\n      state: StateType,\n      action: PayloadAction<{\n        pointerSelection: {\n          dragging: boolean;\n          minimum: { x: number; y: number } | undefined;\n          maximum: { x: number; y: number } | undefined;\n          selecting: boolean;\n        };\n      }>\n    ) {\n      state.pointerSelection = action.payload.pointerSelection;\n    },\n    setQuickSelectionBrushSize(\n      state: StateType,\n      action: PayloadAction<{ quickSelectionBrushSize: number }>\n    ) {\n      state.quickSelectionBrushSize = action.payload.quickSelectionBrushSize;\n    },\n    setSaturation(\n      state: StateType,\n      action: PayloadAction<{ saturation: number }>\n    ) {\n      state.saturation = action.payload.saturation;\n    },\n    setSelectedCategory(\n      state: StateType,\n      action: PayloadAction<{ selectedCategory: string }>\n    ) {\n      state.selectedCategory = action.payload.selectedCategory;\n    },\n    setSelectedAnnotations(\n      state: StateType,\n      action: PayloadAction<{\n        selectedAnnotations: Array<AnnotationType>;\n        selectedAnnotation: AnnotationType | undefined;\n      }>\n    ) {\n      state.selectedAnnotations = action.payload.selectedAnnotations;\n      state.selectedAnnotation = action.payload.selectedAnnotation;\n    },\n    setSelectionMode(\n      state: StateType,\n      action: PayloadAction<{ selectionMode: AnnotationModeType }>\n    ) {\n      state.selectionMode = action.payload.selectionMode;\n    },\n    setStageHeight(\n      state: StateType,\n      action: PayloadAction<{ stageHeight: number }>\n    ) {\n      state.stageHeight = action.payload.stageHeight;\n    },\n    setStagePosition(\n      state: StateType,\n      action: PayloadAction<{ stagePosition: { x: number; y: number } }>\n    ) {\n      state.stagePosition = action.payload.stagePosition;\n    },\n    setStageScale(\n      state: StateType,\n      action: PayloadAction<{ stageScale: number }>\n    ) {\n      state.stageScale = action.payload.stageScale;\n    },\n    setStageWidth(\n      state: StateType,\n      action: PayloadAction<{ stageWidth: number }>\n    ) {\n      state.stageWidth = action.payload.stageWidth;\n    },\n    setSoundEnabled(\n      state: StateType,\n      action: PayloadAction<{ soundEnabled: boolean }>\n    ) {\n      state.soundEnabled = action.payload.soundEnabled;\n    },\n    setVibrance(state: StateType, action: PayloadAction<{ vibrance: number }>) {\n      state.vibrance = action.payload.vibrance;\n    },\n    setZoomSelection(\n      state: StateType,\n      action: PayloadAction<{\n        zoomSelection: {\n          dragging: boolean;\n          minimum: { x: number; y: number } | undefined;\n          maximum: { x: number; y: number } | undefined;\n          selecting: boolean;\n        };\n      }>\n    ) {\n      state.zoomSelection = action.payload.zoomSelection;\n    },\n  },\n  extraReducers: {\n    [\"thunks/loadLayersModel/fulfilled\"]: (\n      state: StateType,\n      action: PayloadAction<tensorflow.LayersModel>\n    ) => {\n      console.info(action.payload);\n    },\n  },\n});\n\nexport const {\n  addImages,\n  deleteCategory,\n  deleteAllInstances,\n  deleteImage,\n  deleteImageInstance,\n  deleteImageInstances,\n  setActiveImage,\n  setAnnotating,\n  setAnnotated,\n  setBoundingClientRect,\n  setBrightness,\n  setCategories,\n  setCategoryVisibility,\n  setChannels,\n  setContrast,\n  setCurrentIndex,\n  setExposure,\n  setHue,\n  setImageInstances,\n  setImages,\n  setInvertMode,\n  setLanguage,\n  setOffset,\n  setOperation,\n  setPenSelectionBrushSize,\n  setPointerSelection,\n  setQuickSelectionBrushSize,\n  setSaturation,\n  setSelectedAnnotations,\n  setSelectionMode,\n  setSelectedCategory,\n  setSoundEnabled,\n  setStageHeight,\n  setStagePosition,\n  setStageScale,\n  setStageWidth,\n  setVibrance,\n  setZoomSelection,\n} = applicationSlice.actions;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { ToolOptionsStateType } from \"../../types/ToolOptionsStateType\";\nimport { ZoomModeType } from \"../../types/ZoomModeType\";\nimport { ZoomToolOptionsType } from \"../../types/ZoomToolOptionsType\";\nimport { ColorAdjustmentOptionsType } from \"../../types/ColorAdjustmentOptionsType\";\n\nconst initialState: ToolOptionsStateType = {\n  colorAdjustment: {\n    blackPoint: 0,\n    brightness: 0,\n    contrast: 0,\n    exposure: 0,\n    highlights: 0,\n    hue: 0,\n    saturation: 0,\n    shadows: 0,\n    vibrance: 0,\n  },\n  zoom: {\n    automaticCentering: true,\n    mode: ZoomModeType.In,\n    scale: 1.0,\n    toActualSize: false,\n    toFit: false,\n  },\n};\n\nexport const toolOptionsSlice = createSlice({\n  initialState: initialState,\n  name: \"image-viewer-tool-options\",\n  reducers: {\n    setColorAdjustmentOptions(\n      state: ToolOptionsStateType,\n      action: PayloadAction<{ options: ColorAdjustmentOptionsType }>\n    ) {\n      state.colorAdjustment = action.payload.options;\n    },\n    setZoomToolOptions(\n      state: ToolOptionsStateType,\n      action: PayloadAction<{ options: ZoomToolOptionsType }>\n    ) {\n      state.zoom = action.payload.options;\n    },\n  },\n});\n\nexport const { setZoomToolOptions } = toolOptionsSlice.actions;\n","import { combineReducers } from \"redux\";\nimport { applicationSlice } from \"../slices\";\nimport { toolOptionsSlice } from \"../slices/toolOptionsSlice\";\nimport undoable, { groupByActionTypes } from \"redux-undo\";\nimport { StateType } from \"../../types/StateType\";\nimport { HistoryStateType } from \"../../types/HistoryStateType\";\nimport * as _ from \"lodash\";\n\nconst filterActions = (\n  action: any,\n  currentState: StateType,\n  previousHistory: HistoryStateType\n) => {\n  const actions = [\n    \"image-viewer-application/setImageInstances\",\n    \"image-viewer-application/setAnnotated\",\n    \"image-viewer-application/setAnnotating\",\n    \"image-viewer-application/deleteImageInstance\",\n    \"image-viewer-application/setSelectedAnnotation\",\n    \"image-viewer-application/setSelectedAnnotationId\",\n  ];\n  return _.includes(actions, action.type);\n};\n\nconst reducers = {\n  state: undoable(applicationSlice.reducer, {\n    filter: filterActions,\n    groupBy: groupByActionTypes(\"image-viewer-application/deleteImageInstance\"),\n  }),\n  toolOptions: toolOptionsSlice.reducer,\n};\n\nexport const reducer = combineReducers(reducers);\n","import {\n  configureStore,\n  EnhancedStore,\n  Middleware,\n  StoreEnhancer,\n} from \"@reduxjs/toolkit\";\nimport logger from \"redux-logger\";\nimport { reducer } from \"../reducer\";\nimport * as Sentry from \"@sentry/react\";\nimport thunk from \"redux-thunk\";\n\nconst sentryReduxEnhancer = Sentry.createReduxEnhancer({});\n\nconst enhancers: StoreEnhancer[] = [sentryReduxEnhancer];\n\nconst middleware: Middleware[] = [logger, thunk];\n\nconst preloadedState = {};\n\nconst options = {\n  devTools: true,\n  enhancers: enhancers,\n  middleware: middleware,\n  preloadedState: preloadedState,\n  reducer: reducer,\n};\n\nexport const store: EnhancedStore = configureStore(options);\n","import { createAsyncThunk } from \"@reduxjs/toolkit\";\n\nconst echo = async (message: string): Promise<string> => {\n  return message;\n};\n\nexport const echoThunk = createAsyncThunk(\n  \"thunks/echo\",\n  async (message: string) => {\n    return await echo(message);\n  }\n);\n","import { createAsyncThunk } from \"@reduxjs/toolkit\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\n\nexport const loadLayersModelThunk = createAsyncThunk(\n  \"thunks/loadLayersModel\",\n  async ({ name, path }: { name: string; path: string }) => {\n    return await tensorflow.loadLayersModel(path);\n  }\n);\n","import React from \"react\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport LabelIcon from \"@material-ui/icons/Label\";\nimport LabelOutlinedIcon from \"@material-ui/icons/LabelOutlined\";\nimport { CategoryType } from \"../../../../types/CategoryType\";\nimport { useDispatch } from \"react-redux\";\nimport { applicationSlice } from \"../../../../store\";\n\ntype CategoryListItemCheckboxProps = {\n  category: CategoryType;\n};\n\nexport const CategoryListItemCheckbox = ({\n  category,\n}: CategoryListItemCheckboxProps) => {\n  const dispatch = useDispatch();\n\n  const onCheckboxClick = () => {\n    dispatch(\n      applicationSlice.actions.setCategoryVisibility({\n        category: category,\n        visible: !category.visible,\n      })\n    );\n  };\n\n  return (\n    <ListItemIcon>\n      <Checkbox\n        checked={category.visible}\n        checkedIcon={<LabelIcon style={{ color: category.color }} />}\n        disableRipple\n        edge=\"start\"\n        icon={<LabelOutlinedIcon style={{ color: category.color }} />}\n        onClick={onCheckboxClick}\n        tabIndex={-1}\n      />\n    </ListItemIcon>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const languageSelector = ({ state }: { state: HistoryStateType }) => {\n  return state.present.language;\n};\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst de: language = {\n  translation: {\n    Cancel: \"Abbrechen\",\n    Categories: \"Kategorien\",\n    \"Create category\": \"Neue Kategorie\",\n    \"Create new classifier\": \"Neuer Classifier\",\n    \"Delete category\": \"Lösche Kategorie\",\n    \"Delete images\": \"Lösche Bilder\",\n    Description: \"Beschreibung\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Bearbeite Kategorie\",\n    Help: \"Hilfe\",\n    \"Hide other categories\": \"Blende andere Kategorien aus\",\n    \"Hide sidebar\": \"Blende Sidebar aus\",\n    \"Import images\": \"Bilder hinzufügen\",\n    Logo: \"Logo\",\n    Model: \"Modell\",\n    \"Open classifier\": \"Öffne Classifier\",\n    \"Open example classifier\": \"Öffne Beispiel Classifier\",\n    \"Open weights\": \"Öffne Gewichte\",\n    Open: \"Öffnen\",\n    \"Run classifier\": \"Starte Classfier\",\n    \"Save annotations and predictions\": \"Speicher Labels und Predictions\",\n    \"Save classifier\": \"Speicher Classifier\",\n    \"Save weights\": \"Speicher Gewichte\",\n    Save: \"Speichern\",\n    \"Search images\": \"Durchsuche Bilder\",\n    \"Send feedback\": \"Sende Feedback\",\n    Settings: \"Einstellungen\",\n    \"Show sidebar\": \"Blende Sidebar ein\",\n    Unknown: \"Unbekannt\",\n  },\n};\n\nexport default de;\n","import { language } from \"./language\";\n\nconst en: language = {\n  translation: {\n    Cancel: \"Cancel\",\n    Categories: \"Categories\",\n    \"Create category\": \"Create category\",\n    \"Create new classifier\": \"Create new classifier\",\n    \"Delete category\": \"Delete category\",\n    \"Delete images\": \"Delete images\",\n    Description: \"Description\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Edit category\",\n    Help: \"Help\",\n    \"Hide other categories\": \"Hide other categories\",\n    \"Hide sidebar\": \"Hide sidebar\",\n    \"Import images\": \"Import images\",\n    Logo: \"Logo\",\n    Model: \"Model\",\n    \"Open classifier\": \"Open classifier\",\n    \"Open example classifier\": \"Open example classifier\",\n    \"Open weights\": \"Open weights\",\n    Open: \"Open\",\n    \"Run classifier\": \"Run classifier\",\n    \"Save annotations and predictions\": \"Save annotations and predictions\",\n    \"Save classifier\": \"Save classifier\",\n    \"Save weights\": \"Save weights\",\n    Save: \"Save\",\n    \"Search images\": \"Search images\",\n    \"Send feedback\": \"Send feedback\",\n    Settings: \"Settings\",\n    \"Show sidebar\": \"Show sidebar\",\n    Unknown: \"Unknown\",\n  },\n};\n\nexport default en;\n","import { language } from \"./language\";\n\nconst fas: language = {\n  translation: {\n    \"Actual size\": \"سایز اصلی\",\n    \"Add area\": \"ناحیه اضافه کنید\",\n    \"Annotation mode\": \"حالت گروه توضیحی\",\n    Cancel: \"لفو کردن\",\n    Categories: \"دسته بندی کردن\",\n    \"Center image automatically\": \"تصویر را به طور اتوماتیک در مرکز قرار می دهد\",\n    \"Color annotation\": \"توضیح رنگ ها\",\n    \"Create category\": \"ایجاد دسته بندی\",\n    \"Create new classifier\": \"ایجاد طبقه بندی جدید\",\n    Create: \"ایجاد\",\n    \"Delete category\": \"پاک کردن دسته بندی\",\n    \"Delete images\": \"پاک کردن تصویر\",\n    Description: \"توضیحات\",\n    Edit: \"ویرایش\",\n    \"Edit category\": \"ویرایش دسته بندی\",\n    \"Elliptical annotation\": \"گروه توضیحی بیضوی\",\n    Export: \"فرستادن\",\n    \"Export annotations\": \"فرستادن گروه توضیحی\",\n    \"Freehand annotation\": \"گروه توضیحی آزاد\",\n    Help: \"کمک یابی\",\n    \"Hide category\": \"پنهان سازی طبقه بندی\",\n    \"Hide other categories\": \"پنهان سازی سایر طبقه بندی ها\",\n    \"Hide sidebar\": \"پنهان سازی منوی کناری\",\n    \"Import images\": \"آوردن تصاویر\",\n    Intersection: \"تلاقی کردن\",\n    \"Invert annotation\": \"معکوس کردن گروه توضیحی\",\n    \"Lasso annotation\": \"گروه توضیحی کمند\",\n    Logo: \"علامت\",\n    \"Magnetic annotation\": \"گروه توضیحی آهنربایی\",\n    Model: \"نمونه\",\n    \"Object annotation\": \"گروه توضیحی هدف\",\n    \"Open classifier\": \"باز کردن طبقه بندی\",\n    \"Open example classifier\": \"باز کردن طبقه بندی نمونه\",\n    \"Open image\": \"باز کردن تصویر\",\n    \"Open weights\": \"باز کردن وزن ها\",\n    Open: \"باز کردن\",\n    \"Pen annotation\": \"گروه توضیحی خودکار\",\n    Pointer: \"نشانه گر\",\n    \"Polygonal annotation\": \"گروه توضیحی چند ظلعی\",\n    Name: \"نام\",\n    \"New annotation\": \"گروه توضیحی جدید\",\n    \"Quick annotation\": \"گروه توضیحی سریع\",\n    \"Rectangular annotation\": \"گروه توضیحی مستطیلی\",\n    \"Run classifier\": \"اجرا کردن طبقه بندی\",\n    \"Save annotations and predictions\": \"ذخیره کردن گروه های توضیحی و پیش بینی ها\",\n    \"Save classifier\": \"ذخیره کردن طبقه بندی\",\n    \"Save weights\": \"ذخیره کردن وزن ها\",\n    Save: \"ذخیره کردن\",\n    \"Search images\": \"جستجوی تصاویر\",\n    \"Send feedback\": \"فرستادن پیشنهادات\",\n    Settings: \"تنظیمات\",\n    \"Show category\": \"نشان دادن گروه ها\",\n    \"Show sidebar\": \"نشان دادن منوی کناری\",\n    \"Subtract area\": \"کم کردن ناحیه\",\n    Unknown: \"تعریف نشده\",\n    Zoom: \"بزرگ نمایی\",\n    \"Zoom in\": \"بزرگ نمایی کردن\",\n    \"Zoom mode\": \"حالت بزرگ نمایی\",\n    \"Zoom out\": \"کوچک نمایی کردن\",\n  },\n};\n\nexport default fas;\n\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst fi: language = {\n  translation: {\n    Cancel: \"Peruuta\",\n    Categories: \"Kategoriat\",\n    \"Create category\": \"Luo kategoria\",\n    \"Create new classifier\": \"Luo uusi luokittelija\",\n    \"Delete category\": \"Poista kategoria\",\n    \"Delete images\": \"Poista kuvat\",\n    Description: \"Kuvaus\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Muokkaa kategoriaa\",\n    Help: \"Apua\",\n    \"Hide other categories\": \"Piilota muut kategoriat\",\n    \"Hide sidebar\": \"Piilota sivupalkki\",\n    \"Import images\": \"Tuo kuvat\",\n    Logo: \"Logo\",\n    Model: \"Malli\",\n    \"Open classifier\": \"Avaa luokittelija\",\n    \"Open example classifier\": \"Avaa esimerkkiluokittelija\",\n    \"Open weights\": \"Avaa painot\",\n    Open: \"Avaa\",\n    \"Run classifier\": \"Suorita luokittelija\",\n    \"Save annotations and predictions\":\n      \"Tallenna annotaatiot ja luokittelun tulos\",\n    \"Save classifier\": \"Tallenna luokittelija\",\n    \"Save weights\": \"Tallenna painot\",\n    Save: \"Tallenna\",\n    \"Search images\": \"Etsi kuvia\",\n    \"Send feedback\": \"Lähetä palautetta\",\n    Settings: \"Asetukset\",\n    \"Show sidebar\": \"Näytä sivupalkki\",\n    Unknown: \"Tuntematon\",\n  },\n};\n\nexport default fi;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst gr: language = {\n  translation: {\n    Cancel: \"Άκυρο\",\n    Categories: \"Κατηγορίες\",\n    \"Create category\": \"Δημιουργία κατηγορίας\",\n    \"Create new classifier\": \"Νέος ταξινομητής\",\n    \"Delete category\": \"Διαγραφή κατηγορίας\",\n    \"Delete images\": \"Διαγραφή εικόνων\",\n    Description: \"Περιγραφή\",\n    Edit: \"Επεξεργασία\",\n    \"Edit category\": \"Επεξεργασία κατηγορίας\",\n    Help: \"Βοήθεια\",\n    \"Hide other categories\": \"Απόκρυψη άλλων κατηγοριών\",\n    \"Hide sidebar\": \"Απόκρυψη πλευρικής γραμμής\",\n    \"Import images\": \"Εισαγωγή εικόνων\",\n    Logo: \"Λογότυπο\",\n    Model: \"Mοντέλο\",\n    \"Open classifier\": \"Άνοιγμα ταξινομητή\",\n    \"Open example classifier\": \"Παράδειγμα ταξινομητή\",\n    \"Open weights\": \"Άνοιγμα παραμέτρων\",\n    Open: \"Άνοιγμα\",\n    \"Run classifier\": \"Εκτέλεση ταξινομητή\",\n    \"Save annotations and predictions\": \"Αποθήκευση ετικετών και προβλέψεων\",\n    \"Save classifier\": \"Αποθήκευση ταξινομητή\",\n    \"Save weights\": \"Αποθήκευση παραμέτρων\",\n    Save: \"Αποθήκευση\",\n    \"Search images\": \"Αναζήτηση εικόνων\",\n    \"Send feedback\": \"Eπικοινωνια\",\n    Settings: \"Ρυθμίσεις\",\n    \"Show sidebar\": \"Εμφάνιση πλευρικής γραμμής\",\n    Unknown: \"Άγνωστο\",\n  },\n};\n\nexport default gr;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst hi: language = {\n  translation: {\n    Cancel: \"रद्द करें\",\n    Categories: \"सारे वर्ग\",\n    \"Create category\": \"वर्ग बनाएँ\",\n    \"Create new classifier\": \"नया वर्गीकर्त्ता बनाएं\", // वर्गीकर्त्ता = classifier but is rarely used; consider transliterating instead\n    \"Delete category\": \"वर्ग हटाएँ\",\n    \"Delete images\": \"चित्रों को हटाएँ\",\n    Description: \"विवरण\",\n    \"Edit category\": \"वर्ग का बदलाव करें\",\n    Help: \"सहायता\",\n    \"Hide other categories\": \"बाकि वर्गों को छिपाएं\",\n    \"Hide sidebar\": \"साइडबार छिपाएं\",\n    \"Import images\": \"चित्रों को आयात करें\",\n    Logo: \"लोगो\", // transliterated (Logo) but that's ok because it is a loanword\n    Model: \"मॉडल\", // transliterated (Model) but should figure out an appropriate abstraction and translate that\n    \"Open classifier\": \"वर्गीकर्त्ता खोलें\",\n    \"Open example classifier\": \"उदाहरण का वर्गीकर्त्ता खोलें\",\n    \"Open weights\": \"वेइट्स खोलें\",\n    Open: \"खोलें\",\n    \"Run classifier\": \"वर्गीकर्त्ता को चलाएं\",\n    \"Save annotations and predictions\": \"टिप्पणी तथा अनुमान सहेजें\", // व्याख्या is an alternative to टिप्पणी\n    \"Save classifier\": \"वर्गीकर्त्ता सहेजें\",\n    \"Save weights\": \"वेइट्स सहेजें\",\n    Save: \"सहेजें\",\n    \"Search images\": \"चित्र खोजें\",\n    \"Send feedback\": \"प्रतिक्रिया भेजें\",\n    Settings: \"सेटिंग्स\",\n    \"Show sidebar\": \"साइडबार दिखाएं\",\n    Unknown: \"अज्ञात\", // should be used as an adjective before a noun\n  },\n};\n\nexport default hi;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst hu: language = {\n  translation: {\n    Cancel: \"Mégse\",\n    Categories: \"Osztályok\",\n    \"Create category\": \"Új osztály létrehozása\",\n    \"Create new classifier\": \"Új osztályozó létrehozása\",\n    \"Delete category\": \"Osztály törlése\",\n    \"Delete images\": \"Képek törlése\",\n    Description: \"Leírás\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Kategória szerkesztése\",\n    Help: \"Súgó\",\n    \"Hide other categories\": \"Többi osztály elrejtése\",\n    \"Hide sidebar\": \"Oldalsáv elrejtése\",\n    \"Import images\": \"Képek importálása\",\n    Logo: \"Logó\",\n    Model: \"Modell\",\n    \"Open classifier\": \"Osztályozó betöltése\",\n    \"Open example classifier\": \"Példa osztályozó betöltése\",\n    \"Open weights\": \"Súlyok betöltése\",\n    Open: \"Megnyitás\",\n    \"Run classifier\": \"Osztályozó futtatása\",\n    \"Save annotations and predictions\": \"Címkék és predikciók mentése\",\n    \"Save classifier\": \"Osztályozó mentése\",\n    \"Save weights\": \"Súlyok mentése\",\n    Save: \"Mentés\",\n    \"Search images\": \"Képek keresése\",\n    \"Send feedback\": \"Visszajelzés küldése\",\n    Settings: \"Beállítások\",\n    \"Show sidebar\": \"Oldalsáv megjelenítése\",\n    Unknown: \"Ismeretlen\",\n  },\n};\n\nexport default hu;\n","// prettier-ignore\nimport {language} from \"./language\";\n\nconst se: language = {\n  translation: {\n    Cancel: \"Annullera\",\n    Categories: \"kategorier\",\n    \"Create category\": \"Skapa kategori\",\n    \"Create new classifier\": \"Skapa ny klassificerare\",\n    \"Delete category\": \"Ta bort kategori\",\n    \"Delete images\": \"Ta bort bilder\",\n    Description: \"Beskrivning\",\n    Edit: \"Edit\",\n    \"Edit category\": \"Redigera kategori\",\n    Help: \"Hjälp\",\n    \"Hide other categories\": \"gömma andra kategorier\",\n    \"Hide sidebar\": \"Dölj sidfältet\",\n    \"Import images\": \"Importera bilder\",\n    Logo: \"Logo\",\n    Model: \"Modell\",\n    \"Open classifier\": \"Öppna klassificerare\",\n    \"Open example classifier\": \"Öppna exempel klassificeraren\",\n    \"Open weights\": \"Öppna vikter\",\n    Open: \"Öppna\",\n    \"Run classifier\": \"Kör klassificeringsenheten\",\n    \"Save annotations and predictions\": \"Spara kommentarer och förutsägelser\",\n    \"Save classifier\": \"Spara klassificerare\",\n    \"Save weights\": \"Spara vikter\",\n    Save: \"Spara\",\n    \"Search images\": \"Sök bilder\",\n    \"Send feedback\": \"Skicka feedback\",\n    Settings: \"Inställningar\",\n    \"Show sidebar\": \"Visa sidofältet\",\n    Unknown: \"Okänd\",\n  },\n};\n\nexport default se;\n","import { language } from \"./language\";\n\nconst fr: language = {\n  translation: {\n    \"Actual size\": \"Taille réelle\",\n    \"Add area\": \"Ajouter région\",\n    \"Annotation mode\": \"Mode d'annotation\",\n    Cancel: \"Annuler\",\n    Categories: \"Catégories\",\n    \"Center image automatically\": \"Centrer image automatiquement\",\n    \"Color annotation\": \"Annotation couleur\",\n    \"Create category\": \"Nouvelle catégorie\",\n    \"Create new classifier\": \"Nouveau classifieur\",\n    Create: \"Ajouter\",\n    \"Delete category\": \"Supprimer catégorie\",\n    \"Delete images\": \"Supprimer images\",\n    Description: \"Description\",\n    Edit: \"Modifier\",\n    \"Edit category\": \"Modifier catégorie\",\n    \"Elliptical annotation\": \"Annotation elliptique\",\n    Export: \"Exporter\",\n    \"Export annotations\": \"Exporter annotations\",\n    \"Freehand annotation\": \"Annotation main-libres\",\n    Help: \"Aide\",\n    \"Hide category\": \"Cacher catégorie\",\n    \"Hide other categories\": \"Cacher autres catégories\",\n    \"Hide sidebar\": \"Cacher sidebar\",\n    \"Import images\": \"Importer images\",\n    Intersection: \"Intersection\",\n    \"Invert annotation\": \"Inverser annotation\",\n    \"Lasso annotation\": \"Annotation lasso\",\n    Logo: \"Logo\",\n    \"Magnetic annotation\": \"Annotation magnétique\",\n    Model: \"Modèle\",\n    \"Object annotation\": \"Annotation objet\",\n    \"Open classifier\": \"Ouvrir classifieur\",\n    \"Open example classifier\": \"Ouvrir example classifieur\",\n    \"Open image\": \"Ouvrir image\",\n    \"Open weights\": \"Ouvrir poids\",\n    Open: \"Ouvrir\",\n    \"Pen annotation\": \"Annotation pinceau\",\n    Pointer: \"Pointeur\",\n    \"Polygonal annotation\": \"Annotation polygonale\",\n    Name: \"Nom\",\n    \"New annotation\": \"Nouvelle annotation\",\n    \"Quick annotation\": \"Annotation rapide\",\n    \"Rectangular annotation\": \"Annotation rectangulaire\",\n    \"Run classifier\": \"Initier classifieur\",\n    \"Save annotations and predictions\": \"Sauver annotations et predictions\",\n    \"Save classifier\": \"Sauver classifieur\",\n    \"Save weights\": \"Sauver poids\",\n    Save: \"Sauver\",\n    \"Search images\": \"Rechercher images\",\n    \"Send feedback\": \"Envoyer feedback\",\n    Settings: \"Préférences\",\n    \"Show category\": \"Montrer catégorie\",\n    \"Show sidebar\": \"Montrer sidebar\",\n    \"Subtract area\": \"Soustraire région\",\n    Unknown: \"Inconnu\",\n    Zoom: \"Zoom\",\n    \"Zoom in\": \"Zoom intérieur\",\n    \"Zoom mode\": \"Mode zoom\",\n    \"Zoom out\": \"Zoom extérieur\",\n  },\n};\n\nexport default fr;\n","import { useSelector } from \"react-redux\";\nimport { languageSelector } from \"../../store/selectors/languageSelector\";\nimport { de, en, fas, fi, gr, hi, hu } from \"../../translations/\";\nimport { LanguageType } from \"../../types/LanguageType\";\nimport fr from \"../../translations/fr\";\n\nexport const useTranslation = () => {\n  const language = useSelector(languageSelector);\n\n  const t = (word: string) => {\n    switch (language) {\n      case LanguageType.English:\n        if (!en.translation[word]) return word;\n        return en.translation[word];\n      case LanguageType.Farsi:\n        if (!fas.translation[word]) return word;\n        return fas.translation[word];\n      case LanguageType.Finnish:\n        if (!fi.translation[word]) return word;\n        return fi.translation[word];\n      case LanguageType.French:\n        if (!fr.translation[word]) return word;\n        return fr.translation[word];\n      case LanguageType.German:\n        if (!de.translation[word]) return word;\n        return de.translation[word];\n      case LanguageType.Greek:\n        if (!gr.translation[word]) return word;\n        return gr.translation[word];\n      case LanguageType.Hindi:\n        if (!hi.translation[word]) return word;\n        return hi.translation[word];\n      case LanguageType.Hungarian:\n        if (!hu.translation[word]) return word;\n        return hu.translation[word];\n      default:\n        return word;\n    }\n  };\n\n  return t;\n};\n","import React from \"react\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { CategoryType } from \"../../../../../types/CategoryType\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { applicationSlice } from \"../../../../../store\";\nimport { selectedCategorySelector } from \"../../../../../store/selectors\";\n\ntype HideOrShowCategoryMenuItemProps = {\n  category: CategoryType;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLLIElement, MouseEvent>\n  ) => void;\n};\n\nexport const HideOrShowCategoryMenuItem = ({\n  onCloseCategoryMenu,\n}: HideOrShowCategoryMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const onClick = (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => {\n    dispatch(\n      applicationSlice.actions.setCategoryVisibility({\n        category: category,\n        visible: !category.visible,\n      })\n    );\n\n    onCloseCategoryMenu(event);\n  };\n\n  const t = useTranslation();\n\n  const translatedHide = t(\"Hide category\");\n  const translatedShow = t(\"Show category\");\n\n  return (\n    <MenuItem onClick={onClick}>\n      <Typography variant=\"inherit\">\n        {category.visible ? translatedHide : translatedShow}\n      </Typography>\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { CategoryType } from \"../../../../../types/CategoryType\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { applicationSlice } from \"../../../../../store\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  selectedCategorySelector,\n} from \"../../../../../store/selectors\";\n\ntype HideOtherCategoriesMenuItemProps = {\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => void;\n};\n\nexport const HideOtherCategoriesMenuItem = ({\n  onCloseCategoryMenu,\n}: HideOtherCategoriesMenuItemProps) => {\n  const categories = useSelector(categoriesSelector);\n\n  const category = useSelector(selectedCategorySelector);\n\n  const dispatch = useDispatch();\n\n  const onClick = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    for (let cat of categories) {\n      if (category.id != cat.id) {\n        dispatch(\n          applicationSlice.actions.setCategoryVisibility({\n            category: cat,\n            visible: false,\n          })\n        );\n      }\n    }\n    onCloseCategoryMenu(event);\n  };\n\n  const t = useTranslation();\n\n  return (\n    <MenuItem onClick={onClick}>\n      <Typography variant=\"inherit\">{t(\"Hide other categories\")}</Typography>\n    </MenuItem>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imagesSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): Array<ImageType> => {\n  return state.present.images;\n};\n","import React from \"react\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuList from \"@material-ui/core/MenuList\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { CategoryType } from \"../../../../../types/CategoryType\";\nimport { HideOrShowCategoryMenuItem } from \"../HideOrShowCategoryMenuItem\";\nimport { HideOtherCategoriesMenuItem } from \"../HideOtherCategoriesMenuItem\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { imagesSelector } from \"../../../../../store/selectors/imagesSelector\";\nimport { applicationSlice } from \"../../../../../store/slices\";\nimport { selectedCategorySelector } from \"../../../../../store/selectors\";\n\ntype CategoryMenuProps = {\n  anchorElCategoryMenu: any;\n  onCloseCategoryMenu: (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => void;\n  onOpenCategoryMenu: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  openCategoryMenu: boolean;\n  onOpenDeleteCategoryDialog: () => void;\n  onOpenEditCategoryDialog: () => void;\n};\n\nexport const CategoryMenu = ({\n  anchorElCategoryMenu,\n  onCloseCategoryMenu,\n  openCategoryMenu,\n  onOpenDeleteCategoryDialog,\n  onOpenEditCategoryDialog,\n}: CategoryMenuProps) => {\n  const images = useSelector(imagesSelector);\n\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const onOpenDeleteCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    //cycle through the annotations to determine if annotations of that category exist\n    // show a warning dialog box is they do exist\n    let existAnnotations = false;\n    for (let i = 0; i < images.length; i++) {\n      if (!existAnnotations) {\n        for (let j = 0; j < images[i].annotations.length; j++) {\n          if (images[i].annotations[j].categoryId === category.id) {\n            existAnnotations = true;\n          }\n        }\n      }\n    }\n    if (existAnnotations) {\n      onOpenDeleteCategoryDialog();\n    } //warn user that these annotations will be relabeled as unknown\n    else {\n      dispatch(\n        applicationSlice.actions.setSelectedCategory({\n          selectedCategory: \"00000000-0000-0000-0000-000000000000\",\n        })\n      );\n\n      dispatch(applicationSlice.actions.deleteCategory({ category: category }));\n    }\n    onCloseCategoryMenu(event);\n  };\n\n  const onOpenEditCategoryDialogClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    onOpenEditCategoryDialog();\n    onCloseCategoryMenu(event);\n  };\n\n  const t = useTranslation();\n\n  return (\n    <Menu\n      anchorEl={anchorElCategoryMenu}\n      anchorOrigin={{ horizontal: \"center\", vertical: \"bottom\" }}\n      getContentAnchorEl={null}\n      onClose={onCloseCategoryMenu}\n      open={openCategoryMenu}\n      transformOrigin={{ horizontal: \"center\", vertical: \"top\" }}\n    >\n      <MenuList dense variant=\"menu\">\n        <HideOtherCategoriesMenuItem\n          onCloseCategoryMenu={onCloseCategoryMenu}\n        />\n\n        <HideOrShowCategoryMenuItem\n          category={category}\n          onCloseCategoryMenu={onCloseCategoryMenu}\n        />\n\n        <div>\n          <Divider />\n\n          <MenuItem onClick={onOpenEditCategoryDialogClick}>\n            <Typography variant=\"inherit\">{t(\"Edit category\")}</Typography>\n          </MenuItem>\n        </div>\n\n        {category.id !== \"00000000-0000-0000-0000-000000000000\" && (\n          <MenuItem onClick={onOpenDeleteCategoryDialogClick}>\n            <Typography variant=\"inherit\">{t(\"Delete category\")}</Typography>\n          </MenuItem>\n        )}\n      </MenuList>\n    </Menu>\n  );\n};\n","import React from \"react\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport Button from \"@material-ui/core/Button\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { AnnotationType } from \"../../../../types/AnnotationType\";\nimport { applicationSlice } from \"../../../../store\";\nimport {\n  imageInstancesSelector,\n  selectedCategorySelector,\n  unknownCategorySelector,\n} from \"../../../../store/selectors\";\n\ntype DeleteCategoryDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const DeleteCategoryDialog = ({\n  onClose,\n  open,\n}: DeleteCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const selections = useSelector(imageInstancesSelector);\n\n  const unknownCategory = useSelector(unknownCategorySelector);\n\n  const onDelete = () => {\n    dispatch(\n      applicationSlice.actions.setSelectedCategory({\n        selectedCategory: \"00000000-0000-0000-0000-000000000000\",\n      })\n    );\n\n    dispatch(applicationSlice.actions.deleteCategory({ category: category }));\n\n    const instances = selections?.map((instance: AnnotationType) => {\n      if (instance.categoryId === category.id) {\n        return {\n          ...instance,\n          categoryId: \"00000000-0000-0000-0000-000000000000\",\n        };\n      } else {\n        return instance;\n      }\n    });\n\n    dispatch(\n      applicationSlice.actions.setImageInstances({\n        instances: instances as Array<AnnotationType>,\n      })\n    );\n\n    onClose();\n  };\n\n  return (\n    <Dialog disableBackdropClick={true} fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Delete \"{category.name}\" category?</DialogTitle>\n\n      <DialogContent>\n        Annotations categorized as \"{category.name}\" will not be deleted and\n        instead will be labeled as \"{unknownCategory.name}\".\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onDelete} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  alert: {\n    width: theme.spacing(64),\n  },\n  appBar: {\n    transition: theme.transitions.create([\"margin\", \"width\"], {\n      duration: theme.transitions.duration.leavingScreen,\n      easing: theme.transitions.easing.sharp,\n    }),\n  },\n  appBarShift: {\n    marginLeft: theme.spacing(32),\n    transition: theme.transitions.create([\"margin\", \"width\"], {\n      duration: theme.transitions.duration.enteringScreen,\n      easing: theme.transitions.easing.easeOut,\n    }),\n    width: `calc(100% - ${theme.spacing(32)}px)`,\n  },\n  card: {},\n  classifierSettingsDialogContent: {\n    marginTop: theme.spacing(8),\n  },\n  chip: {\n    height: \"20px\",\n    borderWidth: \"2px\",\n    fontSize: \"0.875rem\",\n    color: \"white\",\n  },\n  colorPicker: {\n    margin: \"16px\",\n  },\n  container: {\n    paddingBottom: theme.spacing(8),\n    paddingTop: theme.spacing(8),\n  },\n  createCategoryDialogContent: {\n    paddingLeft: \"0 !important\",\n  },\n  createCategoryDialogGrid: {\n    margin: theme.spacing(1),\n  },\n  createCategoryDialogItem: {\n    // paddingLeft: \"0 !important\",\n  },\n  drawer: {\n    flexShrink: 0,\n    width: theme.spacing(32),\n  },\n  drawerHeader: {\n    ...theme.mixins.toolbar,\n    alignItems: \"center\",\n    display: \"flex\",\n    paddingLeft: theme.spacing(3),\n  },\n  drawerPaper: {\n    width: theme.spacing(32),\n  },\n  fileInput: {\n    display: \"none\",\n  },\n  gridList: {\n    transform: \"translateZ(0)\",\n  },\n  gridTileBar: {\n    background:\n      \"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0) 100%)\",\n  },\n  gridTileBarIconButton: {\n    color: \"white\",\n  },\n  imageDialogAppBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  imageDialogContent: {\n    paddingBottom: theme.spacing(12),\n    paddingTop: theme.spacing(12),\n  },\n  imageSelected: {\n    border: \"solid 2px blue\",\n    borderRadius: \"3px\",\n  },\n  imageUnselected: {\n    border: \"none\",\n  },\n  main: {\n    flexGrow: 1,\n    marginLeft: -theme.spacing(32),\n    padding: theme.spacing(3),\n    transition: theme.transitions.create(\"margin\", {\n      duration: theme.transitions.duration.leavingScreen,\n      easing: theme.transitions.easing.sharp,\n    }),\n  },\n  mainShift: {\n    marginLeft: theme.spacing(32),\n    transition: theme.transitions.create(\"margin\", {\n      duration: theme.transitions.duration.enteringScreen,\n      easing: theme.transitions.easing.easeOut,\n    }),\n  },\n  media: {},\n  progress: {\n    width: \"100%\",\n  },\n  settingsDialogAppBar: {},\n  slider: {\n    padding: theme.spacing(3),\n  },\n  sliderInput: {\n    width: 42,\n  },\n}));\n","import { Label } from \"@material-ui/icons\";\nimport * as React from \"react\";\nimport { Avatar, IconButton } from \"@material-ui/core\";\nimport Popover from \"@material-ui/core/Popover\";\nimport { CirclePicker, ColorResult } from \"react-color\";\nimport { useStyles } from \"./ColorIcon.css\";\n\nconst COLORS = [\n  \"#f44336\",\n  \"#e91e63\",\n  \"#9c27b0\",\n  \"#673ab7\",\n  \"#3f51b5\",\n  \"#2196f3\",\n  \"#03a9f4\",\n  \"#00bcd4\",\n  \"#009688\",\n  \"#4caf50\",\n  \"#8bc34a\",\n  \"#cddc39\",\n  \"#ffeb3b\",\n  \"#ffc107\",\n  \"#ff9800\",\n  \"#ff5722\",\n  \"#795548\",\n  \"#607d8b\",\n];\n\ntype ColorIconButtonProps = {\n  color: string;\n  onColorChange: (color: any) => void;\n};\n\nexport const ColorIcon = ({ color, onColorChange }: ColorIconButtonProps) => {\n  const classes = useStyles();\n\n  const [\n    colorMenuAnchorEl,\n    setColorMenuAnchorEl,\n  ] = React.useState<null | HTMLButtonElement>(null);\n\n  const colorPopupOpen = Boolean(colorMenuAnchorEl);\n\n  const onOpenColorPicker = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setColorMenuAnchorEl(event.currentTarget);\n  };\n\n  const onCloseColorPicker = () => {\n    setColorMenuAnchorEl(null);\n  };\n\n  const onChange = (color: ColorResult) => {\n    onColorChange(color);\n    onCloseColorPicker();\n  };\n\n  return (\n    <React.Fragment>\n      <IconButton onClick={onOpenColorPicker}>\n        <Avatar style={{ backgroundColor: \"#F3F3F3\" }}>\n          <Label style={{ color: color }} />\n        </Avatar>\n      </IconButton>\n      <Popover\n        id=\"color-menu\"\n        open={colorPopupOpen}\n        anchorEl={colorMenuAnchorEl}\n        onClose={onCloseColorPicker}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\",\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\",\n        }}\n      >\n        <div className={classes.colorPicker}>\n          <CirclePicker colors={COLORS} onChange={onChange} />\n        </div>\n      </Popover>\n    </React.Fragment>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  alert: {\n    width: theme.spacing(64),\n  },\n  appBar: {\n    transition: theme.transitions.create([\"margin\", \"width\"], {\n      duration: theme.transitions.duration.leavingScreen,\n      easing: theme.transitions.easing.sharp,\n    }),\n  },\n  appBarShift: {\n    marginLeft: theme.spacing(32),\n    transition: theme.transitions.create([\"margin\", \"width\"], {\n      duration: theme.transitions.duration.enteringScreen,\n      easing: theme.transitions.easing.easeOut,\n    }),\n    width: `calc(100% - ${theme.spacing(32)}px)`,\n  },\n  card: {},\n  classifierSettingsDialogContent: {\n    marginTop: theme.spacing(8),\n  },\n  chip: {\n    height: \"20px\",\n    borderWidth: \"2px\",\n    fontSize: \"0.875rem\",\n    color: \"white\",\n  },\n  colorPicker: {\n    margin: \"16px\",\n  },\n  container: {\n    paddingBottom: theme.spacing(8),\n    paddingTop: theme.spacing(8),\n  },\n  createCategoryDialogContent: {\n    paddingLeft: \"0 !important\",\n  },\n  createCategoryDialogGrid: {\n    margin: theme.spacing(1),\n  },\n  createCategoryDialogItem: {\n    // paddingLeft: \"0 !important\",\n  },\n  drawer: {\n    flexShrink: 0,\n    width: theme.spacing(32),\n  },\n  drawerHeader: {\n    ...theme.mixins.toolbar,\n    alignItems: \"center\",\n    display: \"flex\",\n    paddingLeft: theme.spacing(3),\n  },\n  drawerPaper: {\n    width: theme.spacing(32),\n  },\n  fileInput: {\n    display: \"none\",\n  },\n  gridList: {\n    transform: \"translateZ(0)\",\n  },\n  gridTileBar: {\n    background:\n      \"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0) 100%)\",\n  },\n  gridTileBarIconButton: {\n    color: \"white\",\n  },\n  imageDialogAppBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  imageDialogContent: {\n    paddingBottom: theme.spacing(12),\n    paddingTop: theme.spacing(12),\n  },\n  imageSelected: {\n    border: \"solid 2px blue\",\n    borderRadius: \"3px\",\n  },\n  imageUnselected: {\n    border: \"none\",\n  },\n  main: {\n    flexGrow: 1,\n    marginLeft: -theme.spacing(32),\n    padding: theme.spacing(3),\n    transition: theme.transitions.create(\"margin\", {\n      duration: theme.transitions.duration.leavingScreen,\n      easing: theme.transitions.easing.sharp,\n    }),\n  },\n  mainShift: {\n    marginLeft: theme.spacing(32),\n    transition: theme.transitions.create(\"margin\", {\n      duration: theme.transitions.duration.enteringScreen,\n      easing: theme.transitions.easing.easeOut,\n    }),\n  },\n  media: {},\n  progress: {\n    width: \"100%\",\n  },\n  settingsDialogAppBar: {},\n  slider: {\n    padding: theme.spacing(3),\n  },\n  sliderInput: {\n    width: 42,\n  },\n}));\n","import Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport Button from \"@material-ui/core/Button\";\nimport React, { ChangeEvent, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Grid from \"@material-ui/core/Grid\";\nimport { ColorIcon } from \"../ColorIcon\";\nimport { useStyles } from \"./EditCategoryDialog.css\";\nimport { CategoryType } from \"../../../../types/CategoryType\";\nimport { applicationSlice } from \"../../../../store\";\nimport {\n  categoriesSelector,\n  selectedCategorySelector,\n} from \"../../../../store/selectors\";\n\ntype EditCategoryDialogProps = {\n  onCloseDialog: () => void;\n  openDialog: boolean;\n};\n\nexport const EditCategoryDialog = ({\n  onCloseDialog,\n  openDialog,\n}: EditCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const category = useSelector(selectedCategorySelector);\n\n  const classes = useStyles();\n\n  const [color, setColor] = useState<string>(category.color);\n\n  const onColorChange = (color: any) => {\n    setColor(color.hex);\n  };\n\n  useEffect(() => {\n    setName(category.name);\n    setColor(category.color);\n  }, [category]);\n\n  const [name, setName] = useState<string>(category.name);\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setName(event.target.value);\n  };\n\n  const categories = useSelector(categoriesSelector);\n\n  const onEdit = () => {\n    const updatedCategories = categories?.map((v: CategoryType) => {\n      if (v.id === category.id) {\n        return {\n          ...category,\n          color: color,\n          name: name,\n        };\n      } else {\n        return v;\n      }\n    });\n    dispatch(\n      applicationSlice.actions.setCategories({ categories: updatedCategories })\n    );\n\n    onCloseDialog();\n  };\n\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      onClose={onCloseDialog}\n      open={openDialog}\n    >\n      <DialogTitle>Edit category</DialogTitle>\n\n      <DialogContent>\n        <div>\n          <Grid container spacing={1}>\n            <Grid item xs={2} className={classes.createCategoryDialogItem}>\n              <ColorIcon color={color} onColorChange={onColorChange} />\n            </Grid>\n            <Grid item xs={10}>\n              <TextField\n                autoFocus\n                fullWidth\n                id=\"name\"\n                label=\"Name\"\n                margin=\"dense\"\n                onChange={onNameChange}\n                value={name}\n              />\n            </Grid>\n          </Grid>\n        </div>\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onCloseDialog} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onEdit} color=\"primary\">\n          Update\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import * as ImageJS from \"image-js\";\n\nexport abstract class Tool {\n  image: ImageJS.Image;\n\n  constructor(image: ImageJS.Image) {\n    this.image = image;\n  }\n}\n","/*\n (c) 2017, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\n// (function () { 'use strict';\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1: Array<number>, p2: Array<number>) {\n  var dx = p1[0] - p2[0],\n    dy = p1[1] - p2[1];\n\n  return dx * dx + dy * dy;\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p: Array<number>, p1: Array<number>, p2: Array<number>) {\n  var x = p1[0],\n    y = p1[1],\n    dx = p2[0] - x,\n    dy = p2[1] - y;\n\n  if (dx !== 0 || dy !== 0) {\n    var t = ((p[0] - x) * dx + (p[1] - y) * dy) / (dx * dx + dy * dy);\n\n    if (t > 1) {\n      x = p2[0];\n      y = p2[1];\n    } else if (t > 0) {\n      x += dx * t;\n      y += dy * t;\n    }\n  }\n\n  dx = p[0] - x;\n  dy = p[1] - y;\n\n  return dx * dx + dy * dy;\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nfunction simplifyRadialDist(points: Array<Array<number>>, sqTolerance: number) {\n  var prevPoint = points[0];\n  var newPoints = [prevPoint];\n  var point: Array<number> = [];\n\n  for (var i = 1, len = points.length; i < len; i++) {\n    point = points[i];\n\n    if (getSqDist(point, prevPoint) > sqTolerance) {\n      newPoints.push(point);\n      prevPoint = point;\n    }\n  }\n\n  if (prevPoint !== point) newPoints.push(point);\n\n  return newPoints;\n}\n\nfunction simplifyDPStep(\n  points: Array<Array<number>>,\n  first: number,\n  last: number,\n  sqTolerance: number,\n  simplified: Array<Array<number>>\n) {\n  let maxSqDist = sqTolerance;\n  let index: number = 0;\n\n  for (var i = first + 1; i < last; i++) {\n    var sqDist = getSqSegDist(points[i], points[first], points[last]);\n\n    if (sqDist > maxSqDist) {\n      index = i;\n      maxSqDist = sqDist;\n    }\n  }\n\n  if (maxSqDist > sqTolerance) {\n    if (index - first > 1)\n      simplifyDPStep(points, first, index, sqTolerance, simplified);\n    simplified.push(points[index]);\n    if (last - index > 1)\n      simplifyDPStep(points, index, last, sqTolerance, simplified);\n  }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nfunction simplifyDouglasPeucker(\n  points: Array<Array<number>>,\n  sqTolerance: number\n) {\n  var last = points.length - 1;\n\n  var simplified = [points[0]];\n  simplifyDPStep(points, 0, last, sqTolerance, simplified);\n  simplified.push(points[last]);\n\n  return simplified;\n}\n\n// both algorithms combined for awesome performance\nexport function simplify(\n  points: Array<Array<number>>,\n  tolerance: number,\n  highestQuality: boolean\n) {\n  if (points.length <= 2) return points;\n\n  var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;\n\n  points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);\n  points = simplifyDouglasPeucker(points, sqTolerance);\n\n  return points;\n}\n\n// // export as AMD module / Node module / browser or worker variable\n//     if (typeof define === 'function' && define.amd) define(function() { return simplify; });\n//     else if (typeof module !== 'undefined') {\n//         module.exports = simplify;\n//         module.exports.default = simplify;\n//     } else if (typeof self !== 'undefined') self.simplify = simplify;\n//     else window.simplify = simplify;\n\n// })();\n","// Code from: https://github.com/kamoroso94/polygon-fill-benchmark\n\n// linear interpolation\n// finds x-value from scanline intersecting edge\nexport function lerp(\n  yScan: number,\n  [[x1, y1], [x2, y2]]: Array<Array<number>>\n) {\n  return Math.floor(((yScan - y1) / (y2 - y1)) * (x2 - x1) + x1);\n}\n\n// returns minimum y-value of two points\nexport function getYMin([[, y1], [, y2]]: Array<Array<number>>) {\n  return y1 <= y2 ? y1 : y2;\n}\n\n// returns maximum y-value of two points\nexport function getYMax([[, y1], [, y2]]: Array<Array<number>>) {\n  return y1 > y2 ? y1 : y2;\n}\n\n// returns the x-value of the point with the minimum y-value\nexport function getXofYMin([[x1, y1], [x2, y2]]: Array<Array<number>>) {\n  return y1 <= y2 ? x1 : x2;\n}\n\n// returns the x-value of the point with the maximum y-value\nexport function getXofYMax([[x1, y1], [x2, y2]]: Array<Array<number>>) {\n  return y1 > y2 ? x1 : x2;\n}\n\n// converts list of points to list of non-horizontal edges\nexport function pointsToEdges(points: Array<Array<number>>) {\n  let edges = [];\n  let p1 = points[points.length - 1];\n  for (let i = 0; i < points.length; i++) {\n    const p2 = points[i];\n    // ignore horizontal edges\n    if (p1[1] != p2[1]) edges.push([p1, p2]);\n    p1 = p2;\n  }\n  return edges;\n}\n","// Code from: https://github.com/kamoroso94/polygon-fill-benchmark\n\nimport * as ImageJS from \"image-js\";\n\nimport {\n  getXofYMax,\n  getXofYMin,\n  getYMax,\n  getYMin,\n  lerp,\n  pointsToEdges,\n} from \"./util\";\n\n// Scnaline Polygon Fill\nexport function slpf(points: Array<Array<number>>, img: ImageJS.Image) {\n  if (points.length < 3) return;\n\n  // initialize ET and AET\n  const ET: Array<Array<Array<number>>> = pointsToEdges(points).sort(\n    (e1: Array<Array<number>>, e2: Array<Array<number>>) =>\n      getYMin(e2) - getYMin(e1)\n  );\n  const AET: Array<Array<Array<number>>> = [];\n  let yScan = getYMin(ET[ET.length - 1]);\n\n  // repeat until both ET and AET are empty\n  while (ET.length > 0 || AET.length > 0) {\n    // manage AET\n    moveEdges(yScan, ET, AET);\n    removeEdges(yScan, AET);\n    AET.sort((e1, e2) => {\n      const cmp = getXofYMin(e1) - getXofYMin(e2);\n      return cmp == 0 ? getXofYMax(e1) - getXofYMax(e2) : cmp;\n    });\n    // fill spans on scanline\n    const spans = getSpans(yScan, AET);\n    drawSpans(spans, yScan, img);\n    yScan++;\n  }\n}\n\n// move active edges from ET to AET\nfunction moveEdges(\n  yScan: number,\n  ET: Array<Array<Array<number>>>,\n  AET: Array<Array<Array<number>>>\n) {\n  while (ET.length > 0 && yScan === getYMin(ET[ET.length - 1])) {\n    AET.push(ET.pop()!);\n  }\n}\n\n// remove inactive edges from AET\nfunction removeEdges(yScan: number, AET: Array<Array<Array<number>>>) {\n  for (let i = 0; i < AET.length; i++) {\n    if (yScan >= getYMax(AET[i])) {\n      const last = AET.pop();\n      if (i < AET.length && last) {\n        AET[i] = last;\n        i--;\n      }\n    }\n  }\n}\n\n// find spans along scanline\nfunction getSpans(yScan: number, AET: Array<Array<Array<number>>>) {\n  const spans = [];\n  for (const edge of AET) {\n    spans.push(lerp(yScan, edge));\n  }\n  return spans;\n}\n\nfunction drawSpans(spans: Array<number>, yScan: number, img: ImageJS.Image) {\n  for (let i = 0; i < spans.length; i += 2) {\n    fillSpan(spans[i], spans[i + 1], yScan, img);\n  }\n}\n\n// fill pixels within a span\nfunction fillSpan(x1: number, x2: number, y: number, img: ImageJS.Image) {\n  for (let x = x1; x < x2; x++) {\n    img.setPixelXY(x, y, [255, 255, 255, 255]);\n  }\n}\n","import { AnnotationType } from \"../../../../types/AnnotationType\";\nimport * as ImageJS from \"image-js\";\nimport { CategoryType } from \"../../../../types/CategoryType\";\nimport * as _ from \"lodash\";\nimport { connectPoints, drawLine } from \"../../../imageHelper\";\nimport { simplify } from \"../../../simplify/simplify\";\nimport { slpf } from \"../../../polygon-fill/slpf\";\nimport * as uuid from \"uuid\";\nimport { decode, encode } from \"../../../rle\";\nimport { Tool } from \"../../Tool\";\n\nexport abstract class AnnotationTool extends Tool {\n  manager: ImageJS.RoiManager;\n  points?: Array<number> = [];\n  annotated: boolean = false;\n  annotating: boolean = false;\n  annotation?: AnnotationType;\n\n  anchor?: { x: number; y: number } = undefined;\n  origin?: { x: number; y: number } = undefined;\n  buffer?: Array<number> = [];\n\n  protected _boundingBox?: [number, number, number, number];\n  protected _mask?: Array<number>;\n\n  constructor(image: ImageJS.Image) {\n    super(image);\n\n    this.manager = image.getRoiManager();\n  }\n\n  /*\n   * Method for add, subtract and intersect modes.\n   * Draw a ROI mask in the coordinate space of the new combined bounding box.\n   * */\n  drawMaskInNewBoundingBox(\n    newMaskImage: ImageJS.Image,\n    maskImage: ImageJS.Image,\n    boundingBox: [number, number, number, number],\n    newBoundingBox: [number, number, number, number]\n  ) {\n    for (let x = 0; x < maskImage.width; x++) {\n      for (let y = 0; y < maskImage.height; y++) {\n        const pixel = maskImage.getPixelXY(x, y)[0];\n        // if (x > boundingBox1[2] && pixel > 0) console.info(\"Not supposed to happen\")\n        if (pixel === 255) {\n          newMaskImage.setPixelXY(\n            x + boundingBox[0] - newBoundingBox[0],\n            y + boundingBox[1] - newBoundingBox[1],\n            [255]\n          );\n        }\n      }\n    }\n    return newMaskImage;\n  }\n\n  inBoundingBox(\n    x: number,\n    y: number,\n    boundingBox: [number, number, number, number]\n  ) {\n    if (x < 0 || y < 0) return false;\n    if (x > boundingBox[2] - boundingBox[0]) return false;\n    if (y > boundingBox[3] - boundingBox[1]) return false;\n    return true;\n  }\n  /*\n   * Adding to a Operator adds any new areas you select to your existing\n   * Operator.\n   */\n  add(\n    encodedMaskData1: Array<number>,\n    boundingBox1: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    if (!this._mask || !this._boundingBox) return [[], [0, 0, 0, 0]];\n\n    const maskData1 = decode(encodedMaskData1);\n    const maskData2 = decode(this._mask);\n    const boundingBox2 = this._boundingBox;\n\n    const newBoundingBox = [\n      boundingBox2[0] < boundingBox1[0] ? boundingBox2[0] : boundingBox1[0],\n      boundingBox2[1] < boundingBox1[1] ? boundingBox2[1] : boundingBox1[1],\n      boundingBox2[2] > boundingBox1[2] ? boundingBox2[2] : boundingBox1[2],\n      boundingBox2[3] > boundingBox1[3] ? boundingBox2[3] : boundingBox1[3],\n    ] as [number, number, number, number];\n    //\n    const newBoundingBoxWidth = newBoundingBox[2] - newBoundingBox[0];\n    const newBoundingBoxHeight = newBoundingBox[3] - newBoundingBox[1];\n\n    const newMaskData = [];\n    const deltaX1 = boundingBox1[0] - newBoundingBox[0];\n    const deltaY1 = boundingBox1[1] - newBoundingBox[1];\n    const deltaX2 = boundingBox2[0] - newBoundingBox[0];\n    const deltaY2 = boundingBox2[1] - newBoundingBox[1];\n\n    for (let i = 0; i < newBoundingBoxWidth * newBoundingBoxHeight; i++) {\n      const x = i % newBoundingBoxWidth;\n      const y = Math.floor(i / newBoundingBoxWidth);\n      const b1x = x - deltaX1;\n      const b1y = y - deltaY1;\n      const b2x = x - deltaX2;\n      const b2y = y - deltaY2;\n\n      const b1i = b1x + b1y * (boundingBox1[2] - boundingBox1[0]);\n      const b2i = b2x + b2y * (boundingBox2[2] - boundingBox2[0]);\n      if (\n        (this.inBoundingBox(b1x, b1y, boundingBox1) &&\n          maskData1[b1i] === 255) ||\n        (this.inBoundingBox(b2x, b2y, boundingBox2) && maskData2[b2i] === 255)\n      ) {\n        newMaskData.push(255);\n      } else {\n        newMaskData.push(0);\n      }\n    }\n\n    return [encode(Uint8Array.from(newMaskData)), newBoundingBox];\n  }\n\n  connect() {\n    if (this.annotated) return;\n\n    if (!this.anchor || !this.origin) return;\n\n    if (!this.buffer) return;\n\n    const anchorIndex = _.findLastIndex(this.buffer, (point) => {\n      return point === this.anchor!.x;\n    });\n\n    const segment = _.flatten(\n      drawLine([this.anchor.x, this.anchor.y], [this.origin.x, this.origin.y])\n    );\n\n    this.buffer.splice(anchorIndex, segment.length, ...segment);\n\n    this._boundingBox = this.computeBoundingBoxFromContours(this.buffer);\n\n    this.points = this.buffer;\n\n    const maskImage = this.computeMask().crop({\n      x: this._boundingBox[0],\n      y: this._boundingBox[1],\n      width: this._boundingBox[2] - this._boundingBox[0],\n      height: this._boundingBox[3] - this._boundingBox[1],\n    });\n\n    this._mask = encode(maskImage.data);\n\n    console.error(maskImage.toDataURL());\n\n    this.anchor = undefined;\n    this.origin = undefined;\n    this.buffer = [];\n\n    this.annotated = true;\n    this.annotating = false;\n  }\n\n  /*\n   * When using the Intersect Operator mode, any currently selected areas you\n   * select over will be kept and any currently selected areas outside your\n   * new Operator will be removed from the Operator.\n   */\n  intersect(\n    decodedMask1: Array<number>,\n    boundingBox1: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    if (!this._mask || !this._boundingBox) return [[], [0, 0, 0, 0]];\n\n    const maskData1 = decode(decodedMask1);\n    const maskData2 = decode(this._mask);\n\n    const boundingBox2 = this._boundingBox;\n\n    const newBoundingBox = [\n      boundingBox2[0] > boundingBox1[0] ? boundingBox2[0] : boundingBox1[0],\n      boundingBox2[1] > boundingBox1[1] ? boundingBox2[1] : boundingBox1[1],\n      boundingBox2[2] < boundingBox1[2] ? boundingBox2[2] : boundingBox1[2],\n      boundingBox2[3] < boundingBox1[3] ? boundingBox2[3] : boundingBox1[3],\n    ] as [number, number, number, number];\n\n    const newBoundingBoxWidth = newBoundingBox[2] - newBoundingBox[0];\n    const newBoundingBoxHeight = newBoundingBox[3] - newBoundingBox[1];\n\n    const newMaskData = [];\n    const deltaX1 = boundingBox1[0] - newBoundingBox[0];\n    const deltaY1 = boundingBox1[1] - newBoundingBox[1];\n    const deltaX2 = boundingBox2[0] - newBoundingBox[0];\n    const deltaY2 = boundingBox2[1] - newBoundingBox[1];\n\n    for (let i = 0; i < newBoundingBoxWidth * newBoundingBoxHeight; i++) {\n      const x = i % newBoundingBoxWidth;\n      const y = Math.floor(i / newBoundingBoxWidth);\n      const b1x = x - deltaX1;\n      const b1y = y - deltaY1;\n      const b2x = x - deltaX2;\n      const b2y = y - deltaY2;\n\n      const b1i = b1x + b1y * (boundingBox1[2] - boundingBox1[0]);\n      const b2i = b2x + b2y * (boundingBox2[2] - boundingBox2[0]);\n      if (\n        this.inBoundingBox(b1x, b1y, boundingBox1) &&\n        maskData1[b1i] === 255 &&\n        this.inBoundingBox(b2x, b2y, boundingBox2) &&\n        maskData2[b2i] === 255\n      ) {\n        newMaskData.push(255);\n      } else {\n        newMaskData.push(0);\n      }\n    }\n\n    return [encode(Uint8Array.from(newMaskData)), newBoundingBox];\n  }\n\n  /*\n   * Invert selected mask and compute inverted bounding box coordinates\n   * */\n  invert(\n    selectedMask: Array<number>,\n    selectedBoundingBox: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    const mask = decode(selectedMask);\n\n    const imageWidth = this.image.width;\n    const imageHeight = this.image.height;\n\n    //find min and max boundary points when computing the mask\n    const invertedBoundingBox: [number, number, number, number] = [\n      imageWidth,\n      imageHeight,\n      0,\n      0,\n    ];\n\n    const invertedMask = new ImageJS.Image(imageWidth, imageHeight, {\n      components: 1,\n      alpha: 0,\n    });\n    for (let x = 0; x < imageWidth; x++) {\n      for (let y = 0; y < imageHeight; y++) {\n        const x_mask = x - selectedBoundingBox[0];\n        const y_mask = y - selectedBoundingBox[1];\n        const value =\n          mask[\n            x_mask + y_mask * (selectedBoundingBox[2] - selectedBoundingBox[0])\n          ];\n        if (\n          value > 0 &&\n          this.inBoundingBox(x_mask, y_mask, selectedBoundingBox)\n        ) {\n          invertedMask.setPixelXY(x, y, [0]);\n        } else {\n          invertedMask.setPixelXY(x, y, [255]);\n          if (x < invertedBoundingBox[0]) {\n            invertedBoundingBox[0] = x;\n          } else if (x > invertedBoundingBox[2]) {\n            invertedBoundingBox[2] = x + 1;\n          }\n          if (y < invertedBoundingBox[1]) {\n            invertedBoundingBox[1] = y;\n          } else if (y > invertedBoundingBox[3]) {\n            invertedBoundingBox[3] = y + 1;\n          }\n        }\n      }\n    }\n\n    //now crop the mask using the new bounding box\n    const croppedInvertedMask = invertedMask.crop({\n      x: invertedBoundingBox[0],\n      y: invertedBoundingBox[1],\n      width: invertedBoundingBox[2] - invertedBoundingBox[0],\n      height: invertedBoundingBox[3] - invertedBoundingBox[1],\n    });\n\n    const invertedmaskData = encode(Uint8Array.from(croppedInvertedMask.data));\n\n    return [invertedmaskData, invertedBoundingBox];\n  }\n\n  /*\n   * Subtracting from a Operator deselects the areas you draw over, keeping\n   * the rest of your existing Operator.\n   */\n  subtract(\n    encodedMaskData1: Array<number>,\n    boundingBox1: [number, number, number, number]\n  ): [Array<number>, [number, number, number, number]] {\n    if (!this._mask || !this._boundingBox) return [[], [0, 0, 0, 0]];\n\n    const maskData1 = decode(encodedMaskData1);\n    const maskData2 = decode(this._mask);\n\n    const boundingBox2 = this._boundingBox;\n\n    const newBoundingBox = [\n      boundingBox2[2] > boundingBox1[0] &&\n      boundingBox2[0] < boundingBox1[0] &&\n      boundingBox2[1] < boundingBox1[1] &&\n      boundingBox2[3] > boundingBox1[3]\n        ? boundingBox2[2]\n        : boundingBox1[0],\n      boundingBox2[3] > boundingBox1[1] &&\n      boundingBox2[1] < boundingBox1[1] &&\n      boundingBox2[0] < boundingBox1[0] &&\n      boundingBox2[2] > boundingBox1[2]\n        ? boundingBox2[3]\n        : boundingBox1[1],\n      boundingBox2[0] < boundingBox1[2] &&\n      boundingBox2[2] > boundingBox1[2] &&\n      boundingBox2[1] < boundingBox1[1] &&\n      boundingBox2[3] > boundingBox1[3]\n        ? boundingBox2[0]\n        : boundingBox1[2],\n      boundingBox2[1] < boundingBox1[3] &&\n      boundingBox2[3] > boundingBox1[3] &&\n      boundingBox2[0] < boundingBox1[0] &&\n      boundingBox2[2] > boundingBox1[2]\n        ? boundingBox2[1]\n        : boundingBox1[3],\n    ] as [number, number, number, number];\n\n    const newBoundingBoxWidth = newBoundingBox[2] - newBoundingBox[0];\n    const newBoundingBoxHeight = newBoundingBox[3] - newBoundingBox[1];\n\n    const newMaskData = [];\n    const deltaX1 = boundingBox1[0] - newBoundingBox[0];\n    const deltaY1 = boundingBox1[1] - newBoundingBox[1];\n    const deltaX2 = boundingBox2[0] - newBoundingBox[0];\n    const deltaY2 = boundingBox2[1] - newBoundingBox[1];\n\n    for (let i = 0; i < newBoundingBoxWidth * newBoundingBoxHeight; i++) {\n      const x = i % newBoundingBoxWidth;\n      const y = Math.floor(i / newBoundingBoxWidth);\n      const b1x = x - deltaX1;\n      const b1y = y - deltaY1;\n      const b2x = x - deltaX2;\n      const b2y = y - deltaY2;\n\n      const b1i = b1x + b1y * (boundingBox1[2] - boundingBox1[0]);\n      const b2i = b2x + b2y * (boundingBox2[2] - boundingBox2[0]);\n      if (\n        this.inBoundingBox(b1x, b1y, boundingBox1) &&\n        maskData1[b1i] === 255 &&\n        this.inBoundingBox(b2x, b2y, boundingBox2) &&\n        maskData2[b2i] === 255\n      ) {\n        newMaskData.push(0);\n      } else {\n        newMaskData.push(maskData1[b1i]);\n      }\n    }\n\n    return [encode(Uint8Array.from(newMaskData)), newBoundingBox];\n  }\n\n  get boundingBox(): [number, number, number, number] | undefined {\n    return this._boundingBox;\n  }\n\n  set boundingBox(\n    updatedBoundingBox: [number, number, number, number] | undefined\n  ) {\n    this._boundingBox = updatedBoundingBox;\n  }\n\n  computeBoundingBoxFromContours(\n    contour: Array<number>\n  ): [number, number, number, number] {\n    const pairs = _.chunk(contour, 2);\n\n    return [\n      Math.round(_.min(_.map(pairs, _.first))!),\n      Math.round(_.min(_.map(pairs, _.last))!),\n      Math.round(_.max(_.map(pairs, _.first))!),\n      Math.round(_.max(_.map(pairs, _.last))!),\n    ];\n  }\n\n  computeMask() {\n    const maskImage = new ImageJS.Image({\n      width: this.image.width,\n      height: this.image.height,\n      bitDepth: 8,\n    });\n\n    const coords = _.chunk(this.points, 2);\n\n    const connectedPoints = connectPoints(coords, maskImage); // get coordinates of connected points and draw boundaries of mask\n    simplify(connectedPoints, 1, true);\n    slpf(connectedPoints, maskImage);\n\n    //@ts-ignore\n    return maskImage.getChannel(0);\n  }\n\n  get mask(): Array<number> | undefined {\n    return this._mask;\n  }\n\n  set mask(updatedMask: Array<number> | undefined) {\n    this._mask = updatedMask;\n  }\n\n  abstract deselect(): void;\n\n  abstract onMouseDown(position: { x: number; y: number }): void;\n\n  abstract onMouseMove(position: { x: number; y: number }): void;\n\n  abstract onMouseUp(position: { x: number; y: number }): void;\n\n  annotate(category: CategoryType): void {\n    if (!this.boundingBox || !this.mask) return;\n\n    this.annotation = {\n      boundingBox: this.boundingBox,\n      categoryId: category.id,\n      id: uuid.v4(),\n      mask: this.mask,\n    };\n  }\n}\n","import * as ImageJS from \"image-js\";\nimport PriorityQueue from \"ts-priority-queue\";\n\nconst dirs = [\n  [1, 0],\n  [0, 1],\n  [-1, 0],\n  [0, -1],\n];\n\nclass Position {\n  x: number;\n  y: number;\n\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  add(that: Position) {\n    this.x += that.x;\n    this.y += that.y;\n\n    return this;\n  }\n\n  clone() {\n    return new Position(this.x, this.y);\n  }\n\n  in(maximum: Position) {\n    return this.x >= 0 && this.x <= maximum.x && this.y >= 0 && maximum.y;\n  }\n\n  overwrite(that: Position) {\n    this.x = that.x;\n    this.y = that.y;\n\n    return this;\n  }\n\n  subtract(that: Position) {\n    this.x -= that.x;\n    this.y -= that.y;\n\n    return this;\n  }\n}\n\nexport interface FloodImage extends ImageJS.Image {\n  overlay: ImageJS.Image;\n  toleranceMap: ImageJS.Image;\n  target: Position;\n  overlayTolerance: number;\n}\n\n// Generate a tolerance map and associate it with the image itself\nexport const makeFloodMap = ({\n  x,\n  y,\n  image,\n}: {\n  x: number;\n  y: number;\n  image: ImageJS.Image;\n}) => {\n  const tol: Array<number> = [];\n\n  const color = image.getPixelXY(x, y);\n\n  if (image.data.length === image.width * image.height * 3) {\n    //RGB image\n    for (let i = 0; i < image.data.length; i += 3) {\n      const red = Math.abs(image.data[i] - color[0]);\n      const green = Math.abs(image.data[i + 1] - color[1]);\n      const blue = Math.abs(image.data[i + 2] - color[2]);\n      tol.push(Math.floor((red + green + blue) / 3));\n    }\n  } else if (image.data.length === image.width * image.height * 4) {\n    //RGBA image\n    for (let i = 0; i < image.data.length; i += 4) {\n      const red = Math.abs(image.data[i] - color[0]);\n      const green = Math.abs(image.data[i + 1] - color[1]);\n      const blue = Math.abs(image.data[i + 2] - color[2]);\n      tol.push(Math.floor((red + green + blue) / 3));\n    }\n  } else if (image.data.length === image.width * image.height) {\n    //greyscale\n    for (let i = 0; i < image.data.length; i++) {\n      const grey = Math.abs(image.data[i] - color[0]);\n      tol.push(Math.floor((grey / image.maxValue) * 255));\n    }\n  }\n\n  return new ImageJS.Image(image.width, image.height, tol, {\n    alpha: 0,\n    components: 1,\n  });\n};\n\n// Expand a watershed map until the desired tolerance is reached.\nexport const doFlood = ({\n  floodMap,\n  toleranceMap,\n  queue,\n  tolerance,\n  maxTol,\n  seen,\n}: {\n  floodMap: ImageJS.Image;\n  toleranceMap: ImageJS.Image;\n  queue: PriorityQueue<Array<number>>;\n  tolerance: number;\n  maxTol: number;\n  seen: Set<number>;\n}) => {\n  while (queue.length > 0 && queue.peek()[2] <= tolerance) {\n    let currentPoint = queue.dequeue();\n    maxTol = Math.max(currentPoint[2], maxTol);\n    floodMap.setPixelXY(currentPoint[0], currentPoint[1], [maxTol]);\n    for (let dir of dirs) {\n      let newX = currentPoint[0] + dir[0];\n      let newY = currentPoint[1] + dir[1];\n      let idx = newX + newY * toleranceMap.width;\n      if (\n        !seen.has(idx) &&\n        newX >= 0 &&\n        newY >= 0 &&\n        newX < toleranceMap.width &&\n        newY < toleranceMap.height\n      ) {\n        queue.queue([newX, newY, toleranceMap.getPixelXY(newX, newY)[0]]);\n        seen.add(idx);\n      }\n    }\n  }\n};\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { doFlood, makeFloodMap } from \"../../../flood\";\nimport * as ImageJS from \"image-js\";\nimport { encode } from \"../../../rle\";\nimport PriorityQueue from \"ts-priority-queue\";\n\nexport class ColorAnnotationTool extends AnnotationTool {\n  roiContour?: ImageJS.Image;\n  roiMask?: ImageJS.Image;\n  roiManager?: ImageJS.RoiManager;\n  offset: { x: number; y: number } = { x: 0, y: 0 };\n  overlayData: string = \"\";\n  points: Array<number> = [];\n  initialPosition: { x: number; y: number } = { x: 0, y: 0 };\n  tolerance: number = 1;\n  toleranceMap?: ImageJS.Image;\n  floodMap?: ImageJS.Image;\n  toleranceQueue: PriorityQueue<Array<number>> = new PriorityQueue({\n    comparator: function (a: Array<number>, b: Array<number>) {\n      return a[2] - b[2];\n    },\n  });\n  toolTipPosition?: { x: number; y: number };\n  maxTol: number = 0;\n  seen: Set<number> = new Set();\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.overlayData = \"\";\n\n    this.roiManager = undefined;\n    this.roiMask = undefined;\n\n    this.points = [];\n\n    this.initialPosition = { x: 0, y: 0 };\n    this.toolTipPosition = undefined;\n\n    this.tolerance = 1;\n    this.toleranceMap = undefined;\n    this.toleranceQueue.clear();\n    this.seen.clear();\n    this.maxTol = 0;\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    this.annotated = false;\n    this.annotating = true;\n    this.tolerance = 1;\n    this.maxTol = 0;\n    this.initialPosition = position;\n    this.toolTipPosition = position;\n\n    this.toleranceMap = makeFloodMap({\n      x: Math.floor(position.x),\n      y: Math.floor(position.y),\n      image: this.image!,\n    });\n\n    const empty = new Array(this.image.height * this.image.width).fill(\n      Infinity\n    );\n\n    this.floodMap = new ImageJS.Image(\n      this.image.width,\n      this.image.height,\n      empty,\n      {\n        alpha: 0,\n        components: 1,\n      }\n    );\n\n    this.toleranceQueue.clear();\n    this.seen.clear();\n    this.roiManager = this.floodMap.getRoiManager();\n\n    this.toleranceQueue.queue([\n      Math.floor(position.x),\n      Math.floor(position.y),\n      0,\n    ]);\n    const idx =\n      Math.floor(position.x) + Math.floor(position.y) * this.image.width;\n    this.seen.add(idx);\n\n    this.updateOverlay(position);\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotating) {\n      const diff = Math.ceil(\n        Math.hypot(\n          position.x - this.initialPosition!.x,\n          position.y - this.initialPosition!.y\n        )\n      );\n      if (diff !== this.tolerance) {\n        this.tolerance = diff;\n        this.updateOverlay(this.initialPosition);\n      }\n      this.toolTipPosition = position;\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (!this.roiManager || !this.roiMask) return;\n\n    // @ts-ignore\n    this.roiManager.fromMask(this.roiMask);\n    // @ts-ignore\n    this.roiMask = this.roiManager.getMasks()[0];\n\n    //@ts-ignore\n    const rois = this.roiManager.getRois();\n    const roi = rois.sort((a: any, b: any) => {\n      return b.surface - a.surface;\n    })[1]; // take the second roi because the first one will be of the size of the image,the second one is the actual largest roi\n    this._boundingBox = [roi.minX, roi.minY, roi.maxX + 1, roi.maxY + 1];\n\n    if (!this.roiMask || !this.boundingBox) return;\n\n    const boundingBoxWidth = this.boundingBox[2] - this.boundingBox[0];\n    const boundingBoxHeight = this.boundingBox[3] - this.boundingBox[1];\n\n    //mask should be the whole image, not just the ROI\n    const imgMask = new ImageJS.Image(boundingBoxWidth, boundingBoxHeight, {\n      components: 1,\n      alpha: 0,\n    });\n\n    for (let x = 0; x < boundingBoxWidth; x++) {\n      for (let y = 0; y < boundingBoxHeight; y++) {\n        //@ts-ignore\n        if (this.roiMask.getBitXY(x, y)) {\n          imgMask.setPixelXY(x, y, [255]);\n        }\n      }\n    }\n\n    // @ts-ignore\n    this._mask = encode(imgMask.data as Uint8Array);\n\n    this.annotated = true;\n    this.annotating = false;\n  }\n\n  private static colorOverlay(\n    mask: ImageJS.Image,\n    offset: { x: number; y: number },\n    position: { x: number; y: number },\n    width: number,\n    height: number,\n    color: string\n  ) {\n    const r = parseInt(color.slice(1, 3), 16);\n    const g = parseInt(color.slice(3, 5), 16);\n    const b = parseInt(color.slice(5, 7), 16);\n    const fillColor = [r, g, b, 150];\n\n    let overlay = new ImageJS.Image(\n      width,\n      height,\n      new Uint8Array(width * height * 4),\n      { alpha: 1 }\n    );\n\n    // roiPaint doesn't respect alpha, so we'll paint it ourselves.\n    for (let x = 0; x < mask.width; x++) {\n      for (let y = 0; y < mask.height; y++) {\n        if (mask.getBitXY(x, y)) {\n          overlay.setPixelXY(x + offset.x, y + offset.y, fillColor);\n        }\n      }\n    }\n\n    // Set the origin point to white, for visibility.\n    overlay.setPixelXY(position.x, position.y, [255, 255, 255, 255]);\n\n    return overlay.toDataURL(\"image/png\", { useCanvas: true });\n  }\n\n  private updateOverlay(position: { x: number; y: number }) {\n    if (this.maxTol <= this.tolerance) {\n      doFlood({\n        floodMap: this.floodMap!,\n        toleranceMap: this.toleranceMap!,\n        queue: this.toleranceQueue,\n        tolerance: this.tolerance,\n        maxTol: this.maxTol,\n        seen: this.seen,\n      });\n    }\n    // Make a threshold mask\n    this.roiMask = this.floodMap!.mask({\n      threshold: this.tolerance,\n      invert: true,\n    });\n\n    if (!this.roiMask) return;\n\n    this.overlayData = ColorAnnotationTool.colorOverlay(\n      this.roiMask,\n      this.offset,\n      position,\n      this.image.width,\n      this.image.height,\n      \"red\"\n    );\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport * as _ from \"lodash\";\nimport * as ImageJS from \"image-js\";\nimport { decode, encode } from \"../../../rle\";\n\nexport class EllipticalAnnotationTool extends AnnotationTool {\n  center?: { x: number; y: number };\n  origin?: { x: number; y: number };\n  radius?: { x: number; y: number };\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.center = undefined;\n    this.origin = undefined;\n    this.radius = undefined;\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    if (!this.radius) {\n      this.origin = position;\n\n      this.annotating = true;\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    this.resize(position);\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    if (this.radius) {\n      this.annotated = true;\n\n      this.annotating = false;\n\n      this.points = this.convertToPoints();\n\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const mask = this.convertToMask();\n\n      if (!mask) return;\n\n      this._mask = encode(mask);\n    }\n  }\n\n  private convertToMask() {\n    if (!this.boundingBox) return;\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.image.width;\n    canvas.height = this.image.height;\n\n    const ctx = canvas.getContext(\"2d\");\n\n    if (!ctx || !this.center || !this.radius) return undefined;\n\n    ctx.beginPath();\n    ctx.ellipse(\n      this.center.x,\n      this.center.y,\n      this.radius.x,\n      this.radius.y,\n      2 * Math.PI,\n      0,\n      2 * Math.PI\n    );\n    ctx.fill();\n\n    const roiWidth = this.boundingBox[2] - this.boundingBox[0];\n    const roiHeight = this.boundingBox[3] - this.boundingBox[1];\n\n    //@ts-ignore\n    const imageMask = ImageJS.Image.fromCanvas(canvas).getChannel(3);\n    const croppedImageMask = new ImageJS.Image(roiWidth, roiHeight, {\n      components: 1,\n      alpha: 0,\n    });\n\n    for (let x = 0; x < roiWidth; x++) {\n      for (let y = 0; y < roiHeight; y++) {\n        if (\n          imageMask.getPixelXY(\n            x + this.boundingBox[0],\n            y + this.boundingBox[1]\n          )[0] > 1\n        ) {\n          croppedImageMask.setPixelXY(x, y, [255]);\n        } else {\n          croppedImageMask.setPixelXY(x, y, [0]);\n        }\n      }\n    }\n\n    return Uint8Array.from(croppedImageMask.data);\n  }\n\n  private convertToPoints() {\n    if (!this.radius || !this.origin || !this.center) return [];\n\n    const centerX = Math.round(this.center.x);\n    const centerY = Math.round(this.center.y);\n\n    const points: Array<number> = [];\n    const foo: Array<Array<number>> = [];\n    //first quadrant points\n    for (let y = centerY; y < centerY + this.radius.y; y += 0.5) {\n      const x =\n        this.radius.x *\n          Math.sqrt(\n            1 -\n              ((y - centerY) * (y - centerY)) / (this.radius.y * this.radius.y)\n          ) +\n        centerX;\n      points.push(Math.round(x));\n      points.push(Math.round(y));\n      foo.push([Math.round(x), Math.round(y)]);\n    }\n    // const reversedFoo = _.reverse(foo);\n    //second quadrant points\n    _.forEachRight(foo, (position: Array<number>) => {\n      let x = 2 * centerX - position[0];\n      points.push(x);\n      points.push(position[1]);\n    });\n    //third quadrant points\n    _.forEach(foo, (position: Array<number>) => {\n      let x = 2 * centerX - position[0];\n      let y = 2 * centerY - position[1];\n      points.push(x);\n      points.push(y);\n    });\n    //fourth quadant points\n    _.forEachRight(foo, (position: Array<number>) => {\n      let y = 2 * centerY - position[1];\n      points.push(position[0]);\n      points.push(y);\n    });\n\n    return points;\n  }\n\n  private resize(position: { x: number; y: number }) {\n    if (this.origin) {\n      this.center = {\n        x: (position.x - this.origin.x) / 2 + this.origin.x,\n        y: (position.y - this.origin.y) / 2 + this.origin.y,\n      };\n\n      this.radius = {\n        x: Math.abs((position.x - this.origin.x) / 2),\n        y: Math.abs((position.y - this.origin.y) / 2),\n      };\n    }\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport * as _ from \"lodash\";\nimport { encode } from \"../../../rle\";\n\nexport class LassoAnnotationTool extends AnnotationTool {\n  anchor?: { x: number; y: number };\n  buffer: Array<number> = [];\n  origin?: { x: number; y: number };\n  points: Array<number> = [];\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.annotation = undefined;\n\n    this.anchor = undefined;\n    this.buffer = [];\n    this.origin = undefined;\n    this.points = [];\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    if (this.buffer && this.buffer.length === 0) {\n      this.annotating = true;\n\n      if (!this.origin) {\n        this.origin = position;\n        this.buffer = [...this.buffer, position.x, position.y];\n      }\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    if (this.anchor) {\n      if (\n        this.buffer[this.buffer.length - 2] !== this.anchor.x ||\n        this.buffer[this.buffer.length - 1] !== this.anchor.y\n      ) {\n        this.buffer.pop();\n        this.buffer.pop();\n      }\n\n      this.buffer = [...this.buffer, position.x, position.y];\n\n      return;\n    }\n\n    if (this.origin) {\n      this.buffer = [...this.buffer, position.x, position.y];\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating || !this.origin) return;\n\n    if (this.buffer.length < 3) return;\n\n    if (this.origin && this.buffer && this.buffer.length > 0) {\n      this.buffer = [\n        ...this.buffer,\n        position.x,\n        position.y,\n        this.origin.x,\n        this.origin.y,\n      ];\n\n      this.annotated = true;\n      this.annotating = false;\n\n      this.points = this.buffer;\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const maskImage = this.computeMask().crop({\n        x: this._boundingBox[0],\n        y: this._boundingBox[1],\n        width: this._boundingBox[2] - this._boundingBox[0],\n        height: this._boundingBox[3] - this._boundingBox[1],\n      });\n\n      this._mask = encode(maskImage.data);\n\n      this.buffer = [];\n    }\n\n    if (this.anchor) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n\n    if (this.origin && this.buffer && this.buffer.length > 0) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n  }\n\n  private connected(\n    position: { x: number; y: number },\n    threshold: number = 4\n  ): boolean | undefined {\n    if (!this.origin) return undefined;\n\n    const distance = Math.hypot(\n      position.x - this.origin.x,\n      position.y - this.origin.y\n    );\n\n    return distance < threshold;\n  }\n}\n","/**\n * Based on https://github.com/mourner/tinyqueue\n * Copyright (c) 2017, Vladimir Agafonkin https://github.com/mourner/tinyqueue/blob/master/LICENSE\n *\n * Adapted for PathFinding needs by @anvaka\n * Copyright (c) 2017, Andrei Kashcha\n *\n * Further adapted for Piximi\n */\nimport { PiximiNode } from \"../GraphHelper\";\n\nexport class NodeHeap {\n  public data: Array<any> = [];\n\n  public length: number = 0;\n\n  compare(a: PiximiNode, b: PiximiNode) {\n    return a.fScore - b.fScore;\n  }\n\n  setNodeId(node: PiximiNode, heapIndex: number) {\n    node.heapIndex = heapIndex;\n  }\n\n  push(item: any) {\n    this.data.push(item);\n    this.setNodeId(item, this.length);\n    this.length++;\n    this._up(this.length - 1);\n  }\n\n  pop() {\n    if (this.length === 0) return undefined;\n\n    const top = this.data[0];\n    this.length--;\n\n    if (this.length > 0) {\n      this.data[0] = this.data[this.length];\n      this.setNodeId(this.data[0], 0);\n      this._down(0);\n    }\n    this.data.pop();\n\n    return top;\n  }\n\n  updateItem(pos: number) {\n    this._down(pos);\n    this._up(pos);\n  }\n\n  _up(pos: number) {\n    const data = this.data;\n    const compare = this.compare;\n    const setNodeId = this.setNodeId;\n    const item = data[pos];\n\n    while (pos > 0) {\n      const parent = (pos - 1) >> 1;\n      const current = data[parent];\n      if (compare(item, current) >= 0) break;\n      data[pos] = current;\n\n      setNodeId(current, pos);\n      pos = parent;\n    }\n\n    data[pos] = item;\n    setNodeId(item, pos);\n  }\n\n  _down(pos: number) {\n    const data = this.data;\n    const compare = this.compare;\n    const halfLength = this.length >> 1;\n    const item = data[pos];\n    const setNodeId = this.setNodeId;\n\n    while (pos < halfLength) {\n      let left = (pos << 1) + 1;\n      const right = left + 1;\n      let best = data[left];\n\n      if (right < this.length && compare(data[right], best) < 0) {\n        left = right;\n        best = data[right];\n      }\n      if (compare(best, item) >= 0) break;\n\n      data[pos] = best;\n      setNodeId(best, pos);\n      pos = left;\n    }\n\n    data[pos] = item;\n    setNodeId(item, pos);\n  }\n}\n","import { NodeHeap } from \"./NodeHeap\";\nimport { fromIdxToCoord, PiximiGraph, PiximiNode } from \"../GraphHelper\";\nimport { Node } from \"ngraph.graph\";\n\n/**\n * Performs a uni-directional A Star search on graph.\n *\n * We will try to minimize f(n) = g(n) + h(n), where\n * g(n) is actual distance from source node to `n`, and\n * h(n) is heuristic distance from `n` to target node.\n */\n\nconst NO_PATH: never[] = [];\n\n/**\n * Creates a new instance of pathfinder. A pathfinder has just one method:\n * `find(fromId, toId)`, it may be extended in future.\n *\n * @param graph instance. See https://github.com/anvaka/ngraph.graph\n * @param {width} width of the original image\n * @param {factor} factor for scaling between image and graph\n *\n * @returns {Object} A pathfinder with single method `find()`.\n */\nexport function cachedAStarPathSearch(\n  graph: PiximiGraph,\n  width: number,\n  factor: number\n) {\n  // whether traversal should be considered over oriented graph.\n  const oriented = true;\n\n  const heuristic = (fromNode: PiximiNode, toNode: PiximiNode) => {\n    const [x1, y1] = fromIdxToCoord(fromNode.id as number, width);\n    const [x2, y2] = fromIdxToCoord(toNode.id as number, width);\n    if (x1 === x2 || y1 === y2) {\n      return 1;\n    }\n    return 1.41;\n  };\n\n  const distance = (fromNode: Node, toNode: Node) => {\n    const [x1, y1] = fromIdxToCoord(fromNode.id as number, width);\n    const [x2, y2] = fromIdxToCoord(toNode.id as number, width);\n    if (x1 === x2 || y1 === y2) {\n      return 1 * toNode.data;\n    }\n    return 1.41 * toNode.data;\n  };\n\n  return {\n    /**\n     * Finds a path between node `fromId` and `toId`.\n     * @returns {Array} of nodes between `toId` and `fromId`. Empty array is returned\n     * if no path is found.\n     */\n    find: find,\n  };\n\n  function find(fromId: number, toId: number) {\n    const from = graph.getNode(fromId) as PiximiNode;\n    if (!from) return NO_PATH;\n    const to = graph.getNode(toId) as PiximiNode;\n    if (!to) return NO_PATH;\n\n    let cameFrom: any;\n    // Maps nodeId to NodeSearchState.\n\n    const dest = graph.getNode(toId) as PiximiNode;\n    if (dest) {\n      if (dest.fromId === fromId && dest.trace.length > 0) {\n        return dest.trace;\n      }\n    }\n\n    if (graph.fromId !== fromId || graph.openSet.length === 0) {\n      graph.openSet = new NodeHeap();\n      // For the first node, fScore is completely heuristic.\n      from.fScore = heuristic(from, to);\n\n      // The cost of going from start to start is zero.\n      from.distanceToSource = 0;\n      graph.openSet.push(from);\n      from.open = 1;\n      graph.fromId = fromId;\n    }\n\n    while (graph.openSet.length > 0) {\n      cameFrom = graph.openSet.pop();\n\n      if (cameFrom.id === toId) {\n        cameFrom.trace = reconstructPath(graph, cameFrom, width, factor);\n        cameFrom.fromId = fromId;\n        return cameFrom.trace;\n      }\n\n      // no need to visit this node anymore\n      cameFrom.trace = reconstructPath(graph, cameFrom, width, factor);\n      cameFrom.fromId = fromId;\n      cameFrom.closed = true;\n      graph.forEachLinkedNode(cameFrom.id, visitNeighbour, oriented);\n    }\n\n    // If we got here, then there is no path.\n    return NO_PATH;\n\n    function visitNeighbour(otherNode: any) {\n      if (otherNode.fromId !== graph.fromId) {\n        // This is old data, reset all params\n        otherNode.fromId = graph.fromId;\n        otherNode.trace = [];\n        otherNode.parentId = null;\n        otherNode.closed = false;\n        otherNode.open = 0;\n        otherNode.distanceToSource = Number.POSITIVE_INFINITY;\n        otherNode.fScore = Number.POSITIVE_INFINITY;\n        otherNode.heapIndex = -1;\n      }\n\n      if (otherNode.closed) {\n        // Already processed this node.\n        return;\n      }\n      if (otherNode.open === 0) {\n        // Remember this node.\n        graph.openSet.push(otherNode);\n        otherNode.open = 1;\n      }\n\n      const tentativeDistance =\n        cameFrom.distanceToSource + distance(otherNode, cameFrom);\n      if (tentativeDistance >= otherNode.distanceToSource) {\n        // This would only make our path longer. Ignore this route.\n        return;\n      }\n\n      // bingo! we found shorter path:\n      otherNode.parentId = cameFrom.id;\n      otherNode.distanceToSource = tentativeDistance;\n      otherNode.fScore = tentativeDistance + heuristic(otherNode, to);\n\n      graph.openSet.updateItem(otherNode.heapIndex);\n    }\n  }\n}\n\nfunction reconstructPath(\n  graph: PiximiGraph,\n  searchNode: PiximiNode | null,\n  width: number,\n  factor: number = 1\n) {\n  if (!searchNode) return;\n\n  const [x, y] = fromIdxToCoord(searchNode.id as number, width);\n  const newCoord = [x / factor, y / factor];\n  let coords = [];\n  const fromId = graph.fromId;\n  if (searchNode!.parentId !== null) {\n    const parentNode = graph.getNode(searchNode!.parentId) as PiximiNode;\n    if (typeof parentNode !== \"undefined\" && parentNode.fromId === fromId) {\n      // Fetch a trace from the last coordinate\n      coords.push(...parentNode.trace);\n      if (coords.length > 1) {\n        const oldDirection = pathDirection(\n          coords[coords.length - 2],\n          coords[coords.length - 1]\n        );\n        const newDirection = pathDirection(coords[coords.length - 1], newCoord);\n        if (oldDirection === newDirection) {\n          coords.pop();\n        }\n      }\n    }\n  }\n  coords.push(newCoord);\n  return coords;\n}\n\nexport const pathDirection = (from: Array<number>, to: Array<number>) => {\n  // Generate a number representing the relative direction of the coordinates.\n  // Assuming TopLeft of an image is 0,0\n  const dx = to[0] - from[0];\n  const dy = to[1] - from[1];\n  if (dx === 0) {\n    if (dy < 0) {\n      return 0; // Up\n    }\n    if (dy > 0) {\n      return 4; // Down\n    }\n  }\n  if (dy === 0) {\n    if (dx > 0) {\n      return 2; // Right\n    }\n    if (dx < 0) {\n      return 6; // Left\n    }\n  }\n  if (dx > 0) {\n    if (dy < 0) {\n      return 1; // Up+Right\n    }\n    if (dy > 0) {\n      return 3; // Down+Right\n    }\n  }\n  if (dx < 0) {\n    if (dy < 0) {\n      return 7; // Up+Left\n    }\n    if (dy > 0) {\n      return 5; // Down+Left\n    }\n  }\n  console.log(\n    \"Invalid direction, this should never appear so check the code\",\n    dx,\n    dy\n  );\n};\n","import createGraph, { Graph, Node } from \"ngraph.graph\";\nimport { getIdx } from \"./imageHelper\";\nimport { DataArray } from \"image-js\";\n\nimport { cachedAStarPathSearch } from \"./pathfinder/PathFinder\";\nimport { NodeHeap } from \"./pathfinder/NodeHeap\";\n\nexport interface PiximiGraph extends Graph {\n  fromId: number;\n  openSet: NodeHeap;\n}\n\nexport interface PiximiNode extends Node {\n  fromId: number;\n  trace: Array<Array<number>>;\n\n  parentId: number | null;\n  closed: boolean;\n  open: number;\n  distanceToSource: number;\n  fScore: number;\n  heapIndex: number;\n}\n\nexport const validNeighbours = (\n  x: number,\n  y: number,\n  height: number,\n  width: number\n) => {\n  const xoffsets = [0];\n  const yoffsets = [0];\n  const output: { x: number; y: number }[] = [];\n  //David will know what to write here\n  if (x > 0) {\n    xoffsets.push(-1);\n  }\n  if (x < width - 1) {\n    xoffsets.push(1);\n  }\n  if (y > 0) {\n    yoffsets.push(-1);\n  }\n  if (y < height - 1) {\n    yoffsets.push(1);\n  }\n  for (let xoffset of xoffsets) {\n    for (let yoffset of yoffsets) {\n      if (!(xoffset === 0 && yoffset === 0)) {\n        output.push({ x: x + xoffset, y: y + yoffset });\n      }\n    }\n  }\n  return output;\n};\n\nexport const fromIdxToCoord = (idx: number, width: number) => {\n  const row = Math.floor(idx / width);\n  const col = idx - row * width;\n  return [col, row];\n};\n\nexport const makeGraph = (\n  edges: Uint8ClampedArray | DataArray,\n  height: number,\n  width: number\n) => {\n  let graph: any = createGraph();\n  graph.fromId = -1;\n  graph.openSet = new NodeHeap();\n  let cap = 255;\n  if (edges.BYTES_PER_ELEMENT === 2) {\n    cap = 65535;\n  }\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      const startIdx = getIdx(width, 1)(x, y, 0);\n      const dist = cap - edges[startIdx];\n\n      graph.addNode(startIdx, dist);\n\n      const pixels = validNeighbours(x, y, height, width);\n\n      for (let pixel of pixels) {\n        const idx = getIdx(width, 1)(pixel.x, pixel.y, 0);\n        graph.addLink(startIdx, idx);\n      }\n    }\n  }\n  return graph as PiximiGraph;\n};\n\nexport const createPathFinder = (\n  graph: PiximiGraph,\n  width: number,\n  factor: number\n) => {\n  return cachedAStarPathSearch(graph, width, factor);\n};\n\nexport const convertPathToCoords = (\n  foundPath: any,\n  width: number,\n  factor: number = 1\n) => {\n  const pathCoords = [];\n  for (let node of foundPath) {\n    const id = node.id as number;\n    const [x, y] = fromIdxToCoord(id, width);\n    pathCoords.push([x / factor, y / factor]);\n  }\n  return pathCoords;\n};\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { createPathFinder, makeGraph, PiximiGraph } from \"../../../GraphHelper\";\nimport { getIdx } from \"../../../imageHelper\";\nimport * as ImageJS from \"image-js\";\nimport * as _ from \"lodash\";\nimport { encode } from \"../../../rle\";\n\nexport class MagneticAnnotationTool extends AnnotationTool {\n  anchor?: { x: number; y: number };\n  buffer: Array<number> = [];\n  factor: number;\n  graph?: PiximiGraph;\n  origin?: { x: number; y: number };\n  path: Array<number> = [];\n  pathfinder?: { find: (fromId: number, toId: number) => any };\n  points: Array<number> = [];\n  previous: Array<number> = [];\n  response?: ImageJS.Image;\n\n  constructor(image: ImageJS.Image, factor: number = 0.5) {\n    super(image);\n\n    this.factor = factor;\n\n    this.filter();\n\n    if (!this.image || !this.response) return;\n\n    this.graph = makeGraph(\n      this.response.data,\n      this.response.height,\n      this.response.width\n    );\n\n    this.pathfinder = createPathFinder(\n      this.graph,\n      this.image.width * factor,\n      factor\n    );\n  }\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.annotation = undefined;\n\n    this.anchor = undefined;\n    this.buffer = [];\n    this.graph = undefined;\n    this.origin = undefined;\n    this.points = [];\n    this.previous = [];\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    if (this.buffer && this.buffer.length === 0) {\n      this.annotating = true;\n\n      if (!this.origin) {\n        this.origin = position;\n      }\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (!this.image || !this.pathfinder || this.annotated || !this.annotating)\n      return;\n\n    if (this.anchor) {\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.anchor.x * this.factor),\n        Math.floor(this.anchor.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(position.x * this.factor),\n        Math.floor(position.y * this.factor),\n        0\n      );\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      if (\n        this.buffer[this.buffer.length - 2] !== this.anchor.x ||\n        this.buffer[this.buffer.length - 1] !== this.anchor.y\n      ) {\n        this.buffer.pop();\n        this.buffer.pop();\n      }\n\n      this.buffer = [\n        ...this.previous,\n        this.anchor.x,\n        this.anchor.y,\n        ...this.path,\n      ];\n\n      return;\n    }\n\n    if (this.origin) {\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.origin.x * this.factor),\n        Math.floor(this.origin.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(position.x * this.factor),\n        Math.floor(position.y * this.factor),\n        0\n      );\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      this.buffer.pop();\n      this.buffer.pop();\n\n      this.buffer = [this.origin.x, this.origin.y, ...this.path];\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    if (\n      this.connected(position) &&\n      this.origin &&\n      this.buffer &&\n      this.buffer.length > 0\n    ) {\n      this.buffer = [\n        ...this.buffer,\n        position.x,\n        position.y,\n        this.origin.x,\n        this.origin.y,\n      ];\n\n      this.annotated = true;\n      this.annotating = false;\n\n      this.points = this.buffer;\n\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const maskImage = this.computeMask().crop({\n        x: this._boundingBox[0],\n        y: this._boundingBox[1],\n        width: this._boundingBox[2] - this._boundingBox[0],\n        height: this._boundingBox[3] - this._boundingBox[1],\n      });\n\n      this._mask = encode(maskImage.data);\n\n      this.buffer = [];\n\n      return;\n    }\n\n    if (this.anchor && this.image) {\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.anchor.x * this.factor),\n        Math.floor(this.anchor.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.buffer[this.buffer.length - 2] * this.factor),\n        Math.floor(this.buffer[this.buffer.length - 1] * this.factor),\n        0\n      );\n\n      if (!this.pathfinder) return;\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      this.buffer.pop();\n      this.buffer.pop();\n\n      this.buffer = [...this.previous, ...this.path];\n\n      this.previous = [...this.previous, ...this.path];\n\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n\n    if (this.origin && this.buffer.length > 0) {\n      if (!this.image || !this.origin || !this.pathfinder) return;\n\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      const source = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.origin.x * this.factor),\n        Math.floor(this.origin.y * this.factor),\n        0\n      );\n\n      const destination = getIdx(this.image.width * this.factor, 1)(\n        Math.floor(this.buffer[this.buffer.length - 2] * this.factor),\n        Math.floor(this.buffer[this.buffer.length - 1] * this.factor),\n        0\n      );\n\n      this.path = _.flatten(this.pathfinder.find(source, destination));\n\n      this.buffer = [this.origin.x, this.origin.y, ...this.path];\n\n      this.previous = [\n        ...this.previous,\n        this.origin.x,\n        this.origin.y,\n        ...this.path,\n      ];\n\n      return;\n    }\n  }\n\n  private connected(\n    position: { x: number; y: number },\n    threshold: number = 4\n  ): boolean | undefined {\n    if (!this.origin) return undefined;\n\n    const distance = Math.hypot(\n      position.x - this.origin.x,\n      position.y - this.origin.y\n    );\n\n    return distance < threshold;\n  }\n\n  private filter() {\n    if (!this.image) return;\n\n    const options = { factor: this.factor };\n\n    this.response = this.image.resize(options).grey().sobelFilter();\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport * as ImageJS from \"image-js\";\nimport { encode } from \"../../../rle\";\n\nexport class RectangularAnnotationTool extends AnnotationTool {\n  origin?: { x: number; y: number };\n\n  width?: number;\n  height?: number;\n\n  computeBoundingBox(): [number, number, number, number] | undefined {\n    if (!this.points || !this.points.length) return undefined;\n    return [this.points[0], this.points[1], this.points[4], this.points[5]];\n  }\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.origin = undefined;\n\n    this.width = undefined;\n    this.height = undefined;\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    if (!this.width) {\n      this.origin = position;\n\n      this.annotating = true;\n    } else {\n      this.resize(position);\n\n      this.points = this.convertToPoints();\n\n      this._boundingBox = this.computeBoundingBox();\n\n      const mask = this.convertToMask();\n      if (!mask) return;\n      this._mask = encode(new Uint8Array(mask));\n\n      this.annotated = true;\n      this.annotating = false;\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    this.resize(position);\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n    if (this.width) {\n      this.points = this.convertToPoints();\n\n      this._boundingBox = this.computeBoundingBox();\n\n      const mask = this.convertToMask();\n      if (!mask) return;\n      this._mask = encode(new Uint8Array(mask));\n\n      this.annotated = true;\n      this.annotating = false;\n    }\n  }\n\n  private convertToPoints() {\n    if (!this.width || !this.height || !this.origin) return [];\n\n    const points: Array<number> = [];\n\n    const origin = { x: this.origin.x, y: this.origin.y };\n    let width = this.width;\n    let height = this.height;\n\n    //negative height and width may happen if the rectangle was drawn from right to left\n    if (this.width < 0) {\n      width = Math.abs(this.width);\n      origin.x = this.origin.x - width;\n    }\n    if (this.height < 0) {\n      height = Math.abs(this.height);\n      origin.y = this.origin.y - height;\n    }\n\n    // add corners of the rectangle\n    const x1 = Math.round(origin.x);\n    const y1 = Math.round(origin.y);\n    const x2 = Math.round(origin.x + width);\n    const y2 = Math.round(origin.y + height);\n    points.push(...[x1, y1, x2, y1, x2, y2, x1, y2, x1, y1]);\n\n    return points;\n  }\n\n  private convertToMask() {\n    if (!this.points || !this.boundingBox) return;\n\n    const x1 = this.points[0];\n    const y1 = this.points[1];\n    const x2 = this.points[4];\n    const y2 = this.points[5];\n\n    return new Uint8Array((x2 - x1) * (y2 - y1)).fill(255);\n  }\n\n  private resize(position: { x: number; y: number }) {\n    if (this.origin) {\n      this.width = position.x - this.origin.x;\n      this.height = position.y - this.origin.y;\n    }\n  }\n}\n","import { RectangularAnnotationTool } from \"../RectangularAnnotationTool\";\nimport * as ImageJS from \"image-js\";\nimport * as tensorflow from \"@tensorflow/tfjs\";\nimport * as _ from \"lodash\";\nimport { encode } from \"../../../rle\";\n\nexport class ObjectAnnotationTool extends RectangularAnnotationTool {\n  graph?: tensorflow.LayersModel;\n  prediction?: ImageJS.Image;\n  points: Array<number> = [];\n  // @ts-ignore\n  roi?: ImageJS.Roi;\n  offset?: { x: number; y: number };\n  output?: ImageJS.Image;\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.prediction = undefined;\n    this.points = [];\n    this.roi = undefined;\n    this.offset = undefined;\n    this.output = undefined;\n\n    this.origin = undefined;\n    this.width = undefined;\n  }\n\n  async onMouseUp(position: { x: number; y: number }) {\n    if (!this.annotating || this.annotated) return;\n\n    await this.predict();\n  }\n\n  static async compile(image: ImageJS.Image) {\n    const instance = new ObjectAnnotationTool(image);\n\n    const pathname =\n      \"https://raw.githubusercontent.com/zaidalyafeai/HostedModels/master/unet-128/model.json\";\n\n    instance.graph = await tensorflow.loadLayersModel(pathname);\n\n    const optimizer = tensorflow.train.adam();\n\n    instance.graph.compile({\n      optimizer: optimizer,\n      loss: \"categoricalCrossentropy\",\n      metrics: [\"accuracy\"],\n    });\n\n    return instance;\n  }\n\n  private async predict() {\n    if (!this.image || !this.origin || !this.width || !this.height) return;\n\n    this.annotating = false;\n\n    const width = Math.round(this.width);\n    const height = Math.round(this.height);\n\n    const crop = this.image.crop({\n      x: this.origin.x,\n      y: this.origin.y,\n      width: width,\n      height: height,\n    });\n\n    const prediction = tensorflow.tidy(() => {\n      if (crop) {\n        const cropped: tensorflow.Tensor3D = tensorflow.browser.fromPixels(\n          crop.getCanvas()\n        );\n\n        const size: [number, number] = [128, 128];\n        const resized = tensorflow.image.resizeBilinear(cropped, size);\n        const standardized = resized.div(tensorflow.scalar(255));\n        const batch = standardized.expandDims(0);\n\n        if (!this.height || !this.width || !this.origin) return;\n\n        if (this.graph) {\n          const prediction = this.graph.predict(\n            batch\n          ) as tensorflow.Tensor<tensorflow.Rank>;\n\n          return prediction\n            .squeeze([0])\n            .tile([1, 1, 3])\n            .sub(0.3)\n            .sign()\n            .relu()\n            .resizeBilinear([height, width])\n            .pad([\n              [this.origin.y, this.image.height - (this.origin.y + height)],\n              [this.origin.x, this.image.width - (this.origin.x + width)],\n              [0, 0],\n            ]);\n        }\n      }\n    });\n\n    if (prediction) {\n      const clamped: Uint8ClampedArray = await tensorflow.browser.toPixels(\n        prediction as tensorflow.Tensor3D\n      );\n      // .then(async (clamped) => {\n      this.output = new ImageJS.Image({\n        width: this.image.width,\n        height: this.image.height,\n        data: clamped,\n      });\n\n      const greyMask = this.output.grey();\n\n      //compute bounding box with ROI manager\n      const roiManager = this.image.getRoiManager();\n      //@ts-ignore\n      const binaryMask = greyMask.mask({\n        algorithm: \"threshold\",\n        threshold: 1,\n      });\n      // @ts-ignore\n      roiManager.fromMask(binaryMask);\n      // @ts-ignore\n      const rois = roiManager.getRois();\n      const roi = rois.sort((a: any, b: any) => {\n        return b.surface - a.surface;\n      })[1]; // take the second roi because the first one will be of the size of the image,the second one is the actual largest roi\n      this._boundingBox = [roi.minX, roi.minY, roi.maxX, roi.maxY];\n\n      //threshold\n      const thresholded = _.map(greyMask.data, (i: number) =>\n        i > 1 ? 255 : 0\n      ); //threshold necessary because output of NN is not binary\n\n      // @ts-ignore\n      this._mask = encode(thresholded);\n\n      this.annotated = true;\n      this.width = undefined;\n    }\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport * as ImageJS from \"image-js\";\nimport * as _ from \"lodash\";\nimport { connectPoints } from \"../../../imageHelper\";\nimport { encode } from \"../../../rle\";\n\nexport class PenAnnotationTool extends AnnotationTool {\n  brushSize: number = 8;\n  circlesData: Uint8ClampedArray | Uint8Array | undefined = undefined;\n  buffer: Array<number> = [];\n  outline: Array<number> = [];\n  points: Array<number> = [];\n\n  computeCircleData(): Uint8Array | Uint8ClampedArray | undefined {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.image.width;\n    canvas.height = this.image.height;\n    const ctx = canvas.getContext(\"2d\");\n\n    if (!ctx) return undefined;\n\n    let connected;\n\n    if (this.points.length === 2) {\n      // handling the case in which a single point has been clicked\n      connected = _.chunk(this.points, 2);\n    } else {\n      connected = connectPoints(\n        _.chunk(this.points, 2),\n        new ImageJS.Image(this.image.width, this.image.height)\n      );\n    }\n\n    //compute bounding box coordinates\n    const bbox = this.computeBoundingBoxFromContours(_.flatten(connected));\n    this._boundingBox = [\n      Math.max(0, Math.round(bbox[0] - this.brushSize)),\n      Math.max(0, Math.round(bbox[1] - this.brushSize)),\n      Math.min(this.image.width, Math.round(bbox[2] + this.brushSize)),\n      Math.min(this.image.height, Math.round(bbox[3] + this.brushSize)),\n    ];\n\n    //compute mask by drawing circles over canvas\n    connected.forEach((position) => {\n      ctx.beginPath();\n      ctx.arc(\n        Math.round(position[0]),\n        Math.round(position[1]),\n        this.brushSize,\n        0,\n        Math.PI * 2,\n        true\n      );\n      ctx.fill();\n    });\n\n    const rgbMask = ImageJS.Image.fromCanvas(canvas);\n\n    const croppedRgbMask = rgbMask.crop({\n      x: this._boundingBox[0],\n      y: this._boundingBox[1],\n      width: this._boundingBox[2] - this._boundingBox[0],\n      height: this._boundingBox[3] - this._boundingBox[1],\n    });\n\n    // @ts-ignore\n    this.circlesData = this.thresholdMask(croppedRgbMask.getChannel(3)).data;\n  }\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.circlesData = undefined;\n    this.buffer = [];\n    this.outline = [];\n    this.points = [];\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    this.annotating = true;\n\n    this.buffer = [...this.buffer, position.x, position.y];\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    this.buffer = [...this.buffer, position.x, position.y];\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    this.annotated = true;\n\n    this.annotating = false;\n\n    this.points = this.buffer;\n\n    this.computeCircleData(); //this will set the bounding box as well\n\n    if (!this.circlesData) return [];\n\n    this._mask = encode(this.circlesData);\n  }\n\n  static async setup(image: ImageJS.Image, brushSize: number) {\n    const operator = new PenAnnotationTool(image);\n\n    operator.brushSize = brushSize;\n\n    return operator;\n  }\n\n  private thresholdMask = (mask: ImageJS.Image) => {\n    for (let x = 0; x < mask.width; x++) {\n      for (let y = 0; y < mask.height; y++) {\n        if (mask.getPixelXY(x, y)[0] > 1) {\n          mask.setPixelXY(x, y, [255]);\n        } else {\n          mask.setPixelXY(x, y, [0]);\n        }\n      }\n    }\n    return mask;\n  };\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { encode } from \"../../../rle\";\n\nexport class PolygonalAnnotationTool extends AnnotationTool {\n  anchor?: { x: number; y: number };\n  buffer: Array<number> = [];\n  origin?: { x: number; y: number };\n  points: Array<number> = [];\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.annotation = undefined;\n\n    this.anchor = undefined;\n    this.buffer = [];\n    this.origin = undefined;\n    this.points = [];\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    if (this.buffer && this.buffer.length === 0) {\n      this.annotating = true;\n\n      if (!this.origin) {\n        this.origin = position;\n      }\n    }\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    if (this.anchor) {\n      if (\n        this.buffer[this.buffer.length - 2] !== this.anchor.x ||\n        this.buffer[this.buffer.length - 1] !== this.anchor.y\n      ) {\n        this.buffer.pop();\n        this.buffer.pop();\n      }\n\n      this.buffer = [...this.buffer, position.x, position.y];\n\n      return;\n    }\n\n    if (this.origin) {\n      this.buffer.pop();\n      this.buffer.pop();\n\n      this.buffer = [this.origin.x, this.origin.y, position.x, position.y];\n    }\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    if (\n      this.connected(position) &&\n      this.origin &&\n      this.buffer &&\n      this.buffer.length > 0\n    ) {\n      this.buffer = [\n        ...this.buffer,\n        position.x,\n        position.y,\n        this.origin.x,\n        this.origin.y,\n      ];\n\n      this.annotated = true;\n      this.annotating = false;\n\n      this.points = this.buffer;\n\n      this._boundingBox = this.computeBoundingBoxFromContours(this.points);\n\n      const maskImage = this.computeMask().crop({\n        x: this._boundingBox[0],\n        y: this._boundingBox[1],\n        width: this._boundingBox[2] - this._boundingBox[0],\n        height: this._boundingBox[3] - this._boundingBox[1],\n      });\n\n      this._mask = encode(maskImage.data);\n\n      this.buffer = [];\n\n      this.anchor = undefined;\n      this.origin = undefined;\n\n      return;\n    }\n\n    if (this.anchor) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n\n    if (this.origin && this.buffer.length > 0) {\n      this.anchor = {\n        x: this.buffer[this.buffer.length - 2],\n        y: this.buffer[this.buffer.length - 1],\n      };\n\n      return;\n    }\n  }\n\n  private connected(\n    position: { x: number; y: number },\n    threshold: number = 4\n  ): boolean | undefined {\n    if (!this.origin) return undefined;\n\n    const distance = Math.hypot(\n      position.x - this.origin.x,\n      position.y - this.origin.y\n    );\n\n    return distance < threshold;\n  }\n}\n","import { AnnotationTool } from \"../AnnotationTool\";\nimport { slic } from \"../../../slic\";\nimport * as ImageJS from \"image-js\";\nimport { encode } from \"../../../rle\";\nimport * as _ from \"lodash\";\n\nexport class QuickAnnotationTool extends AnnotationTool {\n  brushsize?: number;\n  colorMasks?: Array<string>;\n  currentSuperpixels: Set<number> = new Set<number>();\n  lastSuperpixel: number = 0;\n  superpixels?: Int32Array;\n  superpixelsMap?: { [key: number]: Array<number> };\n  currentMask?: ImageJS.Image;\n  map?: Uint8Array | Uint8ClampedArray;\n\n  flatPixelCoordinate(position: { x: number; y: number }) {\n    return Math.round(position.x) + Math.round(position.y) * this.image.width;\n  }\n\n  filter(): {\n    superpixels: Int32Array;\n  } {\n    const data = this.image.getRGBAData();\n\n    const { count, map, superpixels } = slic(\n      data,\n      this.image.width,\n      this.image.height,\n      this.brushsize\n    );\n\n    return { superpixels };\n  }\n\n  deselect() {\n    this.annotated = false;\n    this.annotating = false;\n\n    this.colorMasks = undefined;\n    this.currentSuperpixels.clear();\n    this.lastSuperpixel = 0;\n    this.currentMask = undefined;\n  }\n\n  onMouseDown(position: { x: number; y: number }) {\n    if (this.annotated) return;\n\n    if (!this.currentMask) {\n      this.currentMask = new ImageJS.Image(\n        this.image.width,\n        this.image.height,\n        new Uint8Array(this.image.width * this.image.height * 4),\n        { alpha: 1 }\n      );\n    }\n\n    if (!this.superpixels) return;\n\n    this.annotating = true;\n  }\n\n  onMouseMove(position: { x: number; y: number }) {\n    if (!this.superpixels) return;\n\n    const pixel = this.flatPixelCoordinate(position);\n\n    const superpixel = this.superpixels[pixel];\n\n    if (this.currentSuperpixels.has(superpixel)) return; // don't draw superpixel mask if already on that superpixel\n\n    this.lastSuperpixel = superpixel;\n\n    if (!this.annotating) {\n      this.currentSuperpixels.clear();\n\n      this.currentMask = new ImageJS.Image(\n        this.image.width,\n        this.image.height,\n        new Uint8Array(this.image.width * this.image.height * 4),\n        { alpha: 1 }\n      );\n    }\n\n    this.currentSuperpixels.add(superpixel);\n\n    this.superpixelsMap![superpixel].forEach((index: number) => {\n      this.currentMask!.setPixel(index, [255, 0, 0, 150]);\n    });\n  }\n\n  onMouseUp(position: { x: number; y: number }) {\n    if (this.annotated || !this.annotating) return;\n\n    if (!this.currentMask) return;\n\n    const greyMask = this.currentMask.grey();\n    //@ts-ignore\n    const binaryMask = greyMask.mask({ algorithm: \"threshold\", threshold: 1 });\n\n    //compute bounding box with ROI manager\n    const roiManager = this.image.getRoiManager();\n    // @ts-ignore\n    roiManager.fromMask(binaryMask);\n    // @ts-ignore\n    const rois = roiManager.getRois();\n    const roi = rois.sort((a: any, b: any) => {\n      return b.surface - a.surface;\n    })[1]; // take the second roi because the first one will be of the size of the image,the second one is the actual largest roi\n    this._boundingBox = [roi.minX, roi.minY, roi.maxX, roi.maxY];\n\n    const croppedGreyMask = greyMask.crop({\n      x: this._boundingBox[0],\n      y: this._boundingBox[1],\n      width: this._boundingBox[2] - this._boundingBox[0],\n      height: this._boundingBox[3] - this._boundingBox[1],\n    });\n\n    const thresholded = _.map(croppedGreyMask.data, (i: number) =>\n      i > 1 ? 255 : 0\n    );\n\n    //compute mask\n    this._mask = encode(Uint8Array.from(thresholded));\n\n    this.annotated = true;\n    this.annotating = false;\n  }\n\n  static setup(image: ImageJS.Image, brushsize: number) {\n    const instance = new QuickAnnotationTool(image);\n\n    instance.update(brushsize);\n\n    return instance;\n  }\n\n  update(brushsize: number) {\n    this.brushsize = Math.round(brushsize);\n\n    const { superpixels } = this.filter();\n\n    this.superpixels = superpixels;\n\n    this.superpixelsMap = {};\n\n    superpixels.forEach((pixel: number, index: number) => {\n      if (!(pixel in this.superpixelsMap!)) {\n        this.superpixelsMap![pixel] = [];\n      }\n      this.superpixelsMap![pixel].push(index);\n    });\n  }\n}\n","export const slic = (\n  data: Uint8Array | Uint8ClampedArray,\n  width: number,\n  height: number,\n  regionSize: number = 40,\n  minRegionSize?: number\n) => {\n  if (!minRegionSize) {\n    minRegionSize = (regionSize * regionSize) / 4;\n  }\n\n  const imWidth = width;\n  const imHeight = height;\n  const numRegionsX = parseInt(String(imWidth / regionSize), 10);\n  const numRegionsY = parseInt(String(imHeight / regionSize), 10);\n  const numRegions = parseInt(String(numRegionsX * numRegionsY), 10);\n  const numPixels = parseInt(String(imWidth * imHeight), 10);\n  const masses = new Array(numPixels);\n  const currentCenters = new Float32Array((2 + 3) * numRegions);\n  const newCenters = new Float32Array((2 + 3) * numRegions);\n  const parameters = new Float32Array(2 * numRegions);\n  const mcMap = new Float32Array(numPixels);\n  const msMap = new Float32Array(numPixels);\n  const distanceMap = new Float32Array(numPixels);\n\n  /*\n   * RGB to XYZ\n   */\n  const xyz = new Float32Array(3 * imWidth * imHeight);\n\n  const gamma = 2.2;\n\n  for (let i = 0; i < imWidth * imHeight; i++) {\n    const r = Math.pow(parseFloat(String(data[4 * i])) * 0.00392156862, gamma);\n\n    const g = Math.pow(\n      parseFloat(String(data[4 * i + 1])) * 0.00392156862,\n      gamma\n    );\n\n    const b = Math.pow(\n      parseFloat(String(data[4 * i + 2])) * 0.00392156862,\n      gamma\n    );\n\n    xyz[i] = r * 0.488718 + g * 0.31068 + b * 0.200602;\n    xyz[i + imWidth * imHeight] = r * 0.176204 + g * 0.812985 + b * 0.0108109;\n    xyz[i + 2 * imWidth * imHeight] = g * 0.0102048 + b * 0.989795;\n  }\n\n  /*\n   * XYZ to Lab\n   */\n  const xw = 1.0 / 3.0;\n  const yw = 1.0 / 3.0;\n  const Yw = 1.0;\n  const Xw = xw / yw;\n  const Zw = ((1 - xw - yw) / yw) * Yw;\n  const ix = 1.0 / Xw;\n  const iy = 1.0 / Yw;\n  const iz = 1.0 / Zw;\n  const lab = new Float32Array(3 * imWidth * imHeight);\n\n  for (let i = 0; i < imWidth * imHeight; i++) {\n    const fx =\n      xyz[i] * ix > 0.00856\n        ? Math.pow(xyz[i] * ix, 0.33333333)\n        : 7.78706891568 * xyz[i] * ix + 0.1379310336;\n\n    const fy =\n      xyz[imWidth * imHeight + i] * iy > 0.00856\n        ? Math.pow(xyz[imWidth * imHeight + i] * iy, 0.33333333)\n        : 7.78706891568 * xyz[imWidth * imHeight + i] * iy + 0.1379310336;\n\n    const fz =\n      xyz[2 * imWidth * imHeight + i] * iz > 0.00856\n        ? Math.pow(xyz[2 * imWidth * imHeight + i] * iz, 0.33333333)\n        : 7.78706891568 * xyz[2 * imWidth * imHeight + i] * iz + 0.1379310336;\n\n    lab[i] = 116.0 * fy - 16.0;\n    lab[i + imWidth * imHeight] = 500.0 * (fx - fy);\n    lab[i + 2 * imWidth * imHeight] = 200.0 * (fy - fz);\n  }\n\n  /*\n   * Compute gradient\n   */\n  const gradient = new Float32Array(numPixels);\n\n  for (let k = 0; k < 3; k++) {\n    for (let y = 1; y < imHeight - 1; y++) {\n      for (let x = 1; x < imWidth - 1; x++) {\n        const a = lab[k * imWidth * imHeight + y * imWidth + x - 1];\n        const b = lab[k * imWidth * imHeight + y * imWidth + x + 1];\n        const c = lab[k * imWidth * imHeight + (y + 1) * imWidth + x];\n        const d = lab[k * imWidth * imHeight + (y - 1) * imWidth + x];\n\n        gradient[y * imWidth + x] =\n          gradient[y * imWidth + x] + (a - b) * (a - b) + (c - d) * (c - d);\n      }\n    }\n  }\n\n  /*\n   * Initialize k-means centroids\n   */\n  let i = 0;\n  let j = 0;\n\n  for (let v = 0; v < numRegionsY; v++) {\n    for (let u = 0; u < numRegionsX; u++) {\n      let centerx = 0;\n      let centery = 0;\n      let minEdgeValue = Infinity;\n\n      let x = parseInt(String(Math.round(regionSize * (u + 0.5))), 10);\n      let y = parseInt(String(Math.round(regionSize * (v + 0.5))), 10);\n\n      x = Math.max(Math.min(x, imWidth - 1), 0);\n      y = Math.max(Math.min(y, imHeight - 1), 0);\n\n      for (\n        let yp = Math.max(0, y - 1);\n        yp <= Math.min(imHeight - 1, y + 1);\n        yp++\n      ) {\n        for (\n          let xp = Math.max(0, x - 1);\n          xp <= Math.min(imWidth - 1, x + 1);\n          xp++\n        ) {\n          const thisEdgeValue = gradient[yp * imWidth + xp];\n\n          if (thisEdgeValue < minEdgeValue) {\n            minEdgeValue = thisEdgeValue;\n            centerx = xp;\n            centery = yp;\n          }\n        }\n      }\n\n      currentCenters[i++] = parseFloat(String(centerx));\n      currentCenters[i++] = parseFloat(String(centery));\n\n      currentCenters[i++] = lab[centery * imWidth + centerx];\n      currentCenters[i++] =\n        lab[imWidth * imHeight + centery * imWidth + centerx];\n      currentCenters[i++] =\n        lab[2 * imWidth * imHeight + centery * imWidth + centerx];\n\n      parameters[j++] = 10 * 10;\n      parameters[j++] = regionSize * regionSize;\n    }\n  }\n\n  const iterations = 10;\n\n  const segmentation = new Int32Array(numPixels);\n\n  for (let iteration = 0; iteration < iterations; ++iteration) {\n    /*\n     * Label\n     */\n    for (let i1 = 0; i1 < distanceMap.length; ++i1) {\n      distanceMap[i1] = Infinity;\n    }\n\n    for (let region = 0; region < numRegionsX * numRegionsY; ++region) {\n      const cx = Math.round(currentCenters[region * 5]);\n      const cy = Math.round(currentCenters[region * 5 + 1]);\n\n      for (\n        let y2 = Math.max(0, cy - regionSize);\n        y2 < Math.min(imHeight, cy + regionSize);\n        ++y2\n      ) {\n        for (\n          let x2 = Math.max(0, cx - regionSize);\n          x2 < Math.min(imWidth, cx + regionSize);\n          ++x2\n        ) {\n          const spatial = (x2 - cx) * (x2 - cx) + (y2 - cy) * (y2 - cy);\n          const dR = lab[y2 * imWidth + x2] - currentCenters[5 * region + 2];\n          const dG =\n            lab[imWidth * imHeight + y2 * imWidth + x2] -\n            currentCenters[5 * region + 3];\n          const dB =\n            lab[2 * imWidth * imHeight + y2 * imWidth + x2] -\n            currentCenters[5 * region + 4];\n          const appearance = dR * dR + dG * dG + dB * dB;\n\n          const distance = Math.sqrt(\n            appearance / parameters[region * 2] +\n              spatial / parameters[region * 2 + 1]\n          );\n\n          if (distance < distanceMap[y2 * imWidth + x2]) {\n            distanceMap[y2 * imWidth + x2] = distance;\n            segmentation[y2 * imWidth + x2] = region;\n          }\n        }\n      }\n    }\n\n    for (let y2 = 0; y2 < imHeight; ++y2) {\n      for (let x2 = 0; x2 < imWidth; ++x2) {\n        if (\n          parameters[segmentation[y2 * imWidth + x2] * 2] <\n          mcMap[y2 * imWidth + x2]\n        ) {\n          parameters[segmentation[y2 * imWidth + x2] * 2] =\n            mcMap[y2 * imWidth + x2];\n        }\n\n        if (\n          parameters[segmentation[y2 * imWidth + x2] * 2 + 1] <\n          msMap[y2 * imWidth + x2]\n        ) {\n          parameters[segmentation[y2 * imWidth + x2] * 2 + 1] =\n            msMap[y2 * imWidth + x2];\n        }\n      }\n    }\n\n    /*\n     * Update parameters\n     */\n    const mc = new Float32Array(parameters.length / 2);\n    const ms = new Float32Array(parameters.length / 2);\n\n    for (let i1 = 0; i1 < segmentation.length; i1++) {\n      const region = segmentation[i1];\n\n      if (mc[region] < mcMap[region]) {\n        mc[region] = mcMap[region];\n\n        parameters[region * 2] = mcMap[region];\n      }\n\n      if (ms[region] < msMap[region]) {\n        ms[region] = msMap[region];\n\n        parameters[region * 2 + 1] = msMap[region];\n      }\n    }\n\n    for (let i = 0; i < masses.length; ++i) {\n      masses[i] = 0;\n    }\n\n    for (let i = 0; i < newCenters.length; ++i) {\n      newCenters[i] = 0;\n    }\n\n    /*\n     * Compute centroids\n     */\n    let region;\n\n    for (let y1 = 0; y1 < imHeight; y1++) {\n      for (let x1 = 0; x1 < imWidth; x1++) {\n        region = segmentation[x1 + y1 * imWidth];\n\n        masses[region]++;\n\n        newCenters[region * 5] += x1;\n        newCenters[region * 5 + 1] += y1;\n        newCenters[region * 5 + 2] += lab[y1 * imWidth + x1];\n        newCenters[region * 5 + 3] +=\n          lab[imWidth * imHeight + y1 * imWidth + x1];\n        newCenters[region * 5 + 4] +=\n          lab[2 * imWidth * imHeight + y1 * imWidth + x1];\n      }\n    }\n\n    for (region = 0; region < numRegions; region++) {\n      const iMass = 1.0 / Math.max(masses[region], 1e-8);\n\n      newCenters[region * 5] = newCenters[region * 5] * iMass;\n      newCenters[region * 5 + 1] = newCenters[region * 5 + 1] * iMass;\n      newCenters[region * 5 + 2] = newCenters[region * 5 + 2] * iMass;\n      newCenters[region * 5 + 3] = newCenters[region * 5 + 3] * iMass;\n      newCenters[region * 5 + 4] = newCenters[region * 5 + 4] * iMass;\n    }\n\n    /*\n     * Compute residual error\n     */\n    let error = 0.0;\n\n    for (let index = 0; index < currentCenters.length; ++index) {\n      const d = currentCenters[index] - newCenters[index];\n\n      error += Math.sqrt(d * d);\n    }\n\n    if (error < 1e-5) {\n      break;\n    }\n\n    for (let i = 0; i < currentCenters.length; ++i) {\n      currentCenters[i] = newCenters[i];\n    }\n  }\n\n  /*\n   * Remove small objects\n   */\n  const cleaned = new Int32Array(numPixels);\n  const segment = new Int32Array(numPixels);\n\n  const dx = [1, -1, 0, 0];\n  const dy = [0, 0, 1, -1];\n\n  let segmentSize;\n  let label;\n  let cleanedLabel;\n  let numExpanded;\n  let x1;\n  let y1;\n  let xp;\n  let yp;\n  let neighbor;\n\n  for (let pixel = 0; pixel < numPixels; pixel++) {\n    if (cleaned[pixel]) continue;\n\n    label = segmentation[pixel];\n    numExpanded = 0;\n    segmentSize = 0;\n    segment[segmentSize++] = pixel;\n\n    cleanedLabel = label + 1;\n    cleaned[pixel] = label + 1;\n    x1 = pixel % imWidth;\n    y1 = Math.floor(pixel / imWidth);\n\n    for (let direction = 0; direction < 4; direction++) {\n      xp = x1 + dx[direction];\n      yp = y1 + dy[direction];\n      neighbor = xp + yp * imWidth;\n\n      if (\n        0 <= xp &&\n        xp < imWidth &&\n        0 <= yp &&\n        yp < imHeight &&\n        cleaned[neighbor]\n      ) {\n        cleanedLabel = cleaned[neighbor];\n      }\n    }\n\n    while (numExpanded < segmentSize) {\n      const open = segment[numExpanded++];\n\n      x1 = open % imWidth;\n      y1 = Math.floor(open / imWidth);\n\n      for (let direction = 0; direction < 4; ++direction) {\n        xp = x1 + dx[direction];\n        yp = y1 + dy[direction];\n        neighbor = xp + yp * imWidth;\n\n        if (\n          0 <= xp &&\n          xp < imWidth &&\n          0 <= yp &&\n          yp < imHeight &&\n          cleaned[neighbor] === 0 &&\n          segmentation[neighbor] === label\n        ) {\n          cleaned[neighbor] = label + 1;\n          segment[segmentSize++] = neighbor;\n        }\n      }\n    }\n\n    if (segmentSize < minRegionSize) {\n      while (segmentSize > 0) {\n        cleaned[segment[--segmentSize]] = cleanedLabel;\n      }\n    }\n  }\n\n  for (let pixel = 0; pixel < numPixels; ++pixel) {\n    --cleaned[pixel];\n  }\n\n  for (let index = 0; index < numPixels; ++index) {\n    segmentation[index] = cleaned[index];\n  }\n\n  return {\n    count: 0,\n    map: data,\n    superpixels: segmentation,\n  };\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const penSelectionBrushSizeSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.penSelectionBrushSize;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const quickSelectionBrushSizeSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.quickSelectionBrushSize;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageSrcSelector = ({ state }: { state: HistoryStateType }) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.src;\n};\n","import { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../store/selectors\";\nimport { ToolType } from \"../../types/ToolType\";\n\nexport const useCursor = () => {\n  const [cursor, setCursor] = useState<string>();\n\n  const toolType = useSelector(toolTypeSelector);\n\n  useEffect(() => {\n    switch (toolType) {\n      case ToolType.EllipticalAnnotation:\n        setCursor(\"crosshair\");\n\n        break;\n      case ToolType.PenAnnotation:\n        setCursor(\"none\");\n\n        break;\n      case ToolType.RectangularAnnotation:\n        setCursor(\"crosshair\");\n\n        break;\n      default:\n        setCursor(\"pointer\");\n\n        break;\n    }\n  }, [toolType]);\n\n  return { cursor };\n};\n","import { useCallback, useState } from \"react\";\n\nexport const useDialog = () => {\n  const [open, setOpen] = useState(false);\n\n  const onClose = useCallback(() => {\n    setOpen(!open);\n  }, [open]);\n\n  const onOpen = useCallback(() => {\n    setOpen(!open);\n  }, [open]);\n\n  return { onClose, onOpen, open };\n};\n","import React, { useState } from \"react\";\n\nexport const useMarchingAnts = () => {\n  const [dashOffset, setDashOffset] = useState<number>(0);\n\n  React.useEffect(() => {\n    const timer = setTimeout(() => {\n      setDashOffset(dashOffset + 1);\n\n      if (dashOffset > 32) {\n        setDashOffset(0);\n      }\n    }, 200);\n    return () => clearTimeout(timer);\n  });\n\n  return dashOffset;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const scaledImageWidthSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.shape.width * state.present.stageScale;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const soundEnabledSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.soundEnabled;\n};\n","import makeStyles from \"@material-ui/core/styles/makeStyles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  form: {\n    maginLeft: \"15px\",\n  },\n  content: {\n    marginTop: theme.spacing(2),\n  },\n  boxLayout: {\n    display: \"flex\",\n    justifyContent: \"flex-start\",\n    alignItems: \"center\",\n    margin: \"20px\",\n  },\n  typography: {\n    fontWeight: \"inherit\",\n    marginRight: \"15px\",\n    width: \"100px\",\n    textAlign: \"right\",\n  },\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n  title: {\n    flexGrow: 1,\n  },\n  appBar: {\n    flexGrow: 1,\n  },\n  toolbar: {\n    ...theme.mixins.toolbar,\n  },\n}));\n","import React from \"react\";\nimport {\n  AppBar,\n  Dialog,\n  FormControlLabel,\n  InputLabel,\n  Select,\n} from \"@material-ui/core\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Typography from \"@material-ui/core/Typography\";\nimport FormGroup from \"@material-ui/core/FormGroup\";\nimport Switch from \"@material-ui/core/Switch\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { LanguageType } from \"../../../../types/LanguageType\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { applicationSlice } from \"../../../../store\";\nimport { languageSelector } from \"../../../../store/selectors/languageSelector\";\nimport { soundEnabledSelector } from \"../../../../store/selectors/soundEnabledSelector\";\nimport { useStyles } from \"./SettingsDialog.css\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport IconButton from \"@material-ui/core/IconButton\";\n\ntype SettingsDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const SettingsDialog = ({ onClose, open }: SettingsDialogProps) => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n\n  const language = useSelector(languageSelector);\n  const soundEnabled = useSelector(soundEnabledSelector);\n\n  const onLanguageChange = (event: React.ChangeEvent<{ value: unknown }>) => {\n    dispatch(\n      applicationSlice.actions.setLanguage({\n        language: event.target.value as LanguageType,\n      })\n    );\n  };\n\n  const onSoundEffectsChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    dispatch(\n      applicationSlice.actions.setSoundEnabled({\n        soundEnabled: event.target.checked,\n      })\n    );\n  };\n\n  return (\n    <Dialog fullScreen onClose={onClose} open={open}>\n      <AppBar className={classes.appBar} color=\"inherit\" position=\"fixed\">\n        <Toolbar>\n          <Typography className={classes.title} variant=\"h6\">\n            Settings\n          </Typography>\n\n          <IconButton aria-label=\"close\" onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.toolbar} />\n\n      <DialogContent className={classes.content}>\n        <Grid container spacing={2}>\n          <Grid item xs={3} />\n\n          <Grid item xs={6}>\n            <Grid container>\n              <Grid item xs={12}>\n                <Grid container item xs={4}>\n                  <FormControl color=\"primary\" fullWidth>\n                    <InputLabel shrink id=\"settings-language\">\n                      Language\n                    </InputLabel>\n\n                    <Select\n                      id=\"settings-language-label\"\n                      labelId=\"settings-language\"\n                      onChange={onLanguageChange}\n                      value={language}\n                    >\n                      <MenuItem value={LanguageType.English}>English</MenuItem>\n                      <MenuItem value={LanguageType.Arabic}>Arabic</MenuItem>\n                      <MenuItem value={LanguageType.Farsi}>Farsi</MenuItem>\n                      <MenuItem value={LanguageType.Finnish}>Finnish</MenuItem>\n                      <MenuItem value={LanguageType.French}>French</MenuItem>\n                      <MenuItem value={LanguageType.German}>German</MenuItem>\n                      <MenuItem value={LanguageType.Hindi}>Hindi</MenuItem>\n                      <MenuItem value={LanguageType.Hungarian}>\n                        Hungarian\n                      </MenuItem>\n                      <MenuItem value={LanguageType.Spanish}>Spanish</MenuItem>\n                    </Select>\n                  </FormControl>\n                </Grid>\n              </Grid>\n\n              <Grid item style={{ padding: \"32px 0\" }} xs={12}>\n                <Divider />\n              </Grid>\n\n              <Grid item xs={12}>\n                <FormControl component=\"fieldset\">\n                  <FormGroup aria-label=\"position\" row>\n                    <FormControlLabel\n                      control={\n                        <Switch\n                          color=\"default\"\n                          checked={soundEnabled}\n                          onChange={onSoundEffectsChange}\n                          name=\"soundEnabled\"\n                        />\n                      }\n                      label=\"Sound effects\"\n                    />\n                  </FormGroup>\n                </FormControl>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  alert: {\n    width: theme.spacing(64),\n  },\n  appBar: {\n    transition: theme.transitions.create([\"margin\", \"width\"], {\n      duration: theme.transitions.duration.leavingScreen,\n      easing: theme.transitions.easing.sharp,\n    }),\n  },\n  appBarShift: {\n    marginLeft: theme.spacing(32),\n    transition: theme.transitions.create([\"margin\", \"width\"], {\n      duration: theme.transitions.duration.enteringScreen,\n      easing: theme.transitions.easing.easeOut,\n    }),\n    width: `calc(100% - ${theme.spacing(32)}px)`,\n  },\n  card: {},\n  classifierSettingsDialogContent: {\n    marginTop: theme.spacing(8),\n  },\n  chip: {\n    height: \"20px\",\n    borderWidth: \"2px\",\n    fontSize: \"0.875rem\",\n    color: \"white\",\n  },\n  colorPicker: {\n    margin: \"16px\",\n  },\n  container: {\n    paddingBottom: theme.spacing(8),\n    paddingTop: theme.spacing(8),\n  },\n  createCategoryDialogContent: {\n    paddingLeft: \"0 !important\",\n  },\n  createCategoryDialogGrid: {\n    margin: theme.spacing(1),\n  },\n  createCategoryDialogItem: {\n    // paddingLeft: \"0 !important\",\n  },\n  drawer: {\n    flexShrink: 0,\n    width: theme.spacing(32),\n  },\n  drawerHeader: {\n    ...theme.mixins.toolbar,\n    alignItems: \"center\",\n    display: \"flex\",\n    paddingLeft: theme.spacing(3),\n  },\n  drawerPaper: {\n    width: theme.spacing(32),\n  },\n  fileInput: {\n    display: \"none\",\n  },\n  gridList: {\n    transform: \"translateZ(0)\",\n  },\n  gridTileBar: {\n    background:\n      \"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0) 100%)\",\n  },\n  gridTileBarIconButton: {\n    color: \"white\",\n  },\n  imageDialogAppBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  imageDialogContent: {\n    paddingBottom: theme.spacing(12),\n    paddingTop: theme.spacing(12),\n  },\n  imageSelected: {\n    border: \"solid 2px blue\",\n    borderRadius: \"3px\",\n  },\n  imageUnselected: {\n    border: \"none\",\n  },\n  main: {\n    flexGrow: 1,\n    marginLeft: -theme.spacing(32),\n    padding: theme.spacing(3),\n    transition: theme.transitions.create(\"margin\", {\n      duration: theme.transitions.duration.leavingScreen,\n      easing: theme.transitions.easing.sharp,\n    }),\n  },\n  mainShift: {\n    marginLeft: theme.spacing(32),\n    transition: theme.transitions.create(\"margin\", {\n      duration: theme.transitions.duration.enteringScreen,\n      easing: theme.transitions.easing.easeOut,\n    }),\n  },\n  media: {},\n  progress: {\n    width: \"100%\",\n  },\n  settingsDialogAppBar: {},\n  slider: {\n    padding: theme.spacing(3),\n  },\n  sliderInput: {\n    width: 42,\n  },\n}));\n","import Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport Button from \"@material-ui/core/Button\";\nimport React, { ChangeEvent, FormEvent, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ColorIcon } from \"../../ColorIcon\";\nimport Grid from \"@material-ui/core/Grid\";\nimport { useStyles } from \"./CreateCategoryDialog.css\";\nimport { ColorResult } from \"react-color\";\nimport { sample } from \"underscore\";\nimport { applicationSlice } from \"../../../../../store\";\nimport { v4 } from \"uuid\";\nimport { CategoryType } from \"../../../../../types/CategoryType\";\nimport { categoriesSelector } from \"../../../../../store/selectors\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport { replaceDuplicateName } from \"../../../../../image/imageHelper\";\n\nconst COLORS = [\n  \"#f44336\",\n  \"#e91e63\",\n  \"#9c27b0\",\n  \"#673ab7\",\n  \"#3f51b5\",\n  \"#2196f3\",\n  \"#03a9f4\",\n  \"#00bcd4\",\n  \"#009688\",\n  \"#4caf50\",\n  \"#8bc34a\",\n  \"#cddc39\",\n  \"#ffeb3b\",\n  \"#ffc107\",\n  \"#ff9800\",\n  \"#ff5722\",\n  \"#795548\",\n  \"#607d8b\",\n];\n\ntype CreateCategoryDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const CreateCategoryDialog = ({\n  onClose,\n  open,\n}: CreateCategoryDialogProps) => {\n  const dispatch = useDispatch();\n\n  const categories = useSelector(categoriesSelector);\n\n  const [color, setColor] = React.useState<string>(sample(COLORS)!);\n\n  const [name, setName] = useState<string>(\"\");\n\n  const classes = useStyles();\n\n  const onCreate = () => {\n    const initialName = name ? name : \"Unnamed\";\n    const categoryNames = categories.map((category: CategoryType) => {\n      return category.name;\n    });\n    const updatedName = replaceDuplicateName(initialName, categoryNames);\n\n    const category: CategoryType = {\n      color: color,\n      id: v4().toString(),\n      name: updatedName,\n      visible: true,\n    };\n\n    dispatch(\n      applicationSlice.actions.setCategories({\n        categories: [...categories, category],\n      })\n    );\n\n    dispatch(\n      applicationSlice.actions.setSelectedCategory({\n        selectedCategory: category.id,\n      })\n    );\n\n    setName(\"\");\n\n    onClose();\n\n    setColor(sample(COLORS)!);\n  };\n\n  const onColorChange = (color: ColorResult) => {\n    setColor(color.hex);\n  };\n\n  const onNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setName(event.target.value);\n  };\n\n  const t = useTranslation();\n\n  const onSubmit = (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n  };\n\n  return (\n    <Dialog fullWidth maxWidth=\"xs\" onClose={onClose} open={open}>\n      <form onSubmit={(event) => onSubmit(event)}>\n        <DialogTitle>{t(\"Create category\")}</DialogTitle>\n\n        <DialogContent className={classes.createCategoryDialogContent}>\n          <div className={classes.createCategoryDialogGrid}>\n            <Grid container spacing={1}>\n              <Grid item xs={2} className={classes.createCategoryDialogItem}>\n                <ColorIcon color={color} onColorChange={onColorChange} />\n              </Grid>\n              <Grid item xs={10}>\n                <TextField\n                  autoFocus\n                  fullWidth\n                  id=\"name\"\n                  label={t(\"Name\")}\n                  margin=\"dense\"\n                  onChange={onNameChange}\n                />\n              </Grid>\n            </Grid>\n          </div>\n        </DialogContent>\n\n        <DialogActions>\n          <Button onClick={onClose} color=\"primary\">\n            {t(\"Cancel\")}\n          </Button>\n\n          <Button onClick={onCreate} color=\"primary\" type=\"submit\">\n            {t(\"Create\")}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\n\nexport const selectedAnnotationsIdsSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): Array<string> => {\n  return state.present.selectedAnnotations.map((annotation: AnnotationType) => {\n    return annotation.id;\n  });\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const activeImageIdSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): string | undefined => {\n  return state.present.activeImageId;\n};\n","import React from \"react\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuList from \"@material-ui/core/MenuList\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { applicationSlice, setImages } from \"../../../../store\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { activeImageIdSelector } from \"../../../../store/selectors/activeImageIdSelector\";\nimport { saveAnnotationsAsMasks } from \"../../../../image/imageHelper\";\nimport { saveAs } from \"file-saver\";\nimport JSZip from \"jszip\";\nimport { categoriesSelector } from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport { ImageType } from \"../../../../types/ImageType\";\n\ntype ImageMenuProps = {\n  anchorElImageMenu: any;\n  onCloseImageMenu: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\n  openImageMenu: boolean;\n};\n\nexport const ImageMenu = ({\n  anchorElImageMenu,\n  onCloseImageMenu,\n  openImageMenu,\n}: ImageMenuProps) => {\n  const dispatch = useDispatch();\n  const currentImageId = useSelector(activeImageIdSelector);\n  const categories = useSelector(categoriesSelector);\n  const images = useSelector(imagesSelector);\n\n  const onClearAnnotationsClick = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    if (!currentImageId) return;\n    dispatch(\n      applicationSlice.actions.deleteImageInstances({ imageId: currentImageId })\n    );\n    onCloseImageMenu(event);\n  };\n\n  const onDeleteImage = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {\n    if (!currentImageId) return;\n    dispatch(applicationSlice.actions.deleteImage({ id: currentImageId }));\n    onCloseImageMenu(event);\n  };\n\n  const onExportAnnotations = (\n    event: React.MouseEvent<HTMLElement, MouseEvent>\n  ) => {\n    let zip = new JSZip();\n\n    const activeImage = images.find((image: ImageType) => {\n      return image.id === currentImageId;\n    });\n\n    if (!activeImage) return;\n\n    Promise.all(saveAnnotationsAsMasks([activeImage], categories, zip)).then(\n      () => {\n        zip.generateAsync({ type: \"blob\" }).then((blob) => {\n          saveAs(blob, \"annotations.zip\");\n        });\n      }\n    );\n  };\n\n  const t = useTranslation();\n\n  return (\n    <Menu\n      anchorEl={anchorElImageMenu}\n      anchorOrigin={{ horizontal: \"center\", vertical: \"bottom\" }}\n      getContentAnchorEl={null}\n      onClose={onCloseImageMenu}\n      open={openImageMenu}\n      transformOrigin={{ horizontal: \"center\", vertical: \"top\" }}\n    >\n      <MenuList dense variant=\"menu\">\n        <div>\n          <MenuItem onClick={onClearAnnotationsClick}>\n            <Typography variant=\"inherit\">{t(\"Clear Annotations\")}</Typography>\n          </MenuItem>\n\n          <MenuItem onClick={onDeleteImage}>\n            <Typography variant=\"inherit\">{t(\"Delete Image\")}</Typography>\n          </MenuItem>\n\n          <MenuItem onClick={onExportAnnotations}>\n            <Typography variant=\"inherit\">{t(\"Export annotations\")}</Typography>\n          </MenuItem>\n        </div>\n      </MenuList>\n    </Menu>\n  );\n};\n","import React from \"react\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport Button from \"@material-ui/core/Button\";\nimport { useDispatch } from \"react-redux\";\nimport { applicationSlice } from \"../../../../store\";\n\ntype DeleteAllAnnotationsDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const DeleteAllAnnotationsDialog = ({\n  onClose,\n  open,\n}: DeleteAllAnnotationsDialogProps) => {\n  const dispatch = useDispatch();\n\n  const onDelete = () => {\n    dispatch(applicationSlice.actions.deleteAllInstances({ id: \"\" }));\n    dispatch(\n      applicationSlice.actions.setSelectedCategory({\n        selectedCategory: \"00000000-0000-0000-0000-000000000000\",\n      })\n    );\n    onClose();\n  };\n\n  return (\n    <Dialog disableBackdropClick={true} fullWidth onClose={onClose} open={open}>\n      <DialogTitle>Delete all annotations?</DialogTitle>\n\n      <DialogContent>\n        All annotations across all images will be permanently deleted.\"\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={onDelete} color=\"primary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport { CategoryType } from \"../../types/CategoryType\";\nimport { ImageType } from \"../../types/ImageType\";\nimport { SerializedFileType } from \"../../types/SerializedFileType\";\n\nexport const allSerializedAnnotationsSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): Array<SerializedFileType> => {\n  if (!state.present.images.length) return [];\n\n  return state.present.images.map((image: ImageType) => {\n    const columns = {\n      imageChannels: image.shape.channels,\n      imageChecksum: \"\",\n      imageData: image.originalSrc,\n      imageFilename: image.name,\n      imageFrames: image.shape.frames,\n      imageHeight: image.shape.height,\n      imageId: image.id,\n      imagePlanes: image.shape.planes,\n      imageWidth: image.shape.width,\n    };\n\n    const serializedAnnotations = image.annotations.map(\n      (annotation: AnnotationType) => {\n        const index = state.present.categories.findIndex(\n          (category: CategoryType) => {\n            return category.id === annotation.categoryId;\n          }\n        );\n\n        const category = state.present.categories[index];\n\n        return {\n          annotationBoundingBoxHeight: annotation.boundingBox[3],\n          annotationBoundingBoxWidth: annotation.boundingBox[2],\n          annotationBoundingBoxX: annotation.boundingBox[0],\n          annotationBoundingBoxY: annotation.boundingBox[1],\n          annotationCategoryColor: category.color,\n          annotationCategoryId: category.id,\n          annotationCategoryName: category.name,\n          annotationId: annotation.id,\n          annotationMask: annotation.mask.join(\" \"),\n        };\n      }\n    );\n\n    return { ...columns, annotations: serializedAnnotations };\n  });\n};\n","import { useSelector } from \"react-redux\";\nimport { allSerializedAnnotationsSelector } from \"../../../../store/selectors/allSerializedAnnotationsSelector\";\nimport { saveAs } from \"file-saver\";\nimport { MenuItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport React from \"react\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n};\n\nexport const SaveProjectFileMenuItem = ({\n  popupState,\n}: SaveAnnotationsMenuItemProps) => {\n  const serializedProject = useSelector(allSerializedAnnotationsSelector);\n\n  const onSaveAllAnnotations = () => {\n    const blob = new Blob([JSON.stringify(serializedProject)]);\n\n    saveAs(blob, \"project.json\");\n\n    popupState.close();\n  };\n  return (\n    <MenuItem onClick={onSaveAllAnnotations}>\n      <ListItemText primary=\"Save project file\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAs } from \"file-saver\";\nimport { saveAnnotationsAsMasks } from \"../../../../image/imageHelper\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n};\n\nexport const ExportAnnotationsAsImagesMenuItem = ({\n  popupState,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n\n    Promise.all(saveAnnotationsAsMasks(images, categories, zip)).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"annotations.zip\");\n      });\n    });\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Export annotations\" />\n    </MenuItem>\n  );\n};\n","import React from \"react\";\nimport { MenuItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  imageInstancesSelector,\n} from \"../../../../store/selectors\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport JSZip from \"jszip\";\nimport { saveAs } from \"file-saver\";\nimport { saveAnnotationsAsMatrix } from \"../../../../image/imageHelper\";\n\ntype SaveAnnotationsMenuItemProps = {\n  popupState: any;\n};\n\nexport const ExportAnnotationsAsMatrixMenuItem = ({\n  popupState,\n}: SaveAnnotationsMenuItemProps) => {\n  const annotations = useSelector(imageInstancesSelector);\n  const images = useSelector(imagesSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onExport = () => {\n    popupState.close();\n\n    if (!annotations) return;\n\n    let zip = new JSZip();\n\n    Promise.all(saveAnnotationsAsMatrix(images, categories, zip)).then(() => {\n      zip.generateAsync({ type: \"blob\" }).then((blob) => {\n        saveAs(blob, \"labels.zip\");\n      });\n    });\n  };\n\n  return (\n    <MenuItem onClick={onExport}>\n      <ListItemText primary=\"Export label matrices\" />\n    </MenuItem>\n  );\n};\n","import { Menu } from \"@material-ui/core\";\nimport { bindMenu } from \"material-ui-popup-state\";\nimport React from \"react\";\nimport { ExportAnnotationsAsJsonMenuItem } from \"./ExportAnnotationsAsJsonMenuItem\";\nimport { SaveProjectFileMenuItem } from \"./SaveProjectFileMenuItem\";\nimport { ExportAnnotationsAsImagesMenuItem } from \"./ExportAnnotationsAsImagesMenuItem\";\nimport { ExportAnnotationsAsMatrixMenuItem } from \"./ExportAnnotationsAsMatrixMenuItem\";\n\ntype SaveMenuProps = {\n  popupState: any;\n};\n\nexport const SaveMenu = ({ popupState }: SaveMenuProps) => {\n  //TODO: do we need the ExportAnnotationsAsJSON button or is it redundant from SaveProjectFileMenuItem?\n  return (\n    <Menu {...bindMenu(popupState)}>\n      {/*<ExportAnnotationsAsJsonMenuItem popupState={popupState} />*/}\n      <ExportAnnotationsAsImagesMenuItem popupState={popupState} />\n      <ExportAnnotationsAsMatrixMenuItem popupState={popupState} />\n      <SaveProjectFileMenuItem popupState={popupState} />\n    </Menu>\n  );\n};\n","import { useDispatch } from \"react-redux\";\nimport React, { ChangeEvent } from \"react\";\nimport * as ImageJS from \"image-js\";\nimport { ShapeType } from \"../../../../types/ShapeType\";\nimport { ImageType } from \"../../../../types/ImageType\";\nimport { v4 } from \"uuid\";\nimport {\n  addImages,\n  setActiveImage,\n  setSelectedAnnotations,\n} from \"../../../../store/slices\";\nimport { MenuItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\n\ntype OpenImageMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenImageMenuItem = ({ popupState }: OpenImageMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onOpenImage = (\n    event: React.ChangeEvent<HTMLInputElement>,\n    onClose: () => void\n  ) => {\n    onClose();\n\n    event.persist();\n\n    if (event.currentTarget.files) {\n      for (let i = 0; i < event.currentTarget.files.length; i++) {\n        const file = event.currentTarget.files[i];\n\n        file.arrayBuffer().then((buffer) => {\n          ImageJS.Image.load(buffer).then((image) => {\n            //check whether name already exists\n            const shape: ShapeType = {\n              channels: image.components,\n              frames: 1,\n              height: image.height,\n              planes: 1,\n              width: image.width,\n            };\n\n            const imageDataURL = image.toDataURL(\"image/png\", {\n              useCanvas: true,\n            });\n\n            const loaded: ImageType = {\n              avatar: image\n                .resize({ width: 50 })\n                .toDataURL(\"image/png\", { useCanvas: true }),\n              id: v4(),\n              annotations: [],\n              name: file.name,\n              shape: shape,\n              originalSrc: imageDataURL,\n              src: imageDataURL,\n            };\n\n            dispatch(addImages({ newImages: [loaded] }));\n\n            if (i === 0) {\n              dispatch(\n                setActiveImage({\n                  image: loaded.id,\n                })\n              );\n\n              dispatch(\n                setSelectedAnnotations({\n                  selectedAnnotations: [],\n                  selectedAnnotation: undefined,\n                })\n              );\n            }\n          });\n        });\n      }\n    }\n  };\n\n  return (\n    <MenuItem component=\"label\">\n      <ListItemText primary=\"Open new image\" />\n      <input\n        accept=\"image/*\"\n        hidden\n        multiple\n        id=\"open-image\"\n        onChange={(event: ChangeEvent<HTMLInputElement>) =>\n          onOpenImage(event, popupState.close)\n        }\n        type=\"file\"\n      />\n    </MenuItem>\n  );\n};\n","import { useDispatch } from \"react-redux\";\nimport React from \"react\";\nimport {\n  applicationSlice,\n  setActiveImage,\n  setOperation,\n  setSelectedAnnotations,\n} from \"../../../../store/slices\";\nimport { MenuItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { SerializedFileType } from \"../../../../types/SerializedFileType\";\nimport { ToolType } from \"../../../../types/ToolType\";\n\ntype OpenAnnotationsMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenProjectFileMenuItem = ({\n  popupState,\n}: OpenAnnotationsMenuItemProps) => {\n  const dispatch = useDispatch();\n\n  const onOpenProjectFile = (\n    event: React.ChangeEvent<HTMLInputElement>,\n    onClose: () => void\n  ) => {\n    onClose();\n\n    event.persist();\n\n    if (!event.currentTarget.files) return;\n\n    const file = event.currentTarget.files[0];\n\n    const reader = new FileReader();\n\n    reader.onload = async (event: ProgressEvent<FileReader>) => {\n      if (event.target && event.target.result) {\n        const project = JSON.parse(event.target.result as string);\n\n        //clear all images\n        dispatch(applicationSlice.actions.setImages({ images: [] }));\n\n        project.forEach(\n          (serializedImage: SerializedFileType, index: number) => {\n            if (index === 0) {\n              dispatch(\n                setActiveImage({\n                  image: serializedImage.imageId,\n                })\n              );\n\n              dispatch(\n                setSelectedAnnotations({\n                  selectedAnnotations: [],\n                  selectedAnnotation: undefined,\n                })\n              );\n\n              dispatch(\n                setOperation({ operation: ToolType.RectangularAnnotation })\n              );\n            }\n            dispatch(\n              applicationSlice.actions.openAnnotations({\n                file: serializedImage,\n              })\n            );\n          }\n        );\n      }\n    };\n\n    reader.readAsText(file);\n  };\n\n  return (\n    <MenuItem component=\"label\">\n      <ListItemText primary=\"Open project file\" />\n      <input\n        accept=\"application/json\"\n        hidden\n        id=\"open-project-file\"\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n          onOpenProjectFile(event, popupState.close)\n        }\n        type=\"file\"\n      />\n    </MenuItem>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/malaria.5b73ad75.png\";","import Dialog from \"@material-ui/core/Dialog\";\nimport React from \"react\";\nimport { ShapeType } from \"../../../../types/ShapeType\";\nimport {\n  applicationSlice,\n  setActiveImage,\n  setChannels,\n  setImages,\n  setOperation,\n  setSelectedAnnotations,\n} from \"../../../../store\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport malaria from \"../../../../images/malaria.png\";\nimport cellpainting from \"../../../../images/cell-painting.png\";\nimport { ChannelType } from \"../../../../types/ChannelType\";\nimport { ToolType } from \"../../../../types/ToolType\";\nimport { ImageType } from \"../../../../types/ImageType\";\nimport { v4 } from \"uuid\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport * as malariaAnnotations from \"../../../../images/malaria.json\";\nimport * as cellpaintingAnnotations from \"../../../../images/cellpainting.json\";\nimport { AnnotationType } from \"../../../../types/AnnotationType\";\nimport { SerializedAnnotationType } from \"../../../../types/SerializedAnnotationType\";\nimport { CategoryType } from \"../../../../types/CategoryType\";\nimport { categoriesSelector } from \"../../../../store/selectors\";\nimport { importSerializedAnnotations } from \"../../../../image/imageHelper\";\n\ntype ExampleImageDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const ExampleImageDialog = ({\n  onClose,\n  open,\n}: ExampleImageDialogProps) => {\n  const dispatch = useDispatch();\n\n  const images = useSelector(imagesSelector);\n\n  const categories_in = useSelector(categoriesSelector);\n\n  const examples = [\n    {\n      name: \"malaria.png\",\n      description:\n        \"Blood cells infected by malaria and stained with Giemsa reagent. Image from the Broad Bioimage Benchmark Collection, image set BBBC041v1.\",\n      data: malaria,\n      project: (malariaAnnotations as any).default,\n      shape: {\n        channels: 3,\n        frames: 1,\n        height: 1200,\n        planes: 1,\n        width: 1600,\n      },\n    },\n    {\n      name: \"cell-painting.png\",\n      description:\n        \"U2OS cells treated with an RNAi reagent (https://iwww.broadinstitute.org/rnai/db/clone/details?cloneId=TRCN0000195467) and stained for a \" +\n        \"cell-painting experiment (Merged; red: Actin, Golgi, and Plasma membrane stained via phalloidin and wheat germ agglutinin; \" +\n        \"blue: DNA stained via Hoechst; green: mitochondria stained via MitoTracker).\",\n      data: cellpainting,\n      project: (cellpaintingAnnotations as any).default,\n      shape: {\n        channels: 3,\n        frames: 1,\n        height: 512,\n        planes: 1,\n        width: 512,\n      },\n    },\n  ];\n\n  const onClick = ({\n    data,\n    description,\n    name,\n    shape,\n    project,\n  }: {\n    data: any;\n    description: string;\n    name: string;\n    project: any;\n    shape: ShapeType;\n  }) => {\n    onClose();\n\n    const example: ImageType = {\n      avatar: data as string,\n      id: v4(),\n      annotations: [],\n      name: name,\n      shape: shape,\n      originalSrc: data as string,\n      src: data as string,\n    };\n\n    dispatch(setImages({ images: [...images, example] }));\n\n    dispatch(\n      setActiveImage({\n        image: example.id,\n      })\n    );\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n\n    let channels: Array<ChannelType> = [];\n    for (let i = 0; i < shape.channels; i++) {\n      channels.push({ visible: true, range: [0, 255] });\n    }\n    dispatch(setChannels({ channels }));\n\n    dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n\n    const newAnnotations: Array<AnnotationType> = [];\n\n    let updatedCategories: Array<CategoryType> = categories_in;\n\n    project[0].annotations.forEach(\n      (serializedAnnotation: SerializedAnnotationType) => {\n        const { annotation_out, categories } = importSerializedAnnotations(\n          serializedAnnotation,\n          updatedCategories\n        );\n\n        updatedCategories = categories;\n\n        newAnnotations.push(annotation_out);\n      }\n    );\n\n    dispatch(\n      applicationSlice.actions.setImageInstances({ instances: newAnnotations })\n    );\n    dispatch(\n      applicationSlice.actions.setCategories({ categories: updatedCategories })\n    );\n  };\n\n  return (\n    <Dialog open={open} onClose={onClose}>\n      <List component=\"div\" role=\"list\">\n        {examples.map((example, index) => {\n          return (\n            <ListItem\n              button\n              divider\n              key={index}\n              role=\"listitem\"\n              onClick={() => onClick(example)}\n            >\n              <ListItemText\n                primary={example.name}\n                secondary={example.description}\n              />\n            </ListItem>\n          );\n        })}\n      </List>\n    </Dialog>\n  );\n};\n","import { useDialog } from \"../../../../hooks/useDialog\";\nimport { MenuItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { ExampleImageDialog } from \"../ExampleImageDialog\";\nimport React from \"react\";\n\ntype OpenExampleImageMenuItemProps = {\n  popupState: any;\n};\n\nexport const OpenExampleImageMenuItem = ({\n  popupState,\n}: OpenExampleImageMenuItemProps) => {\n  const { onClose, onOpen, open } = useDialog();\n\n  return (\n    <MenuItem onClick={onOpen}>\n      <ListItemText primary=\"Open example image\" />\n      <ExampleImageDialog\n        onClose={() => {\n          onClose();\n\n          popupState.close();\n        }}\n        open={open}\n      />\n    </MenuItem>\n  );\n};\n","import { Divider, Menu } from \"@material-ui/core\";\nimport { bindMenu } from \"material-ui-popup-state\";\nimport React from \"react\";\nimport { OpenImageMenuItem } from \"./OpenImageMenuItem\";\nimport { OpenProjectFileMenuItem } from \"./OpenProjectFileMenuItem\";\nimport { OpenExampleImageMenuItem } from \"./OpenExampleImageMenuItem\";\n\ntype OpenMenuProps = {\n  popupState: any;\n};\n\nexport const OpenMenu = ({ popupState }: OpenMenuProps) => {\n  return (\n    <Menu {...bindMenu(popupState)}>\n      <OpenImageMenuItem popupState={popupState} />\n\n      <OpenProjectFileMenuItem popupState={popupState} />\n\n      <Divider />\n\n      <OpenExampleImageMenuItem popupState={popupState} />\n    </Menu>\n  );\n};\n","import { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { Dialog, DialogTitle } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport DescriptionIcon from \"@material-ui/icons/Description\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport React from \"react\";\n\ntype HelpDialogProps = {\n  onClose: () => void;\n  open: boolean;\n  onOpenOpenImagesHelpDialog: () => void;\n  onOpenMakeAnnotationsHelpDialog: () => void;\n  onOpenManipulatingCanvasHelpDialog: () => void;\n  onOpenChangingAnnotationsHelpDialog: () => void;\n  onOpenSavingProjectHelpDialog: () => void;\n};\n\nexport const HelpDialog = ({\n  onClose,\n  open,\n  onOpenOpenImagesHelpDialog,\n  onOpenMakeAnnotationsHelpDialog,\n  onOpenManipulatingCanvasHelpDialog,\n  onOpenChangingAnnotationsHelpDialog,\n  onOpenSavingProjectHelpDialog,\n}: HelpDialogProps) => {\n  const t = useTranslation();\n\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      maxWidth=\"xs\"\n      onClose={onClose}\n      open={open}\n    >\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography style={{ flexGrow: 1 }} variant=\"h6\">\n            <DialogTitle>{t(\"Help\")}</DialogTitle>\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n\n      <List>\n        <ListItem button onClick={onOpenOpenImagesHelpDialog}>\n          <ListItemIcon>\n            <DescriptionIcon />\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Opening images\")} />\n        </ListItem>\n\n        <ListItem button onClick={onOpenManipulatingCanvasHelpDialog}>\n          <ListItemIcon>\n            <DescriptionIcon />\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Manipulating the canvas\")} />\n        </ListItem>\n\n        <ListItem button onClick={onOpenMakeAnnotationsHelpDialog}>\n          <ListItemIcon>\n            <DescriptionIcon />\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Making new annotations\")} />\n        </ListItem>\n\n        <ListItem button onClick={onOpenChangingAnnotationsHelpDialog}>\n          <ListItemIcon>\n            <DescriptionIcon />\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Changing existing annotations\")} />\n        </ListItem>\n\n        <ListItem button onClick={onOpenSavingProjectHelpDialog}>\n          <ListItemIcon>\n            <DescriptionIcon />\n          </ListItemIcon>\n\n          <ListItemText\n            primary={t(\"Saving project and exporting annotations\")}\n          />\n        </ListItem>\n      </List>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { Dialog, DialogContent, DialogTitle } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\n\ntype OpenImageHelpDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const OpenImageHelpDialog = ({\n  onClose,\n  open,\n}: OpenImageHelpDialogProps) => {\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      maxWidth=\"md\"\n      onClose={onClose}\n      open={open}\n    >\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography style={{ flexGrow: 1 }} variant=\"h6\">\n            <DialogTitle>{\"Opening images\"}</DialogTitle>\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <DialogContent>\n        <br />\n        <Typography variant={\"h6\"}>Opening images</Typography>\n        <Typography>\n          In the left menu, select \"Open new image\" to select one or multiple\n          image files to open.\n        </Typography>\n        <br />\n        <Typography>\n          Alternatively, drag and drop the desired image files directly onto the\n          canvas.\n        </Typography>\n        <br />\n        <Typography>\n          Note that we currently only support 1-channel (grayscale) or 3-channel\n          2D images. We do not support multi-dimensional images.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Deleting images</Typography>\n        <Typography>\n          Images can be deleted from the workspace at any time by selecting\n          \"Delete image\" on the menu options next to the image thumbnail.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Example pre-annotated images</Typography>\n        <Typography>\n          Take a look at our pre-annotated images by clicking \"Open example\n          image\" and selecting the image of choice!\n        </Typography>\n        <br />\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  kbd: {\n    backgroundColor: \"rgba(237, 242, 247, 1)\",\n    borderWidth: \"1px 1px 3px\",\n    borderRadius: \"6px\",\n    fontSize: \"0.8em\",\n    paddingInline: \"0.4em\",\n    whiteSpace: \"nowrap\",\n    fontWeight: 700,\n    borderColor: \"rgba(184, 186, 189, 1)\",\n    borderStyle: \"solid\",\n    color: \"rgba(45, 55, 72, 1)\",\n    width: \"fit-content\",\n    lineHeight: \"revert\",\n    marginLeft: \"5px\",\n    marginRight: \"5px\",\n  },\n  title: {\n    display: \"flex\",\n    alignItems: \"center\",\n  },\n}));\n","import { useStyles } from \"./HelpDialog.css\";\nimport React from \"react\";\n\ntype KeyboardKeyProps = {\n  letter: string;\n};\nexport const KeyboardKey = ({ letter }: KeyboardKeyProps) => {\n  const classes = useStyles();\n\n  return <div className={classes.kbd}>{letter}</div>;\n};\n","import { useStyles } from \"./HelpDialog.css\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { KeyboardKey } from \"./KeyboardKey\";\nimport React from \"react\";\n\ntype ToolTitleProps = {\n  toolName: string;\n  letter: string;\n};\nexport const HelpWindowToolTitle = ({ toolName, letter }: ToolTitleProps) => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.title}>\n      <Typography variant={\"h6\"}>{toolName}</Typography>\n      <Typography variant={\"h6\"} style={{ marginLeft: \"5px\" }}>\n        (\n      </Typography>\n      <KeyboardKey letter=\"shift\" />\n      <Typography>+</Typography>\n      <KeyboardKey letter={letter} />\n      <Typography variant={\"h6\"}>)</Typography>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Dialog, DialogContent, DialogTitle } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { HelpWindowToolTitle } from \"./HelpWindowToolTitle\";\nimport { KeyboardKey } from \"./KeyboardKey\";\n\ntype MakeAnnotationsHelpDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const MakeAnnotationsHelpDialog = ({\n  onClose,\n  open,\n}: MakeAnnotationsHelpDialogProps) => {\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      maxWidth=\"md\"\n      onClose={onClose}\n      open={open}\n    >\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography variant={\"h6\"}>\n            Creating new categories and editting categories\n          </Typography>\n          <Typography style={{ flexGrow: 1 }} variant=\"h6\">\n            <DialogTitle>{\"Making new annotations\"}</DialogTitle>\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <DialogContent>\n        <br />\n        <Typography>\n          Create a new category by clicking on the \"Create category\" button.\n          Once a category is created, its name and color can be changed by\n          selecting its options menu on the right on the category menu in the\n          left toobar.\n        </Typography>\n        <br />\n        <Typography>\n          All annotation tools are accessed from the toolbar to the right of the\n          canvas or by using their keyboard key shortcut.\n        </Typography>\n        <br />\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\n          <Typography>Once you an annotation is completed, press</Typography>\n          <KeyboardKey letter=\"enter\" />\n          <Typography>on your keyboard or click on \"confirm\".</Typography>\n        </div>\n        <br />\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\n          <Typography>To undo an unconfirmed annotation, press</Typography>\n          <KeyboardKey letter=\"escape\" />\n          <Typography>on your keyboard or click on \"cancel\".</Typography>\n        </div>\n        <br />\n        <HelpWindowToolTitle toolName={\"Rectangular annotation\"} letter={\"R\"} />\n        <Typography>\n          Click and drag to start drawing a rectangular annotation (bounding\n          box). Release to close the annotation.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Elliptical annotation\"} letter={\"E\"} />\n        <Typography>\n          Click and drag to start drawing an elliptical annotation. Release to\n          close the annotation.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Pen annotation\"} letter={\"D\"} />\n        <Typography>\n          Select desired brush size using the brush size slider. Draw over\n          pixels by clicking and dragging over the desired area. Release to\n          close the annotation.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Lasso annotation\"} letter={\"L\"} />\n        <Typography>\n          Click and drag cursor around the desired region. Release to\n          automatically close the lasso annotation.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Polygonal annotation\"} letter={\"P\"} />\n        <Typography>\n          Click and release to create new anchor points. Close the polygonal\n          annotation either by clicking on its origin point or by hitting enter\n          on your keyboard.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Magnetic annotation\"} letter={\"M\"} />\n        <Typography>\n          Click and release to create new anchor points. The tool will\n          automatically snap onto the edges of an object. Close the magnetic\n          annotation by clicking on its origin point.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Color annotation\"} letter={\"C\"} />\n        <Typography>\n          Click on a pixel with the color of interest, hold and drag outwards to\n          select a region of similar color intensities near the point. Release\n          to finish the annotation.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Quick annotation\"} letter={\"Q\"} />\n        <Typography>\n          Click and drag to select a region of superpixels. Release to finish\n          the annotation.\n        </Typography>\n        <br />\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { Dialog, DialogContent, DialogTitle } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { HelpWindowToolTitle } from \"./HelpWindowToolTitle\";\n\ntype ManipulateCanvasHelpDialogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const ManipulateCanvasHelpDialog = ({\n  onClose,\n  open,\n}: ManipulateCanvasHelpDialogProps) => {\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      maxWidth=\"md\"\n      onClose={onClose}\n      open={open}\n    >\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography style={{ flexGrow: 1 }} variant=\"h6\">\n            <DialogTitle>{\"Manipulating the canvas\"}</DialogTitle>\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <DialogContent>\n        <br />\n        <HelpWindowToolTitle toolName={\"Hand tool\"} letter={\"H\"} />\n        <Typography>\n          Select the Hand tool. Hold and drag to pan the image in the canvas.\n          Click on \"Reset position\" to center the image back onto the canvas.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Zoom tool\"} letter={\"Z\"} />\n        <Typography>\n          Select the Zoom tool. Use the zoom slider or your mouse wheel to zoom\n          in or out of the image.\n        </Typography>\n        <br />\n        <Typography>\n          To zoom in a particular region of the image, first unselect\n          \"Auto-center\" and then use your mouse to select the rectangular region\n          in which you would like to zoom in. Release the mouse to zoom in the\n          selected region.\n        </Typography>\n        <br />\n        <HelpWindowToolTitle toolName={\"Intensity adjustment\"} letter={\"I\"} />\n        <Typography>\n          Select the Intensity adjustment tool. Filter each color channel by\n          setting new minimum and maximum for each color channel. Untoggle a\n          channel box to disable the channel. Click on \"Reset\" to reset the\n          intensities to their original values.\n        </Typography>\n        <br />\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { Dialog, DialogContent, DialogTitle } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { KeyboardKey } from \"./KeyboardKey\";\nimport { HelpWindowToolTitle } from \"./HelpWindowToolTitle\";\n\ntype ChangingAnnotationsHelpDiagogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const ChangingAnnotationsHelpDialog = ({\n  onClose,\n  open,\n}: ChangingAnnotationsHelpDiagogProps) => {\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      maxWidth=\"md\"\n      onClose={onClose}\n      open={open}\n    >\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography style={{ flexGrow: 1 }} variant=\"h6\">\n            <DialogTitle>{\"Changing existing annotations\"}</DialogTitle>\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <DialogContent>\n        <br />\n        <HelpWindowToolTitle\n          toolName={\"Selecting annotations with the Select tool\"}\n          letter={\"S\"}\n        />\n        <Typography>\n          Select the Selection tool. Click on a desired annotation to select it,\n          and hold shift while clicking other annotations to select multiple\n          annotations. Alternatively, draw a rectangular box around multiple\n          annotations to select multiple annotations at once.\n        </Typography>\n        <br />\n        <Typography>\n          Click on \"Select all\" in the Selection tool menu to select all\n          existing annotations. To select/unselect annotations of a specific\n          category, toggle/untoggle the corresponding category in the Selection\n          tool menu.\n        </Typography>\n        <br />\n        <Typography>\n          In the case of overlapping annotations, repeatedly click on the\n          intersecting region of the overlapping annotations until the desired\n          annotation is selected.\n        </Typography>\n        <br />\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\n          <Typography>Press the</Typography>\n          <KeyboardKey letter=\"escape\" />\n          <Typography>\n            {\" \"}\n            key to undo changes or to unselect annotations.\n          </Typography>\n        </div>\n        <br />\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\n          <Typography>Press the</Typography>\n          <KeyboardKey letter=\"enter\" />\n          <Typography>\n            {\" \"}\n            key to confirm changes to a selected annotation.\n          </Typography>\n        </div>\n        <br />\n        <Typography variant={\"h6\"}>Resizing an annotation</Typography>\n        <Typography>\n          Once an annotation is selected, use the anchor points of the bouding\n          box to resize it.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Adding area to an annotation</Typography>\n        <Typography>\n          Select the annotation tool to use to add an area and select the \"add\n          area\" selection mode. Draw on the selected annotation with the\n          annotation tool to combine areas together.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>\n          Subtracting an area from an annotation\n        </Typography>\n        <Typography>\n          Select the annotation tool to use to subtract an area and select the\n          \"subtract area\" selection mode. Draw on the selected annotation with\n          the annotation tool to subtract an area from the selected annotation.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Intersection of two annotations</Typography>\n        <Typography>\n          Select the annotation tool to use to use for the intersection\n          operation and select the \"intersect\" selection mode. Draw on the\n          selected annotation with the annotation tool and release to obtain the\n          intersection of the two annotations.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>\n          Changing the category of an annotation\n        </Typography>\n        <Typography>\n          To change the category, first select the annotation(s) and click on\n          the desired category in the left toolbar. If the desired category does\n          not exist, click \"Create category\" to make a new category.\n        </Typography>\n        <br />\n        <div style={{ display: \"flex\", alignItems: \"center\" }}>\n          <Typography>Make sure to press the</Typography>\n          <KeyboardKey letter=\"enter\" />\n          <Typography>\n            {\" \"}\n            key to save the selected annotations with the new category assigned.\n          </Typography>\n        </div>\n        <br />\n        <Typography variant={\"h6\"}>Deleting selected annotations</Typography>\n        <Typography>\n          First, use the Select tool to select annotations. To delete one or\n          more selected annotations, press the Delete key or click on \"Clear\n          selected annotations\" in the left toolbar.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>\n          Deleting all annotations for a single image\n        </Typography>\n        <Typography>\n          To clear annotations of a particular image, click on the menu to the\n          right of the image thumbnail and select \"Clear annotations.\"\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Deleting all annotations</Typography>\n        <Typography>\n          Delete all annotations by clicking \"Clear all annotations\" in the left\n          toolbar. WARNING: This will delete all annotations across all images\n          loaded, not just the active image.\n        </Typography>\n        <br />\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import React from \"react\";\nimport { Dialog, DialogContent, DialogTitle } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\n\ntype SavingProjectHelpDiagogProps = {\n  onClose: () => void;\n  open: boolean;\n};\n\nexport const SavingProjectHelpDialog = ({\n  onClose,\n  open,\n}: SavingProjectHelpDiagogProps) => {\n  return (\n    <Dialog\n      disableBackdropClick={true}\n      fullWidth\n      maxWidth=\"md\"\n      onClose={onClose}\n      open={open}\n    >\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography style={{ flexGrow: 1 }} variant=\"h6\">\n            <DialogTitle>\n              {\"Saving project and exporting annotations\"}\n            </DialogTitle>\n          </Typography>\n\n          <IconButton onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <DialogContent>\n        <br />\n        <Typography variant={\"h6\"}>Saving a project</Typography>\n        <Typography>\n          Save all images and their annotations by clicking on \"Save project\n          file\" in the Save menu on the left toolbar. This will download a .json\n          file that encodes the image data and their annotations.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Opening a saved project</Typography>\n        <Typography>\n          To open a saved project and make new annotations or change\n          annotations, Click \"Open project file\" in the Open menu on the left\n          toolbar. Select the .json file that was downloaded when saving an\n          earlier project.\n        </Typography>\n        <br />\n        <Typography variant={\"h6\"}>Exporting all annotations</Typography>\n        <Typography>\n          It may be useful to export annotations as binary masks which can then\n          be provided to subsequent machine learning pipelines. To export the\n          annotations as binary png masks, click on \"Export annotations\" in the\n          Save menu of the left toolbar. This will download a zip file.\n          Unzipping the zip file will reveal one folder for each image in the\n          project. Each folder includes a folder for each category. These\n          folders, names by their category, include multiple png files: each\n          annotation file is the mask for an annotated object.\n        </Typography>\n        <Typography variant={\"h6\"}>Exporting all annotations</Typography>\n        <br />\n        <Typography>\n          To export annotations of a single image, click on the menu to the\n          right of the image thumbnail and select \"Export annotations.\" This\n          will export the annotation masks, organized by their category, for the\n          select image only.\n        </Typography>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import Drawer from \"@material-ui/core/Drawer\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport React, { useState } from \"react\";\nimport { CategoryType } from \"../../../../types/CategoryType\";\nimport {\n  categoryCountsSelector,\n  createdCategoriesSelector,\n  imageSelector,\n  selectedCategorySelector,\n  unknownCategorySelector,\n} from \"../../../../store/selectors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useStyles } from \"./CategoriesList.css\";\nimport { CollapsibleList } from \"../CollapsibleList\";\nimport { CategoryListItemCheckbox } from \"../CategoryListItemCheckbox\";\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\nimport { CategoryMenu } from \"../CategoryMenu\";\nimport { DeleteCategoryDialog } from \"../DeleteCategoryDialog\";\nimport { EditCategoryDialog } from \"../EditCategoryDialog\";\nimport { useDialog } from \"../../../../hooks\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { applicationSlice, setActiveImage } from \"../../../../store\";\nimport {\n  Chip,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Divider,\n  TextField,\n} from \"@material-ui/core\";\nimport List from \"@material-ui/core/List\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport FolderOpenIcon from \"@material-ui/icons/FolderOpen\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Button from \"@material-ui/core/Button\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Box from \"@material-ui/core/Box\";\nimport PopupState, { bindTrigger } from \"material-ui-popup-state\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport FeedbackIcon from \"@material-ui/icons/Feedback\";\nimport HelpIcon from \"@material-ui/icons/Help\";\nimport { SettingsDialog } from \"../../SettingsButton/SettingsDialog\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport DescriptionIcon from \"@material-ui/icons/Description\";\nimport { CreateCategoryDialog } from \"../CreateCategoryListItem/CreateCategoryDialog\";\nimport { selectedAnnotationsIdsSelector } from \"../../../../store/selectors/selectedAnnotationsIdsSelector\";\nimport { ImageType } from \"../../../../types/ImageType\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport { imagesSelector } from \"../../../../store/selectors/imagesSelector\";\nimport { ImageMenu } from \"../ImageMenu\";\nimport { DeleteAllAnnotationsDialog } from \"../DeleteAllAnnotationsDialog\";\nimport { SaveMenu } from \"../SaveMenu/SaveMenu\";\nimport { OpenMenu } from \"../OpenMenu/OpenMenu\";\nimport { HelpDialog } from \"../HelpDialog/HelpDialog\";\nimport { OpenImageHelpDialog } from \"../HelpDialog/OpenImageHelpDialog\";\nimport { MakeAnnotationsHelpDialog } from \"../HelpDialog/MakeAnnotationsHelpDialog\";\nimport { ManipulateCanvasHelpDialog } from \"../HelpDialog/ManipulateCanvasHelpDialog\";\nimport { ChangingAnnotationsHelpDialog } from \"../HelpDialog/ChangingAnnotationsHelpDialog\";\nimport { SavingProjectHelpDialog } from \"../HelpDialog/SavingProjectHelpDialog\";\n\nexport const CategoriesList = () => {\n  const classes = useStyles();\n\n  const createdCategories = useSelector(createdCategoriesSelector);\n  const selectedCategory = useSelector(selectedCategorySelector);\n  const unknownCategory = useSelector(unknownCategorySelector);\n\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n\n  const categoryCounts = useSelector(categoryCountsSelector);\n\n  const images = useSelector(imagesSelector);\n  const currentImage = useSelector(imageSelector);\n\n  const dispatch = useDispatch();\n\n  const {\n    onClose: onCloseDeleteCategoryDialog,\n    onOpen: onOpenDeleteCategoryDialog,\n    open: openDeleteCategoryDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseEditCategoryDialog,\n    onOpen: onOpenEditCategoryDialog,\n    open: openEditCategoryDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseDeleteAllAnnotationsDialog,\n    onOpen: onOpenDeleteAllAnnotationsDialog,\n    open: openDeleteAllAnnotationsDialog,\n  } = useDialog();\n\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const [imageAnchorEl, setImageAnchorEl] = React.useState<null | HTMLElement>(\n    null\n  );\n\n  const onCategoryClick = (\n    event: React.MouseEvent<HTMLDivElement>,\n    category: CategoryType\n  ) => {\n    dispatch(\n      applicationSlice.actions.setSelectedCategory({\n        selectedCategory: category.id,\n      })\n    );\n  };\n\n  const onCategoryMenuOpen = (\n    event: React.MouseEvent<HTMLButtonElement>,\n    category: CategoryType\n  ) => {\n    dispatch(\n      applicationSlice.actions.setSelectedCategory({\n        selectedCategory: category.id,\n      })\n    );\n    setAnchorEl(event.currentTarget);\n  };\n\n  const onCategoryMenuClose = () => {\n    setAnchorEl(null);\n  };\n\n  const onImageMenuOpen = (\n    event: React.MouseEvent<HTMLButtonElement>,\n    image: ImageType\n  ) => {\n    onImageItemClick(event, image);\n    setImageAnchorEl(event.currentTarget);\n  };\n\n  const onImageMenuClose = () => {\n    setImageAnchorEl(null);\n  };\n\n  const onClearAllAnnotations = () => {\n    const existingAnnotations = images\n      .map((image: ImageType) => {\n        return [...image.annotations];\n      })\n      .flat();\n    if (existingAnnotations.length) {\n      onOpenDeleteAllAnnotationsDialog();\n    }\n  };\n\n  const onClearSelectedAnnotations = () => {\n    if (!selectedAnnotationsIds) return;\n    selectedAnnotationsIds.forEach((id: string) => {\n      dispatch(applicationSlice.actions.deleteImageInstance({ id: id }));\n    });\n    dispatch(\n      applicationSlice.actions.setSelectedCategory({\n        selectedCategory: \"00000000-0000-0000-0000-000000000000\",\n      })\n    );\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  };\n\n  const onImageItemClick = (\n    evt: React.MouseEvent<HTMLDivElement | HTMLButtonElement, MouseEvent>,\n    image: ImageType\n  ) => {\n    dispatch(setActiveImage({ image: image.id }));\n\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  };\n\n  const t = useTranslation();\n\n  return (\n    <Drawer\n      anchor=\"left\"\n      className={classes.drawer}\n      classes={{ paper: classes.paper }}\n      open\n      variant=\"persistent\"\n    >\n      <Box\n        style={{ paddingTop: 60 }}\n        className={classes.toolbar}\n        display=\"flex\"\n        justifyContent=\"flex-end\"\n        px={8}\n      />\n\n      <AppBar className={classes.appBar} color=\"default\">\n        <Toolbar>\n          <Typography variant=\"h6\" color=\"inherit\">\n            Piximi Annotator\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <Divider />\n\n      <List dense>\n        <OpenListItem />\n        <SaveListItem />\n      </List>\n\n      <Divider />\n\n      <CollapsibleList closed dense primary={t(\"Images\")}>\n        {images.map((image: ImageType) => {\n          return (\n            <div key={image.id}>\n              <ListItem\n                button\n                id={image.id}\n                onClick={(evt: React.MouseEvent<HTMLDivElement, MouseEvent>) =>\n                  onImageItemClick(evt, image)\n                }\n                selected={image.id === currentImage?.id}\n              >\n                <ListItemAvatar>\n                  <Avatar\n                    alt={image.name}\n                    src={image.avatar}\n                    variant={\"square\"}\n                  />\n                </ListItemAvatar>\n                <ListItemText\n                  id={image.id}\n                  primary={image.name}\n                  primaryTypographyProps={{ noWrap: true }}\n                />\n                {image.annotations.length !== 0 && (\n                  <Chip label={image.annotations.length} size=\"small\" />\n                )}\n                <ListItemSecondaryAction>\n                  <IconButton\n                    edge=\"end\"\n                    onClick={(event) => onImageMenuOpen(event, image)}\n                  >\n                    <MoreHorizIcon />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n            </div>\n          );\n        })}\n        <ImageMenu\n          anchorElImageMenu={imageAnchorEl}\n          onCloseImageMenu={onImageMenuClose}\n          openImageMenu={Boolean(imageAnchorEl)}\n        />\n      </CollapsibleList>\n\n      <CollapsibleList closed dense primary={t(\"Categories\")}>\n        {createdCategories.map((category: CategoryType) => {\n          return (\n            <div key={category.id}>\n              <ListItem\n                button\n                id={category.id}\n                onClick={(event) => onCategoryClick(event, category)}\n                selected={category.id === selectedCategory.id}\n              >\n                <CategoryListItemCheckbox category={category} />\n\n                <ListItemText\n                  id={category.id}\n                  primary={category.name}\n                  primaryTypographyProps={{ noWrap: true }}\n                />\n                {categoryCounts[category.id] !== 0 && (\n                  <Chip label={categoryCounts[category.id]} size=\"small\" />\n                )}\n\n                <ListItemSecondaryAction>\n                  <IconButton\n                    edge=\"end\"\n                    onClick={(event) => onCategoryMenuOpen(event, category)}\n                  >\n                    <MoreHorizIcon />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n\n              <CategoryMenu\n                anchorElCategoryMenu={anchorEl}\n                onCloseCategoryMenu={onCategoryMenuClose}\n                onOpenCategoryMenu={(event) =>\n                  onCategoryMenuOpen(event, category)\n                }\n                onOpenDeleteCategoryDialog={onOpenDeleteCategoryDialog}\n                onOpenEditCategoryDialog={onOpenEditCategoryDialog}\n                openCategoryMenu={Boolean(anchorEl)}\n              />\n            </div>\n          );\n        })}\n        {unknownCategory && (\n          <div key={unknownCategory.id}>\n            <ListItem\n              button\n              id={unknownCategory.id}\n              onClick={(event) => onCategoryClick(event, unknownCategory)}\n              selected={unknownCategory.id === selectedCategory.id}\n            >\n              <CategoryListItemCheckbox category={unknownCategory} />\n\n              <ListItemText\n                id={unknownCategory.id}\n                primary={t(unknownCategory.name)}\n                primaryTypographyProps={{ noWrap: true }}\n              />\n              {categoryCounts[unknownCategory.id] !== 0 && (\n                <Chip label={categoryCounts[unknownCategory.id]} size=\"small\" />\n              )}\n              <ListItemSecondaryAction>\n                <IconButton\n                  edge=\"end\"\n                  onClick={(event) =>\n                    onCategoryMenuOpen(event, unknownCategory)\n                  }\n                >\n                  <MoreHorizIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            </ListItem>\n\n            <CategoryMenu\n              anchorElCategoryMenu={anchorEl}\n              onCloseCategoryMenu={onCategoryMenuClose}\n              onOpenCategoryMenu={(event) =>\n                onCategoryMenuOpen(event, unknownCategory)\n              }\n              onOpenDeleteCategoryDialog={onOpenDeleteCategoryDialog}\n              onOpenEditCategoryDialog={onOpenEditCategoryDialog}\n              openCategoryMenu={Boolean(anchorEl)}\n            />\n          </div>\n        )}\n\n        <DeleteCategoryDialog\n          onClose={onCloseDeleteCategoryDialog}\n          open={openDeleteCategoryDialog}\n        />\n\n        <EditCategoryDialog\n          onCloseDialog={onCloseEditCategoryDialog}\n          openDialog={openEditCategoryDialog}\n        />\n\n        <CreateCategoryListItem />\n      </CollapsibleList>\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onClearAllAnnotations}>\n          <ListItemIcon>\n            <DeleteIcon color=\"disabled\" />\n          </ListItemIcon>\n          <ListItemText primary={t(\"Clear all annotations\")} />\n        </ListItem>\n\n        <DeleteAllAnnotationsDialog\n          onClose={onCloseDeleteAllAnnotationsDialog}\n          open={openDeleteAllAnnotationsDialog}\n        />\n\n        <ListItem button onClick={onClearSelectedAnnotations}>\n          <ListItemIcon>\n            <DeleteIcon color=\"disabled\" />\n          </ListItemIcon>\n          <ListItemText primary={t(\"Clear selected annotations\")} />\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <List dense>\n        <SettingsListItem />\n        <HelpListItem />\n        <SendFeedbackListItem />\n      </List>\n    </Drawer>\n  );\n};\n\ntype SendFeedbackDialogProps = {\n  onClose: () => void;\n  open: boolean;\n  onSend: (text: string) => void;\n};\n\nconst CreateCategoryListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <AddIcon />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Create category\")} />\n      </ListItem>\n      <CreateCategoryDialog onClose={onClose} open={open} />\n    </React.Fragment>\n  );\n};\n\nconst HelpListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const {\n    onClose: onCloseOpenImagesHelpDialog,\n    onOpen: onOpenOpenImagesHelpDialog,\n    open: openOpenImagesHelpDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseManipulatingCanvasHelpDialog,\n    onOpen: onOpenManipulatingCanvasHelpDialog,\n    open: openManipulatingCanvasHelpDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseMakeAnnotationsHelpDialog,\n    onOpen: onOpenMakeAnnotationsHelpDialog,\n    open: openMakeAnnotationsHelpDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseChangingAnnotationsHelpDialog,\n    onOpen: onOpenChangingAnnotationsHelpDialog,\n    open: openChangingAnnotationsHelpDialog,\n  } = useDialog();\n\n  const {\n    onClose: onCloseSavingProjectHelpDialog,\n    onOpen: onOpenSavingProjectHelpDialog,\n    open: openSavingProjectHelpDialog,\n  } = useDialog();\n\n  return (\n    <React.Fragment>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <HelpIcon />\n        </ListItemIcon>\n\n        <ListItemText primary=\"Help\" />\n      </ListItem>\n\n      <HelpDialog\n        onClose={onClose}\n        open={open}\n        onOpenOpenImagesHelpDialog={onOpenOpenImagesHelpDialog}\n        onOpenMakeAnnotationsHelpDialog={onOpenMakeAnnotationsHelpDialog}\n        onOpenManipulatingCanvasHelpDialog={onOpenManipulatingCanvasHelpDialog}\n        onOpenChangingAnnotationsHelpDialog={\n          onOpenChangingAnnotationsHelpDialog\n        }\n        onOpenSavingProjectHelpDialog={onOpenSavingProjectHelpDialog}\n      />\n      <OpenImageHelpDialog\n        onClose={onCloseOpenImagesHelpDialog}\n        open={openOpenImagesHelpDialog}\n      />\n      <MakeAnnotationsHelpDialog\n        onClose={onCloseMakeAnnotationsHelpDialog}\n        open={openMakeAnnotationsHelpDialog}\n      />\n      <ManipulateCanvasHelpDialog\n        onClose={onCloseManipulatingCanvasHelpDialog}\n        open={openManipulatingCanvasHelpDialog}\n      />\n      <ChangingAnnotationsHelpDialog\n        onClose={onCloseChangingAnnotationsHelpDialog}\n        open={openChangingAnnotationsHelpDialog}\n      />\n      <SavingProjectHelpDialog\n        onClose={onCloseSavingProjectHelpDialog}\n        open={openSavingProjectHelpDialog}\n      />\n    </React.Fragment>\n  );\n};\n\nconst OpenListItem = () => {\n  return (\n    <PopupState variant=\"popover\">\n      {(popupState) => (\n        <React.Fragment>\n          <ListItem button {...bindTrigger(popupState)}>\n            <ListItemIcon>\n              <FolderOpenIcon />\n            </ListItemIcon>\n\n            <ListItemText primary=\"Open\" />\n          </ListItem>\n\n          <OpenMenu popupState={popupState} />\n        </React.Fragment>\n      )}\n    </PopupState>\n  );\n};\n\nconst SaveListItem = () => {\n  const t = useTranslation();\n\n  return (\n    <PopupState variant=\"popover\">\n      {(popupState) => (\n        <React.Fragment>\n          <ListItem button {...bindTrigger(popupState)}>\n            <ListItemIcon>\n              <SaveIcon />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Save\")} />\n          </ListItem>\n          <SaveMenu popupState={popupState} />\n        </React.Fragment>\n      )}\n    </PopupState>\n  );\n};\n\nconst SendFeedbackDialog = ({\n  onClose,\n  open,\n  onSend,\n}: SendFeedbackDialogProps) => {\n  const t = useTranslation();\n\n  const [input, setInput] = useState(\"\");\n\n  const send = () => {\n    onSend(input);\n    onClose();\n  };\n\n  return (\n    <Dialog onClose={onClose} open={open}>\n      <DialogTitle>{t(\"Send feedback\")}</DialogTitle>\n\n      <DialogContent>\n        <DialogContentText>\n          {t(\"Use this form to report issues with Piximi via our GitHub page\")}.\n        </DialogContentText>\n\n        <TextField\n          autoFocus\n          margin=\"dense\"\n          id=\"feedback\"\n          onChange={(e) => setInput(e.target.value)}\n          multiline\n          rows={12}\n          fullWidth\n          variant=\"filled\"\n        />\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cancel\n        </Button>\n\n        <Button onClick={send} color=\"primary\">\n          Send feedback\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst SendFeedbackListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const onSend = (text: string) => {\n    const url =\n      \"https://github.com/piximi/image-viewer/issues/new?title=Bug%20Report&labels=bug&body=\" +\n      encodeURIComponent(text);\n    window.open(url);\n  };\n\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <FeedbackIcon />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Send feedback\")} />\n      </ListItem>\n      <SendFeedbackDialog onClose={onClose} open={open} onSend={onSend} />\n    </React.Fragment>\n  );\n};\n\nconst SettingsListItem = () => {\n  const { onClose, onOpen, open } = useDialog();\n\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <ListItem button onClick={onOpen}>\n        <ListItemIcon>\n          <SettingsIcon />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Settings\")} />\n      </ListItem>\n      <SettingsDialog onClose={onClose} open={open} />\n    </React.Fragment>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\nimport texture from \"../../../../images/texture.png\";\n\nconst settingsWidth = 240;\nconst operationsWidth = 56;\n\nexport const useStyles = makeStyles((theme) => ({\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  root: {\n    display: \"flex\",\n  },\n  content: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.default,\n    padding: theme.spacing(3),\n    width: \"100%\",\n  },\n  options: {\n    width: settingsWidth,\n    flexShrink: 0,\n  },\n  settingsPaper: {\n    width: settingsWidth,\n    right: operationsWidth,\n    boxShadow: \"inset 0 0 16px #000000\",\n  },\n  toolbar: {\n    backgroundImage: `url(${texture})`,\n    ...theme.mixins.toolbar,\n  },\n  settingsToolbar: {\n    alignItems: \"center\",\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n  },\n  operations: {\n    flexShrink: 0,\n    whiteSpace: \"nowrap\",\n    width: operationsWidth,\n  },\n  operationsPaper: {\n    width: operationsWidth,\n  },\n  operationsToolbar: {\n    alignItems: \"center\",\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n  },\n  logo: {\n    flexGrow: 1,\n  },\n  applicationDrawer: {\n    flexShrink: 0,\n    width: theme.spacing(32),\n  },\n  applicationDrawerHeader: {\n    ...theme.mixins.toolbar,\n    alignItems: \"center\",\n    display: \"flex\",\n    paddingLeft: theme.spacing(3),\n  },\n  applicationDrawerPaper: {\n    zIndex: 0,\n    width: theme.spacing(32),\n  },\n}));\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"CheckboxChecked\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18,20 L6.00000002,20 C4.89500002,20 4.00000002,19.1050001 4.00000002,18 L4.00000002,6.00000002 C4.00000002,4.89500002 4.89500002,4.00000002 6.00000002,4.00000002 L18,4.00000002 C19.1050001,4.00000002 20,4.89500002 20,6.00000002 L20,18 C20,19.1050001 19.1050001,20 18,20 Z\",\n  stroke: \"#323232\",\n  strokeWidth: 1.5,\n  fill: \"#555555\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"polyline\", {\n  stroke: \"#E5E5E5\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  points: \"16.0000001 10 11 15.0000001 8.00000003 12.0000001\"\n})));\n\nfunction SvgCheckboxChecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"CheckboxChecked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCheckboxChecked);\nexport default __webpack_public_path__ + \"static/media/CheckboxChecked.6700c862.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"CheckboxUnchecked\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18,20 L6.00000002,20 C4.89500002,20 4.00000002,19.1050001 4.00000002,18 L4.00000002,6.00000002 C4.00000002,4.89500002 4.89500002,4.00000002 6.00000002,4.00000002 L18,4.00000002 C19.1050001,4.00000002 20,4.89500002 20,6.00000002 L20,18 C20,19.1050001 19.1050001,20 18,20 Z\",\n  stroke: \"#323232\",\n  strokeWidth: 1.5,\n  fill: \"#555555\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n})));\n\nfunction SvgCheckboxUnchecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"CheckboxUnchecked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCheckboxUnchecked);\nexport default __webpack_public_path__ + \"static/media/CheckboxUnchecked.1714692b.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Color-adjustment\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.25100003,21.5020001 C4.80400002,21.5020001 2.00000001,18.6980001 2.00000001,15.2510001 C2.00000001,11.804 4.80400002,9.00000004 8.25100003,9.00000004 C11.698,9.00000004 14.5020001,11.804 14.5020001,15.2510001 C14.5020001,18.6980001 11.698,21.5020001 8.25100003,21.5020001 Z\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15.7490001,21.5020001 C12.3020001,21.5020001 9.49800004,18.6980001 9.49800004,15.2510001 C9.49800004,11.804 12.3020001,9.00000004 15.7490001,9.00000004 C19.1960001,9.00000004 22.0000001,11.804 22.0000001,15.2510001 C22.0000001,18.6980001 19.1960001,21.5020001 15.7490001,21.5020001 Z\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12.0100001,15.0000001 C8.56300004,15.0000001 5.75900002,12.1960001 5.75900002,8.74900004 C5.75900002,5.30200002 8.56300004,2.49800001 12.0100001,2.49800001 C15.4570001,2.49800001 18.2610001,5.30200002 18.2610001,8.74900004 C18.2610001,12.1960001 15.4570001,15.0000001 12.0100001,15.0000001 Z\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n})));\n\nfunction SvgColorAdjustment(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Color adjustment\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgColorAdjustment);\nexport default __webpack_public_path__ + \"static/media/ColorAdjustment.b6d05bdf.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Color-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  transform: \"translate(2.000000, 2.000000)\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M5.25800002,14.4180001 L1.51600001,10.676 C0.689000003,9.84900004 0.689000003,8.50900004 1.51600001,7.68200003 L7.15000003,2.04800001 L13.8860001,8.78400004 L8.25200003,14.4180001 C7.42500003,15.2440001 6.08400003,15.2440001 5.25800002,14.4180001 Z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16.8830001,11.774 C16.8830001,11.774 14.7660001,14.0710001 14.7660001,15.4790001 C14.7660001,16.6430001 15.7190001,17.5960001 16.8830001,17.5960001 C18.0470001,17.5960001 19.0000001,16.6430001 19.0000001,15.4780001 C19.0000001,14.0710001 16.8830001,11.774 16.8830001,11.774 L16.8830001,11.774 Z\"\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 7.15000003,\n  y1: 2.05000001,\n  x2: 6.06000003,\n  y2: 0.940000004\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 13.8900001,\n  y1: 8.78000004,\n  x2: 0.930000004,\n  y2: 8.78000004\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 1.42000001,\n  y1: 19.4400001,\n  x2: 10,\n  y2: 19.4400001\n})), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgColorAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Color selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgColorAnnotation);\nexport default __webpack_public_path__ + \"static/media/ColorAnnotation.7f12326e.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Elliptical-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18.3640001,5.63604002 C21.8787201,9.15076004 21.8787201,14.8492401 18.3640001,18.3639401 C14.8492801,21.8786601 9.15080004,21.8786601 5.63610002,18.3639401 C2.12138001,14.8492201 2.12138001,9.15074004 5.63610002,5.63604002 C9.15082004,2.12132001 14.8493001,2.12132001 18.3640001,5.63604002\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgEllipticalAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Elliptical selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgEllipticalAnnotation);\nexport default __webpack_public_path__ + \"static/media/EllipticalAnnotation.18552cf6.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Hand\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.005000, -0.005000)\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.01 0 24.01 24.01 0 24.01\"\n}), /*#__PURE__*/React.createElement(\"g\", {\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  transform: \"translate(3.005000, 3.005000)\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0.876688223,7.82337055 C1.82416266,7.02907695 3.20659866,7.09971911 4.07146412,7.98533063 L5.53482321,9.47915396 L5.53482321,3.45217126 C5.53482321,1.10030408 7.78886826,-0.560648269 9.97210561,0.183678925 L14.6976765,1.79294189 C16.0750548,2.26159234 17.0039844,3.57967175 17.0039844,5.06143422 L17.0039844,12.1222047 C17.0039844,15.4044809 14.3992726,18.0664844 11.1876378,18.0664844 L8.44636831,18.0664844 C6.61379765,18.0664844 4.88912444,17.1843188 3.78991922,15.6853265 L0.478816396,11.165951 C-0.284895203,10.1218254 -0.109561856,8.64867779 0.876688223,7.82337055 L0.876688223,7.82337055 Z\"\n}))));\n\nfunction SvgHand(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Hand\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgHand);\nexport default __webpack_public_path__ + \"static/media/Hand.57521d91.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Lasso-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  id: \"Path\",\n  stroke: \"#BABABA\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18.9200215,5.20050274 C22.7422808,7.79423331 22.7422808,11.9995035 18.9200215,14.593244 C15.0977622,17.1869746 8.90062147,17.1869746 5.07841219,14.593244 C1.25615292,11.9995135 1.25615292,7.79424331 5.07841219,5.20050274 C8.90067146,2.60677217 15.0978122,2.60677217 18.9200215,5.20050274\",\n  strokeWidth: 1.49992515,\n  transform: \"translate(11.999217, 9.896873) rotate(-14.928464) translate(-11.999217, -9.896873) \"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M13.7110001,16.3150001 C9.54400004,17.4260001 4.30200002,16.4030001 4.30200002,12.9560001\",\n  strokeWidth: 1.5\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M10.048,14.1050001 C10.048,16.3230001 8.89900004,19.8510001 4.30200002,21.0000001\",\n  strokeWidth: 1.5\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M4.30200002,12.9560001 C4.30200002,9.50900004 10.048,9.50900004 10.048,14.1050001\",\n  strokeWidth: 1.5\n})), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgLassoAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Lasso selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLassoAnnotation);\nexport default __webpack_public_path__ + \"static/media/LassoAnnotation.c53651de.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Magnetic-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(2.995000, 2.995000)\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5\n}, /*#__PURE__*/React.createElement(\"line\", {\n  x1: 15.1525604,\n  y1: 13.35081,\n  x2: 11.8391804,\n  y2: 10.0364296,\n  id: \"Path\"\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 7.97357042,\n  y1: 6.17081958,\n  x2: 4.65919,\n  y2: 2.85743958,\n  id: \"Path\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.75389542,0.324384583 L10.505625,2.07611417 C10.9368635,2.50774241 10.9368635,3.20713676 10.505625,3.638765 L5.487535,8.65585458 C4.41981785,9.72359699 4.41981785,11.4547226 5.487535,12.522465 C6.55527738,13.5901821 8.28640301,13.5901821 9.35414542,12.522465 L14.371235,7.504375 C14.8028633,7.07313649 15.5022576,7.07313649 15.9338858,7.504375 L17.6856154,9.25610458 C17.8936381,9.46269483 18.0106252,9.74375249 18.0106252,10.0369298 C18.0106252,10.3301071 17.8936381,10.6111648 17.6856154,10.817755 L12.6675254,15.835845 C9.76959655,18.7328702 5.07208391,18.7328702 2.174155,15.835845 C-0.722870151,12.9379161 -0.722870151,8.24040345 2.174155,5.34247458 L7.192245,0.324384583 C7.39883524,0.116361933 7.6798929,-0.000625150988 7.97307021,-0.000625150988 C8.26624751,-0.000625150988 8.54730517,0.116361933 8.75389542,0.324384583 Z\",\n  id: \"Path\"\n})), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"-0.005 -0.005 24.005 -0.005 24.005 24.005 -0.005 24.005\"\n}));\n\nfunction SvgMagneticAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Magnetic selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgMagneticAnnotation);\nexport default __webpack_public_path__ + \"static/media/MagneticAnnotation.eaf31360.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Object-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  transform: \"translate(2.000000, 3.000000)\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  strokeWidth: 1.5\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16.1970001,12.9320001 L16.1970001,12.9320001 L18.1730001,14.9080001 C18.6090001,15.3440001 18.6090001,16.0520001 18.1730001,16.4880001 L16.9870001,17.6740001 C16.5510001,18.1100001 15.8430001,18.1100001 15.4070001,17.6740001 L13.4310001,15.6980001 L11.9420001,17.1870001 C11.6480001,17.4810001 11.1480001,17.3630001 11.0170001,16.9690001 L8.14500004,8.35200005 C7.99900004,7.91500005 8.41500004,7.50000004 8.85200005,7.64500004 L17.4690001,10.5170001 C17.8630001,10.6480001 17.9810001,11.1480001 17.6870001,11.4420001 L16.1970001,12.9320001\"\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 2.78000002,\n  y1: 7.93000005,\n  x2: 0.50000001,\n  y2: 7.93000005\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 4.44000003,\n  y1: 3.94000003,\n  x2: 2.82000002,\n  y2: 2.32000002\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 4.40000003,\n  y1: 11.9600001,\n  x2: 2.78000002,\n  y2: 13.5800001\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 8.43000004,\n  y1: 2.28000002,\n  x2: 8.43000004,\n  y2: 1.25000099e-8\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 12.4600001,\n  y1: 3.90000003,\n  x2: 14.0800001,\n  y2: 2.28000002\n})), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgObjectAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Object selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgObjectAnnotation);\nexport default __webpack_public_path__ + \"static/media/ObjectAnnotation.64bf20e5.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Pen-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  transform: \"translate(3.000000, 3.000000)\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M14.3500001,1.196 L6.31300003,8.22800003 C5.44200002,8.99000004 5.39800002,10.329 6.21600003,11.147 L7.36500003,12.2960001 C8.18300003,13.1140001 9.52300004,13.0690001 10.284,12.1990001 L17.3160001,4.16200002 C18.0450001,3.33000001 18.0030001,2.07500001 17.2210001,1.29200001 C16.4380001,0.509000002 15.1830001,0.468000002 14.3500001,1.196 Z\"\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 7.87000003,\n  y1: 6.87000003,\n  x2: 11.65,\n  y2: 10.65\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0.599000002,17.3230001 L4.30200002,17.3230001 C7.28700003,17.3230001 8.78200004,13.7140001 6.67100003,11.603 C5.11900002,10.051 2.48300001,10.622 1.71300001,12.6770001 L0.191000001,16.7350001 C0.0850000004,17.0200001 0.295000001,17.3230001 0.599000002,17.3230001 Z\"\n})), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgFreehandAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Pen selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFreehandAnnotation);\nexport default __webpack_public_path__ + \"static/media/FreehandAnnotation.ce15dd27.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Polygonal-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M10.922,3.63000002 L3.68100002,8.89100004 C3.03800001,9.35800004 2.77000001,10.185 3.01500001,10.941 L5.78100002,19.4540001 C6.02600003,20.2090001 6.73000003,20.7210001 7.52500003,20.7210001 L16.4760001,20.7210001 C17.2700001,20.7210001 17.9740001,20.2100001 18.2200001,19.4540001 L20.9860001,10.941 C21.2310001,10.186 20.9630001,9.35800004 20.3200001,8.89100004 L13.0780001,3.63000002 C12.4350001,3.16300001 11.565,3.16300001 10.922,3.63000002 L10.922,3.63000002 Z\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgPolygonalAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Polygonal selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgPolygonalAnnotation);\nexport default __webpack_public_path__ + \"static/media/PolygonalAnnotation.a42ec225.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Quick-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  transform: \"translate(3.000000, 3.000000)\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  strokeWidth: 1.5\n}, /*#__PURE__*/React.createElement(\"polyline\", {\n  points: \"2.54200002 13.2190001 0.225000013 15.5370001 1.58200002 17.1480001 4.22900003 17.1480001 5.36900003 16.0500001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.00300005,14.8300001 L7.29600004,15.5370001 C6.51500004,16.3180001 5.24900003,16.3180001 4.46800003,15.5370001 L3.05400003,14.1230001 C2.27300002,13.3420001 2.27300002,12.0760001 3.05400003,11.2950001 L3.76100003,10.5880001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M17.9940001,3.60700003 L14.9830001,0.596000015 C14.2380001,-0.148999988 13.0440001,-0.187999988 12.2520001,0.505000015 L3.95500003,7.76500004 C3.08400003,8.52700005 3.04000003,9.86600005 3.85800003,10.6840001 L7.90600005,14.7320001 C8.72400005,15.5500001 10.0640001,15.5050001 10.8250001,14.6350001 L18.0850001,6.33800004 C18.7780001,5.54600004 18.7380001,4.35200003 17.9940001,3.60700003 Z\"\n})), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgQuickAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Quick selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgQuickAnnotation);\nexport default __webpack_public_path__ + \"static/media/QuickAnnotation.92a60ac4.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Radio-checked\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18.3640001,18.3639401 C14.8492801,21.8786601 9.15080004,21.8786601 5.63610002,18.3639401 C2.12138001,14.8492201 2.12138001,9.15074004 5.63610002,5.63604002 C9.15082004,2.12132001 14.8493001,2.12132001 18.3640001,5.63604002 C21.8787201,9.15076004 21.8787201,14.8492401 18.3640001,18.3639401 Z\",\n  stroke: \"#323232\",\n  fill: \"#555555\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M14.8284001,14.8284201 C13.2663001,16.3905201 10.73364,16.3905201 9.17155004,14.8284201 C7.60945003,13.2663201 7.60945003,10.73366 9.17155004,9.17157004 C10.73365,7.60947003 13.2663101,7.60947003 14.8284001,9.17157004 C16.3905001,10.73367 16.3905001,13.2663301 14.8284001,14.8284201 Z\",\n  stroke: \"#B7B7B7\",\n  fill: \"#E5E5E5\"\n})));\n\nfunction SvgRadioChecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Radio checked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgRadioChecked);\nexport default __webpack_public_path__ + \"static/media/RadioChecked.247674a9.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Radio-unchecked\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\",\n  fill: \"#555555\",\n  stroke: \"#323232\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18.3640001,5.63604002 C21.8787201,9.15076004 21.8787201,14.8492401 18.3640001,18.3639401 C14.8492801,21.8786601 9.15080004,21.8786601 5.63610002,18.3639401 C2.12138001,14.8492201 2.12138001,9.15074004 5.63610002,5.63604002 C9.15082004,2.12132001 14.8493001,2.12132001 18.3640001,5.63604002\"\n})));\n\nfunction SvgRadioUnchecked(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Radio unchecked\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgRadioUnchecked);\nexport default __webpack_public_path__ + \"static/media/RadioUnchecked.d9a75d6a.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Rectangular-selection\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Group\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18.4170001,20.25 L5.58300002,20.25 C4.57000002,20.25 3.75000002,19.4290001 3.75000002,18.4170001 L3.75000002,5.58300002 C3.75000002,4.57000002 4.57100002,3.75000002 5.58300002,3.75000002 L18.4160001,3.75000002 C19.4290001,3.75000002 20.249001,4.57100002 20.249001,5.58300002 L20.249001,18.4160001 C20.25,19.4290001 19.4290001,20.25 18.4170001,20.25 Z\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n})));\n\nfunction SvgRectangularAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Rectangular selection\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgRectangularAnnotation);\nexport default __webpack_public_path__ + \"static/media/RectangularAnnotation.3cca93c1.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Pointer\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19.7110001,15.5010001 C20.1020001,15.8920001 20.1020001,16.5250001 19.7110001,16.9150001 L16.9160001,19.7100001 C16.5250001,20.1010001 15.8920001,20.1010001 15.5020001,19.7100001 L12.0000001,16.2080001 L9.90400004,18.3040001 C9.37800004,18.8300001 8.48300004,18.6180001 8.24800003,17.9130001 L4.04800002,5.31200002 C3.78700002,4.53100002 4.53100002,3.78700002 5.31300002,4.04800002 L17.9140001,8.24800003 C18.6190001,8.48300004 18.8310001,9.37800004 18.3050001,9.90400004 L16.2090001,11.999 L19.7110001,15.5010001 Z\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n})));\n\nfunction SvgSelection(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Pointer\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSelection);\nexport default __webpack_public_path__ + \"static/media/Selection.4e4701f2.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Zoom\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Path\",\n  transform: \"translate(-0.000000, -0.000000)\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  points: \"0 0 24.0000001 0 24.0000001 24.0000001 0 24.0000001\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M14.1931001,5.58187002 C16.5249201,7.91369003 16.5249201,11.69432 14.1931001,14.0261401 C11.86128,16.3579601 8.08065003,16.3579601 5.74883002,14.0261401 C3.41701001,11.69432 3.41701001,7.91369003 5.74883002,5.58187002 C8.08065003,3.25005001 11.86128,3.25005001 14.1931001,5.58187002\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 14.1500001,\n  y1: 14.0600001,\n  x2: 20.0000001,\n  y2: 19.9900001,\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n})));\n\nfunction SvgZoom(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Zoom\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgZoom);\nexport default __webpack_public_path__ + \"static/media/Zoom.58f47de7.svg\";\nexport { ForwardRef as ReactComponent };","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  tooltip: {\n    // backgroundColor: \"#f5f5f9\",\n    border: \"1px solid #dadde9\",\n    // color: \"rgba(0, 0, 0, 0.87)\",\n    // fontSize: theme.typography.pxToRem(12),\n    marginLeft: -100,\n    width: 300,\n  },\n}));\n","import React from \"react\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport { Box } from \"@material-ui/core\";\nimport { useStyles } from \"./AnnotationModeTooltip.css\";\n\ntype AnnotationModeTooltipProps = {\n  children: React.ReactElement;\n  content: React.ReactElement;\n};\n\nexport const AnnotationModeTooltip = ({\n  children,\n  content,\n}: AnnotationModeTooltipProps) => {\n  const classes = useStyles();\n\n  return (\n    <Tooltip title={<Box>{content}</Box>} placement=\"bottom\">\n      {children}\n    </Tooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype NewTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const NewTooltip = ({ children }: NewTooltipProps) => {\n  return (\n    <AnnotationModeTooltip content={<p>Create a new annotation.</p>}>\n      {children}\n    </AnnotationModeTooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype AddTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const AddTooltip = ({ children }: AddTooltipProps) => {\n  const content = (\n    <React.Fragment>\n      <p>\n        Adding to an annotation adds any new areas you annotate to an existing\n        annotation.\n      </p>\n    </React.Fragment>\n  );\n\n  return (\n    <AnnotationModeTooltip content={content}>{children}</AnnotationModeTooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype SubtractTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const SubtractTooltip = ({ children }: SubtractTooltipProps) => {\n  const content = (\n    <React.Fragment>\n      <p>\n        Subtracting an area removes the area you label from an existing\n        annotation.\n      </p>\n    </React.Fragment>\n  );\n\n  return (\n    <AnnotationModeTooltip content={content}>{children}</AnnotationModeTooltip>\n  );\n};\n","import React from \"react\";\nimport { AnnotationModeTooltip } from \"../AnnotationModeTooltip\";\n\ntype IntersectionTooltipProps = {\n  children: React.ReactElement;\n};\n\nexport const IntersectionTooltip = ({ children }: IntersectionTooltipProps) => {\n  return (\n    <AnnotationModeTooltip\n      content={\n        <p>\n          Constrain the boundary of the new annotation to the selected\n          annotation.\n        </p>\n      }\n    >\n      {children}\n    </AnnotationModeTooltip>\n  );\n};\n","import List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Radio from \"@material-ui/core/Radio\";\nimport React from \"react\";\nimport RadioGroup from \"@material-ui/core/RadioGroup\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectionModeSelector } from \"../../../../../store/selectors\";\nimport { applicationSlice } from \"../../../../../store\";\nimport { AnnotationModeType } from \"../../../../../types/AnnotationModeType\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { NewTooltip } from \"../NewTooltip\";\nimport { AddTooltip } from \"../AddTooltip\";\nimport { SubtractTooltip } from \"../SubtractTooltip\";\nimport { IntersectionTooltip } from \"../IntersectionTooltip\";\nimport { RadioCheckedIcon, RadioUncheckedIcon } from \"../../../../icons\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\n\nexport const AnnotationMode = () => {\n  const dispatch = useDispatch();\n\n  const annotationMode = useSelector(selectionModeSelector);\n\n  const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const payload = {\n      selectionMode: parseInt((event.target as HTMLInputElement).value),\n    };\n    dispatch(applicationSlice.actions.setSelectionMode(payload));\n  };\n\n  const onClickLabel = (event: any, mode: AnnotationModeType) => {\n    const payload = {\n      selectionMode: mode,\n    };\n    dispatch(applicationSlice.actions.setSelectionMode(payload));\n  };\n\n  const t = useTranslation();\n\n  return (\n    <RadioGroup\n      aria-label=\"annotation mode\"\n      name=\"annotation-mode\"\n      onChange={onChange}\n      value={annotationMode}\n    >\n      <List\n        component=\"nav\"\n        subheader={\n          <ListSubheader component=\"div\">{t(\"Annotation mode\")}</ListSubheader>\n        }\n      >\n        <NewTooltip>\n          <ListItem\n            button\n            dense\n            onClick={(event) => onClickLabel(event, AnnotationModeType.New)}\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.New}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"New annotation\")} />\n          </ListItem>\n        </NewTooltip>\n\n        <AddTooltip>\n          <ListItem\n            button\n            dense\n            onClick={(event) => onClickLabel(event, AnnotationModeType.Add)}\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.Add}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Add area\")} />\n          </ListItem>\n        </AddTooltip>\n\n        <SubtractTooltip>\n          <ListItem\n            button\n            dense\n            onClick={(event) =>\n              onClickLabel(event, AnnotationModeType.Subtract)\n            }\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.Subtract}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Subtract area\")} />\n          </ListItem>\n        </SubtractTooltip>\n\n        <IntersectionTooltip>\n          <ListItem\n            button\n            dense\n            onClick={(event) =>\n              onClickLabel(event, AnnotationModeType.Intersect)\n            }\n          >\n            <ListItemIcon>\n              <Radio\n                disableRipple\n                edge=\"start\"\n                icon={<RadioUncheckedIcon />}\n                checkedIcon={<RadioCheckedIcon />}\n                tabIndex={-1}\n                value={AnnotationModeType.Intersect}\n              />\n            </ListItemIcon>\n\n            <ListItemText primary={t(\"Intersection\")} />\n          </ListItem>\n        </IntersectionTooltip>\n      </List>\n    </RadioGroup>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  appBar: {\n    backgroundColor: \"rgba(0, 0, 0, 0)\",\n    borderBottom: \"1px solid rgba(0, 0, 0, 0.12)\",\n    boxShadow: \"none\",\n    position: \"absolute\",\n  },\n}));\n","import Box from \"@material-ui/core/Box\";\nimport React from \"react\";\nimport { Typography } from \"@material-ui/core\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport { useStyles } from \"./InformationBox.css\";\n\ntype InformationBoxProps = {\n  description: string;\n  name: string;\n};\n\nexport const InformationBox = ({ description, name }: InformationBoxProps) => {\n  const classes = useStyles();\n\n  return (\n    <AppBar className={classes.appBar} color=\"default\">\n      <Toolbar disableGutters={true}>\n        <Typography variant=\"h6\" color=\"inherit\">\n          &nbsp;\n        </Typography>\n        <Typography style={{ marginLeft: 12 }}>{name}</Typography>\n      </Toolbar>\n    </AppBar>\n  );\n};\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Invert\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"InvertAnnotation\"\n}, /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  points: \"0 0 24 0 24 24 0 24\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15,21 L4,21 C3.448,21 3,20.552 3,20 L3,9 C3,8.448 3.448,8 4,8 L15,8 C15.552,8 16,8.448 16,9 L16,20 C16,20.552 15.552,21 15,21 Z\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M21,5 L21,4 C21,3.448 20.552,3 20,3 L19,3\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M21,15 L21,16 C21,16.552 20.552,17 20,17 L19,17\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M7,5 L7,4 C7,3.448 7.448,3 8,3 L9,3\",\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"line\", {\n  x1: 13,\n  y1: 3,\n  x2: 15,\n  y2: 3,\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n}), /*#__PURE__*/React.createElement(\"polygon\", {\n  id: \"Path\",\n  stroke: \"#BABABA\",\n  strokeWidth: 1.5,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  points: \"21 11 21 9 21 9 21 9\"\n})));\n\nfunction SvgInvertAnnotation(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"24px\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"Invert\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgInvertAnnotation);\nexport default __webpack_public_path__ + \"static/media/InvertAnnotation.ec8719eb.svg\";\nexport { ForwardRef as ReactComponent };","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { invertModeSelector } from \"../../../../store/selectors\";\nimport { applicationSlice } from \"../../../../store/slices\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\nimport { ReactComponent as InvertSelectionIcon } from \"../../../icons/InvertAnnotation.svg\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\n\nexport const InvertAnnotation = () => {\n  const dispatch = useDispatch();\n\n  const invertMode = useSelector(invertModeSelector);\n\n  const onInvertClick = () => {\n    dispatch(\n      applicationSlice.actions.setInvertMode({ invertMode: !invertMode })\n    );\n  };\n\n  const t = useTranslation();\n\n  return (\n    <List>\n      <ListItem button onClick={onInvertClick} dense>\n        <ListItemIcon>\n          <SvgIcon>\n            <InvertSelectionIcon />\n          </SvgIcon>\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Invert annotation\")} />\n      </ListItem>\n    </List>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const RectangularAnnotationOptions = () => {\n  const t = useTranslation();\n  return (\n    <React.Fragment>\n      <InformationBox\n        description=\"Click and drag to create a rectangular annotation.\"\n        name={t(\"Rectangular annotation\")}\n      />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\n\nexport const EllipticalAnnotationOptions = () => {\n  const t = useTranslation();\n  return (\n    <React.Fragment>\n      <InformationBox\n        description=\"Click and drag to create an elliptical annotation.\"\n        name={t(\"Elliptical annotation\")}\n      />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Slider from \"@material-ui/core/Slider\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { penSelectionBrushSizeSelector } from \"../../../../store/selectors/penSelectionBrushSizeSelector\";\nimport { applicationSlice } from \"../../../../store\";\n\nexport const FreehandAnnotationOptions = () => {\n  const dispatch = useDispatch();\n\n  const penSelectionBrushSizeBrushSize = useSelector(\n    penSelectionBrushSizeSelector\n  );\n\n  const onChange = (event: any, changed: number | number[]) => {\n    const payload = { penSelectionBrushSize: changed as number };\n\n    dispatch(applicationSlice.actions.setPenSelectionBrushSize(payload));\n  };\n  const t = useTranslation();\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Freehand annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <List>\n        <ListItem dense>\n          <ListItemText\n            primary={\"Brush size\"}\n            secondary={\n              <Slider\n                aria-labelledby=\"pen-selection-brush-size\"\n                min={2}\n                onChange={onChange}\n                value={penSelectionBrushSizeBrushSize}\n              />\n            }\n          />\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <InvertAnnotation />\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const LassoAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Lasso annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const PolygonalAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Polygonal annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { SampleList } from \"../SampleList\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const MagneticAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Magnetic annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { SampleList } from \"../SampleList\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const ColorAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Color annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <InvertAnnotation />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React, { useState } from \"react\";\nimport { SampleList } from \"../SampleList\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { InvertAnnotation } from \"../InvertAnnotation\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Slider from \"@material-ui/core/Slider\";\nimport { quickSelectionBrushSizeSelector } from \"../../../../store/selectors/quickSelectionBrushSizeSelector\";\nimport { applicationSlice } from \"../../../../store/slices\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nexport const QuickAnnotationOptions = () => {\n  const t = useTranslation();\n\n  const quickSelectionBrushSize = useSelector(quickSelectionBrushSizeSelector);\n\n  const [brushSize, setBrushSize] = useState<number>(quickSelectionBrushSize);\n\n  const dispatch = useDispatch();\n\n  const onChange = (event: any, changed: number | number[]) => {\n    setBrushSize(changed as number);\n  };\n\n  const onChangeCommitted = (event: any, changed: number | number[]) => {\n    const payload = { quickSelectionBrushSize: changed as number };\n    dispatch(applicationSlice.actions.setQuickSelectionBrushSize(payload));\n  };\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Quick annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      <List>\n        <ListItem dense>\n          <ListItemText\n            primary={\"Brush size\"}\n            secondary={\n              <Slider\n                aria-labelledby=\"quick-selection-brush-size\"\n                min={2}\n                onChange={onChange}\n                onChangeCommitted={onChangeCommitted}\n                value={brushSize}\n              />\n            }\n          />\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <InvertAnnotation />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </React.Fragment>\n  );\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { SampleList } from \"../SampleList\";\nimport { AnnotationMode } from \"../AnnotationMode\";\nimport { InformationBox } from \"../InformationBox\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const ObjectAnnotationOptions = () => {\n  const t = useTranslation();\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Object annotation\")} />\n\n      <Divider />\n\n      <AnnotationMode />\n\n      <Divider />\n\n      {/*<Divider />*/}\n\n      {/*<SampleList />*/}\n    </React.Fragment>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const offsetSelector = ({ state }: { state: HistoryStateType }) => {\n  return state.present.offset;\n};\n","import Radio from \"@material-ui/core/Radio\";\nimport React from \"react\";\nimport { RadioGroup } from \"@material-ui/core\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ZoomModeType } from \"../../../../types/ZoomModeType\";\nimport {\n  setOffset,\n  setStageScale,\n  setZoomToolOptions,\n} from \"../../../../store\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport {\n  imageSelector,\n  stageScaleSelector,\n  stageWidthSelector,\n  zoomToolOptionsSelector,\n} from \"../../../../store/selectors\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport {\n  CheckboxCheckedIcon,\n  CheckboxUncheckedIcon,\n  RadioCheckedIcon,\n  RadioUncheckedIcon,\n} from \"../../../icons\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { InformationBox } from \"../InformationBox\";\nimport Slider from \"@material-ui/core/Slider\";\nimport Grid from \"@material-ui/core/Grid\";\nimport ZoomInIcon from \"@material-ui/icons/ZoomIn\";\nimport ZoomOutIcon from \"@material-ui/icons/ZoomOut\";\nimport { offsetSelector } from \"../../../../store/selectors/offsetSelector\";\n\nexport const ZoomOptions = () => {\n  const dispatch = useDispatch();\n\n  const options = useSelector(zoomToolOptionsSelector);\n\n  const stageWidth = useSelector(stageWidthSelector);\n\n  const t = useTranslation();\n\n  const scale = useSelector(stageScaleSelector);\n  const image = useSelector(imageSelector);\n  const offset = useSelector(offsetSelector);\n\n  const onAutomaticCenteringChange = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: !options.automaticCentering,\n      },\n    };\n\n    dispatch(setZoomToolOptions(payload));\n\n    const centerOffset = {\n      x:\n        offset.x !== 0\n          ? 0\n          : ((image && image.shape ? image.shape.width : 512) * scale) / 2 -\n            offset.x,\n      y:\n        offset.y !== 0\n          ? 0\n          : ((image && image.shape ? image.shape.height : 512) * scale) / 2 -\n            offset.y,\n    }; //FIXME hardcoded heights and widths before merging with master branch!;\n\n    dispatch(setOffset({ offset: centerOffset }));\n  };\n\n  const onToActualSizeClick = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: true,\n        toActualSize: !options.toActualSize,\n      },\n    };\n\n    dispatch(setZoomToolOptions(payload));\n    dispatch(setStageScale({ stageScale: 1 }));\n    dispatch(setOffset({ offset: { x: 0, y: 0 } }));\n  };\n\n  const onToFullSizeClick = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: true,\n        toFit: !options.toFit,\n      },\n    };\n\n    if (!image || !image.shape) return;\n\n    dispatch(setZoomToolOptions(payload));\n\n    dispatch(\n      setStageScale({\n        stageScale:\n          stageWidth / (image && image.shape ? image.shape.width : 512),\n      })\n    );\n    dispatch(setOffset({ offset: { x: 0, y: 0 } }));\n  };\n\n  const onToFitClick = () => {\n    const payload = {\n      options: {\n        ...options,\n        automaticCentering: true,\n        toFit: !options.toFit,\n      },\n    };\n\n    if (!image || !image.shape) return;\n\n    dispatch(setZoomToolOptions(payload));\n\n    dispatch(\n      setStageScale({\n        stageScale:\n          (0.95 * stageWidth) /\n          (image && image.shape ? image.shape.width : 512),\n      })\n    );\n    dispatch(setOffset({ offset: { x: 0, y: 0 } }));\n  };\n\n  const onModeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const value = parseInt((event.target as HTMLInputElement).value);\n\n    const payload = {\n      options: {\n        ...options,\n        mode: value as ZoomModeType,\n      },\n    };\n\n    dispatch(setZoomToolOptions(payload));\n  };\n\n  const onModeClick = (event: any, mode: ZoomModeType) => {\n    const payload = {\n      options: {\n        ...options,\n        mode: mode,\n      },\n    };\n\n    dispatch(setZoomToolOptions(payload));\n  };\n\n  const marks = [\n    {\n      value: 0.000625,\n      label: \"-1600%\",\n    },\n    {\n      value: 0.00125,\n      label: \"-800%\",\n    },\n    {\n      value: 0.0025,\n      label: \"-400%\",\n    },\n    {\n      value: 0.005,\n      label: \"-200%\",\n    },\n    {\n      value: 0.05,\n      label: \"-150%\",\n    },\n    {\n      value: 0.25,\n      label: \"-100%\",\n    },\n    {\n      value: 0.5,\n      label: \"50%\",\n    },\n    {\n      value: 1,\n      label: \"100%\",\n    },\n    {\n      value: 1.5,\n      label: \"150%\",\n    },\n    {\n      value: 2,\n      label: \"200%\",\n    },\n    {\n      value: 4,\n      label: \"400%\",\n    },\n    {\n      value: 8,\n      label: \"800%\",\n    },\n    {\n      value: 16,\n      label: \"1600%\",\n    },\n  ];\n\n  const valueLabelFormat = (value: number) => {\n    if (value < 0 || value >= marks.length) return;\n\n    return marks[value].label;\n  };\n\n  const onSliderChange = (value: number) => {\n    dispatch(setStageScale({ stageScale: value }));\n  };\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Zoom\")} />\n\n      <Divider />\n\n      <List\n        component=\"nav\"\n        subheader={\n          <ListSubheader component=\"div\">{t(\"Zoom scale\")}</ListSubheader>\n        }\n      >\n        <ListItem>\n          <Grid container spacing={2}>\n            <Grid item>\n              <ZoomOutIcon />\n            </Grid>\n            <Grid item xs>\n              <Slider\n                defaultValue={1}\n                onChange={(event: any, value: number | number[]) =>\n                  onSliderChange(value as number)\n                }\n                valueLabelDisplay=\"auto\"\n                value={scale}\n                min={0.01}\n                max={10}\n                step={0.01}\n              />\n            </Grid>\n            <Grid item>\n              <ZoomInIcon />\n            </Grid>\n          </Grid>\n        </ListItem>\n      </List>\n\n      <Divider />\n\n      <List dense>\n        <RadioGroup\n          defaultValue={ZoomModeType.In}\n          aria-label=\"annotation mode\"\n          name=\"annotation-mode\"\n          onChange={onModeChange}\n          value={options.mode}\n        >\n          <List\n            component=\"nav\"\n            subheader={\n              <ListSubheader component=\"div\">{t(\"Zoom mode\")}</ListSubheader>\n            }\n          >\n            <ListItem\n              button\n              dense\n              onClick={(event) => onModeClick(event, ZoomModeType.In)}\n            >\n              <ListItemIcon>\n                <Radio\n                  disableRipple\n                  edge=\"start\"\n                  icon={<RadioUncheckedIcon />}\n                  checkedIcon={<RadioCheckedIcon />}\n                  tabIndex={-1}\n                  value={ZoomModeType.In}\n                />\n              </ListItemIcon>\n\n              <ListItemText primary={t(\"Zoom in\")} />\n            </ListItem>\n\n            <ListItem\n              button\n              dense\n              onClick={(event) => onModeClick(event, ZoomModeType.Out)}\n            >\n              <ListItemIcon>\n                <Radio\n                  disableRipple\n                  edge=\"start\"\n                  icon={<RadioUncheckedIcon />}\n                  checkedIcon={<RadioCheckedIcon />}\n                  tabIndex={-1}\n                  value={ZoomModeType.Out}\n                />\n              </ListItemIcon>\n\n              <ListItemText primary={t(\"Zoom out\")} />\n            </ListItem>\n          </List>\n        </RadioGroup>\n      </List>\n\n      <Divider />\n\n      <ListItem button dense onClick={onAutomaticCenteringChange}>\n        <ListItemIcon>\n          <Checkbox\n            checked={options.automaticCentering}\n            disableRipple\n            edge=\"start\"\n            icon={<CheckboxUncheckedIcon />}\n            checkedIcon={<CheckboxCheckedIcon />}\n            tabIndex={-1}\n          />\n        </ListItemIcon>\n\n        <ListItemText primary={t(\"Automatically zoom towards the center\")} />\n      </ListItem>\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onToActualSizeClick}>\n          <ListItemText>{t(\"Actual size\")}</ListItemText>\n        </ListItem>\n\n        <ListItem button onClick={onToFullSizeClick}>\n          <ListItemText>{t(\"Full size\")}</ListItemText>\n        </ListItem>\n\n        <ListItem button onClick={onToFitClick}>\n          <ListItemText>{t(\"Fit to screen\")}</ListItemText>\n        </ListItem>\n      </List>\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport { InformationBox } from \"../InformationBox\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { useDispatch } from \"react-redux\";\nimport { applicationSlice } from \"../../../../store/slices\";\n\nexport const HandToolOptions = () => {\n  const t = useTranslation();\n\n  const dispatch = useDispatch();\n\n  const onResetClick = () => {\n    dispatch(\n      applicationSlice.actions.setStagePosition({\n        stagePosition: { x: 0, y: 0 },\n      })\n    );\n  };\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Hand tool\")} />\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onResetClick}>\n          <ListItemText>{t(\"Reset position\")}</ListItemText>\n        </ListItem>\n      </List>\n    </React.Fragment>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ChannelType } from \"../../types/ChannelType\";\n\nexport const channelsSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): Array<ChannelType> => {\n  return state.present.channels;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageShapeSelector = ({ state }: { state: HistoryStateType }) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.shape;\n};\n","import List from \"@material-ui/core/List\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { ListItem } from \"@material-ui/core\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport React, { useCallback } from \"react\";\nimport Slider from \"@material-ui/core/Slider\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport { CheckboxCheckedIcon, CheckboxUncheckedIcon } from \"../../../../icons\";\nimport { applicationSlice } from \"../../../../../store/slices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\nimport { ChannelType } from \"../../../../../types/ChannelType\";\nimport { debounce } from \"lodash\";\nimport { imageShapeSelector } from \"../../../../../store/selectors/imageShapeSelector\";\nimport { CollapsibleList } from \"../../../CategoriesList/CollapsibleList\";\n\ntype ColorAdjustmentSlidersProp = {\n  updateDisplayedValues: (values: Array<Array<number>>) => void;\n  displayedValues: Array<Array<number>>;\n};\n\nexport const ChannelsList = ({\n  displayedValues,\n  updateDisplayedValues,\n}: ColorAdjustmentSlidersProp) => {\n  const [open, setOpen] = React.useState(true);\n\n  const onClick = () => {\n    setOpen(!open);\n  };\n\n  const dispatch = useDispatch();\n\n  const channels = useSelector(channelsSelector);\n\n  const imageShape = useSelector(imageShapeSelector);\n\n  const visibleChannelsIndices = channels\n    .map((channel: ChannelType, idx) => channel.visible)\n    .reduce((c: Array<number>, v, i) => (v ? c.concat(i) : c), []);\n\n  const handleSliderChange = (\n    idx: number,\n    event: any,\n    newValue: number | number[]\n  ) => {\n    const copiedValues = [...displayedValues].map((range: Array<number>) => {\n      return [...range];\n    });\n    copiedValues[idx] = newValue as Array<number>;\n    updateDisplayedValues(copiedValues);\n    handler(copiedValues);\n  };\n\n  const updateIntensityRanges = (values: Array<Array<number>>) => {\n    const copiedValues = [...values].map((range: Array<number>) => {\n      return [...range];\n    });\n\n    const updatedChannels = channels.map(\n      (channel: ChannelType, index: number) => {\n        return { ...channel, range: copiedValues[index] };\n      }\n    );\n    dispatch(\n      applicationSlice.actions.setChannels({\n        channels: updatedChannels,\n      })\n    );\n  };\n\n  const handler = useCallback(debounce(updateIntensityRanges, 100), [channels]);\n\n  const onCheckboxChanged = (index: number) => () => {\n    const current = visibleChannelsIndices.indexOf(index);\n\n    const updated = [...visibleChannelsIndices];\n\n    const copiedChannels = [...channels];\n\n    if (current === -1) {\n      updated.push(index);\n      copiedChannels[index] = { ...copiedChannels[index], visible: true };\n    } else {\n      updated.splice(current, 1);\n      copiedChannels[index] = { ...copiedChannels[index], visible: false };\n    }\n    dispatch(\n      applicationSlice.actions.setChannels({\n        channels: copiedChannels,\n      })\n    );\n  };\n\n  const colorAdjustmentSlider = (\n    index: number,\n    name: string,\n    displayedValue: Array<number>\n  ) => {\n    return (\n      <ListItem dense key={index}>\n        <ListItemIcon>\n          <Checkbox\n            onClick={onCheckboxChanged(index)}\n            checked={visibleChannelsIndices.indexOf(index) !== -1}\n            disableRipple\n            edge=\"start\"\n            icon={<CheckboxUncheckedIcon />}\n            checkedIcon={<CheckboxCheckedIcon />}\n            tabIndex={-1}\n          />\n        </ListItemIcon>\n        <ListItemText primary={name} />\n        <Slider\n          key={index}\n          disabled={!(visibleChannelsIndices.indexOf(index) !== -1)} //TODO style slider when disabled mode\n          style={{ width: \"60%\" }}\n          value={displayedValue}\n          max={255}\n          onChange={(event, value: number | number[]) =>\n            handleSliderChange(index, event, value)\n          }\n          valueLabelDisplay=\"auto\"\n          aria-labelledby=\"range-slider\"\n        />\n      </ListItem>\n    );\n  };\n\n  const allSliders = (displayedValues: Array<Array<number>>) => {\n    if (!imageShape) return;\n    const sliders = [];\n\n    const names =\n      imageShape.channels === 1 ? [\"Grey\"] : [\"Red\", \"Green\", \"Blue\"];\n    for (let i = 0; i < imageShape.channels; i++) {\n      sliders.push(colorAdjustmentSlider(i, names[i], displayedValues[i]));\n    }\n    return sliders;\n  };\n\n  return (\n    <CollapsibleList closed dense primary=\"Channels\">\n      {allSliders(displayedValues)}\n    </CollapsibleList>\n  );\n};\n","import React, { useEffect, useLayoutEffect, useState } from \"react\";\nimport { InformationBox } from \"../../InformationBox\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { useTranslation } from \"../../../../../hooks/useTranslation\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { applicationSlice } from \"../../../../../store\";\nimport { imageOriginalSrcSelector } from \"../../../../../store/selectors\";\nimport { ChannelsList } from \"../ChannelsList\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\nimport { ChannelType } from \"../../../../../types/ChannelType\";\nimport { imageShapeSelector } from \"../../../../../store/selectors/imageShapeSelector\";\nimport { CollapsibleList } from \"../../../CategoriesList/CollapsibleList\";\nimport Slider from \"@material-ui/core/Slider\";\n\nconst LightnessListItem = ({ name }: { name: string }) => {\n  const t = useTranslation();\n\n  return (\n    <ListItem alignItems=\"flex-start\" dense>\n      <ListItemText\n        primary={t(name)}\n        secondary={\n          <Slider\n            defaultValue={0}\n            valueLabelDisplay=\"auto\"\n            step={1}\n            marks\n            min={-200}\n            max={200}\n          />\n        }\n      />\n    </ListItem>\n  );\n};\n\nconst LightnessList = () => {\n  const t = useTranslation();\n\n  return (\n    <CollapsibleList closed dense primary={t(\"Lightness\")}>\n      <LightnessListItem name=\"Exposure\" />\n      <LightnessListItem name=\"Highlights\" />\n      <LightnessListItem name=\"Shadows\" />\n      <LightnessListItem name=\"Brightness\" />\n      <LightnessListItem name=\"Contrast\" />\n      <LightnessListItem name=\"Black Point\" />\n    </CollapsibleList>\n  );\n};\n\nconst HueAndSaturationListItem = ({ name }: { name: string }) => {\n  const t = useTranslation();\n\n  return (\n    <ListItem alignItems=\"flex-start\" dense>\n      <ListItemText\n        primary={t(name)}\n        secondary={\n          <Slider\n            defaultValue={0}\n            valueLabelDisplay=\"auto\"\n            step={1}\n            marks\n            min={-200}\n            max={200}\n          />\n        }\n      />\n    </ListItem>\n  );\n};\n\nconst HueAndSaturationList = () => {\n  const t = useTranslation();\n\n  return (\n    <CollapsibleList closed dense primary={t(\"Hue & Saturation\")}>\n      <HueAndSaturationListItem name=\"Hue\" />\n      <HueAndSaturationListItem name=\"Saturation\" />\n      <HueAndSaturationListItem name=\"Vibrance\" />\n    </CollapsibleList>\n  );\n};\n\nexport function createIntensityFilter(channels: ChannelType[]) {\n  return function (imageData: { data: any }) {\n    let data = imageData.data;\n    const scaleIntensity = (channel: ChannelType, pixel: number) => {\n      if (!channel.visible) return 0;\n      if (pixel < channel.range[0]) return 0;\n      if (pixel >= channel.range[1]) return 255;\n      return (\n        255 *\n        ((pixel - channel.range[0]) / (channel.range[1] - channel.range[0]))\n      );\n    };\n\n    for (let i = 0; i < data.length; i += 4) {\n      // red\n      data[i] = scaleIntensity(channels[0], data[i]);\n      // green\n      data[i + 1] = scaleIntensity(channels[1], data[i + 1]);\n      // blue\n      data[i + 2] = scaleIntensity(channels[2], data[i + 2]);\n    }\n    return data;\n  };\n}\n\nexport const ColorAdjustmentOptions = () => {\n  const t = useTranslation();\n\n  const dispatch = useDispatch();\n\n  const originalSrc = useSelector(imageOriginalSrcSelector);\n\n  const imageShape = useSelector(imageShapeSelector);\n\n  const channels = useSelector(channelsSelector);\n\n  const [displayedValues, setDisplayedValues] = useState<Array<Array<number>>>(\n    channels.map((channel: ChannelType) => [...channel.range])\n  ); //we keep that state variable here and pass it to slider so that visible slider ranges can change accordingly\n\n  const generateDefaultChannels = (components: number) => {\n    const defaultChannels: Array<ChannelType> = []; //number of channels depends on whether image is greyscale or RGB\n    for (let i = 0; i < components; i++) {\n      defaultChannels.push({\n        range: [0, 255],\n        visible: true,\n      });\n    }\n    return defaultChannels;\n  };\n\n  useEffect(() => {\n    if (!originalSrc) return;\n\n    if (!imageShape) return;\n\n    setDisplayedValues(\n      channels.map((channel: ChannelType) => [...channel.range])\n    );\n  }, [originalSrc]);\n\n  const onResetChannelsClick = () => {\n    if (!imageShape) return;\n    const defaultChannels = generateDefaultChannels(imageShape.channels);\n    dispatch(\n      applicationSlice.actions.setChannels({\n        channels: defaultChannels,\n      })\n    );\n    setDisplayedValues(\n      defaultChannels.map((channel: ChannelType) => [...channel.range])\n    );\n  };\n\n  const updateDisplayedValues = (values: Array<Array<number>>) => {\n    setDisplayedValues(values);\n  };\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Color adjustment\")} />\n\n      <Divider />\n\n      <ChannelsList\n        displayedValues={displayedValues}\n        updateDisplayedValues={updateDisplayedValues}\n      />\n\n      <Divider />\n\n      <List dense>\n        <ListItem button onClick={onResetChannelsClick}>\n          <ListItemText>{t(\"Reset\")}</ListItemText>\n        </ListItem>\n      </List>\n    </React.Fragment>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\n\nexport const selectedAnnotationsSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): Array<AnnotationType> => {\n  return state.present.selectedAnnotations;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const unselectedAnnotationsSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): Array<AnnotationType> => {\n  if (!state.present.images.length) return [];\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return [];\n\n  const ids = state.present.selectedAnnotations.map(\n    (annotation: AnnotationType) => {\n      return annotation.id;\n    }\n  );\n\n  return image.annotations.filter((annotation: AnnotationType) => {\n    return !ids.includes(annotation.id);\n  });\n};\n","import Divider from \"@material-ui/core/Divider\";\nimport React from \"react\";\nimport { InformationBox } from \"../InformationBox\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\nimport { ReactComponent as InvertSelectionIcon } from \"../../../icons/InvertAnnotation.svg\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { applicationSlice } from \"../../../../store\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectedAnnotationsSelector } from \"../../../../store/selectors/selectedAnnotationsSelector\";\nimport { unselectedAnnotationsSelector } from \"../../../../store/selectors/unselectedAnnotationsSelector\";\nimport { CategoryType } from \"../../../../types/CategoryType\";\nimport { CollapsibleList } from \"../../CategoriesList/CollapsibleList\";\nimport { categoriesSelector } from \"../../../../store/selectors\";\nimport LabelIcon from \"@material-ui/icons/Label\";\n\nexport const PointerSelectionOptions = () => {\n  const t = useTranslation();\n\n  const dispatch = useDispatch();\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n  const categories = useSelector(categoriesSelector);\n\n  const onSelectAll = () => {\n    const allAnnotations = [...selectedAnnotations, ...unselectedAnnotations];\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: allAnnotations,\n        selectedAnnotation: allAnnotations[0],\n      })\n    );\n  };\n\n  const onSelectNone = () => {\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  };\n\n  const onSelectCategory = (\n    event:\n      | React.MouseEvent<HTMLLIElement>\n      | React.MouseEvent<HTMLAnchorElement>\n      | React.MouseEvent<HTMLDivElement>,\n    category: CategoryType\n  ) => {\n    const allAnnotations = [...selectedAnnotations, ...unselectedAnnotations];\n    const desiredAnnotations = allAnnotations.filter((annotation) => {\n      return annotation.categoryId === category.id;\n    });\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: desiredAnnotations,\n        selectedAnnotation: desiredAnnotations[0],\n      })\n    );\n  };\n\n  return (\n    <React.Fragment>\n      <InformationBox description=\"…\" name={t(\"Select annotations\")} />\n\n      <Divider />\n\n      <List>\n        <ListItem button onClick={onSelectAll} dense>\n          <ListItemIcon>\n            <SvgIcon>\n              <InvertSelectionIcon />\n            </SvgIcon>\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Select all\")} />\n        </ListItem>\n        <ListItem button onClick={onSelectNone} dense>\n          <ListItemIcon>\n            <SvgIcon>\n              <InvertSelectionIcon />\n            </SvgIcon>\n          </ListItemIcon>\n\n          <ListItemText primary={t(\"Select none\")} />\n        </ListItem>\n      </List>\n\n      <Divider />\n      <CollapsibleList closed dense primary={t(\"Select Category\")}>\n        {categories.map((category: CategoryType) => {\n          return (\n            <ListItem\n              button\n              id={category.id}\n              onClick={(event) => onSelectCategory(event, category)}\n            >\n              <ListItemIcon>\n                <LabelIcon style={{ color: category.color }} />\n              </ListItemIcon>\n              <ListItemText primary={category.name} />\n            </ListItem>\n          );\n        })}\n      </CollapsibleList>\n    </React.Fragment>\n  );\n};\n","import Drawer from \"@material-ui/core/Drawer\";\nimport React from \"react\";\nimport { useStyles } from \"./ToolOptions.css\";\nimport {\n  ColorAdjustmentIcon,\n  ColorSelectionIcon,\n  EllipticalSelectionIcon,\n  HandIcon,\n  LassoSelectionIcon,\n  MagneticSelectionIcon,\n  ObjectSelectionIcon,\n  PenSelectionIcon,\n  PolygonalSelectionIcon,\n  QuickSelectionIcon,\n  RectangularSelectionIcon,\n  ZoomIcon,\n} from \"../../../icons\";\nimport { ToolType } from \"../../../../types/ToolType\";\nimport { RectangularAnnotationOptions } from \"../RectangularAnnotationOptions\";\nimport { EllipticalAnnotationOptions } from \"../EllipticalAnnotationOptions\";\nimport { FreehandAnnotationOptions } from \"../FreehandAnnotationOptions\";\nimport { LassoAnnotationOptions } from \"../LassoAnnotationOptions\";\nimport { PolygonalAnnotationOptions } from \"../PolygonalAnnotationOptions\";\nimport { MagneticAnnotationOptions } from \"../MagneticAnnotationOptions\";\nimport { ColorAnnotationOptions } from \"../ColorAnnotationOptions\";\nimport { QuickAnnotationOptions } from \"../QuickAnnotationOptions\";\nimport { ObjectAnnotationOptions } from \"../ObjectAnnotationOptions\";\nimport { ZoomOptions } from \"../ZoomOptions\";\nimport { useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../../../store/selectors\";\nimport { useTranslation } from \"react-i18next\";\nimport { HandToolOptions } from \"../HandToolOptions/HandToolOptions\";\nimport Box from \"@material-ui/core/Box\";\nimport { ColorAdjustmentOptions } from \"../ColorAdjustmentOptions/ColorAdjustmentOptions/ColorAdjustmentOptions\";\nimport { PointerSelectionOptions } from \"../PointerSelectionOptions\";\n\nexport const ToolOptions = () => {\n  const classes = useStyles();\n\n  const { t } = useTranslation();\n\n  const activeOperation = useSelector(toolTypeSelector);\n\n  const operations = [\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <ColorAdjustmentIcon />,\n      method: ToolType.ColorAdjustment,\n      name: t(\"Color adjustment\"),\n      options: <ColorAdjustmentOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <RectangularSelectionIcon />,\n      method: ToolType.RectangularAnnotation,\n      name: \"Rectangular selection\",\n      options: <RectangularAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <EllipticalSelectionIcon />,\n      method: ToolType.EllipticalAnnotation,\n      name: \"Elliptical selection\",\n      options: <EllipticalAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <PenSelectionIcon />,\n      method: ToolType.PenAnnotation,\n      name: \"Pen selection\",\n      options: <FreehandAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <LassoSelectionIcon />,\n      method: ToolType.LassoAnnotation,\n      name: \"Lasso selection\",\n      options: <LassoAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <PolygonalSelectionIcon />,\n      method: ToolType.PolygonalAnnotation,\n      name: \"Polygonal selection\",\n      options: <PolygonalAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <MagneticSelectionIcon />,\n      method: ToolType.MagneticAnnotation,\n      name: \"Magnetic selection\",\n      options: <MagneticAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <ColorSelectionIcon />,\n      method: ToolType.ColorAnnotation,\n      name: \"Color selection\",\n      options: <ColorAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <QuickSelectionIcon />,\n      method: ToolType.QuickAnnotation,\n      name: \"Quick selection\",\n      options: <QuickAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <ObjectSelectionIcon />,\n      method: ToolType.ObjectAnnotation,\n      name: \"Object selection\",\n      options: <ObjectAnnotationOptions />,\n    },\n    {\n      description: \"Nam a facilisis velit, sit amet interdum ante. In sodales.\",\n      icon: <HandIcon />,\n      method: ToolType.Hand,\n      name: \"Hand\",\n      options: <HandToolOptions />,\n    },\n    {\n      description: \"Description of zoom here.\",\n      icon: <ZoomIcon />,\n      method: ToolType.Zoom,\n      name: \"Zoom\",\n      options: <ZoomOptions />,\n    },\n    {\n      description: \"Description of pointer here.\",\n      icon: <ObjectSelectionIcon />,\n      method: ToolType.Pointer,\n      name: \"Pointer\",\n      options: <PointerSelectionOptions />,\n    },\n  ];\n\n  return (\n    <Drawer\n      anchor=\"right\"\n      className={classes.options}\n      classes={{ paper: classes.settingsPaper }}\n      variant=\"permanent\"\n    >\n      <Box\n        style={{ paddingTop: 60 }}\n        className={classes.toolbar}\n        display=\"flex\"\n        justifyContent=\"flex-end\"\n        px={8}\n      />\n\n      {\n        operations[\n          operations.findIndex(\n            (operation) => operation.method === activeOperation\n          )\n        ].options\n      }\n    </Drawer>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nconst operationsWidth = 56;\n\nexport const useStyles = makeStyles((theme) => ({\n  card: {\n    width: 210,\n  },\n  cardContent: {\n    width: \"200px\",\n  },\n  cardHeader: {\n    position: \"absolute\",\n    width: \"100%\",\n  },\n  cardMedia: {\n    height: 230,\n  },\n  drawer: {\n    flexShrink: 0,\n    whiteSpace: \"nowrap\",\n    width: operationsWidth,\n  },\n  paper: {\n    width: operationsWidth,\n  },\n  toolbar: {\n    alignItems: \"center\",\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n  },\n  tooltip: {\n    backgroundColor: \"transparent\",\n    maxWidth: \"none\",\n  },\n}));\n","import Typography from \"@material-ui/core/Typography\";\nimport React from \"react\";\nimport { KeyboardKey } from \"../../CategoriesList/HelpDialog/KeyboardKey\";\nimport { useStyles } from \"../../CategoriesList/HelpDialog/HelpDialog.css\";\n\ntype ToolTitleProps = {\n  toolName: string;\n  letter: string;\n};\nexport const ToolBarToolTitle = ({ toolName, letter }: ToolTitleProps) => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.title}>\n      <Typography>{toolName}</Typography>\n      <Typography style={{ marginLeft: \"5px\" }}>(</Typography>\n      <KeyboardKey letter=\"shift\" />\n      <Typography>+</Typography>\n      <KeyboardKey letter={letter} />\n      <Typography>)</Typography>\n    </div>\n  );\n};\n","import ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport React, { ReactElement, useState } from \"react\";\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\nimport Typography from \"@material-ui/core/Typography\";\nimport {\n  Button,\n  Card,\n  CardActionArea,\n  CardActions,\n  CardContent,\n  CardHeader,\n  IconButton,\n} from \"@material-ui/core\";\nimport { useStyles } from \"./Tool.css\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport { Tooltip } from \"@material-ui/core\";\nimport { HelpWindowToolTitle } from \"../../CategoriesList/HelpDialog/HelpWindowToolTitle\";\nimport { ToolBarToolTitle } from \"./ToolBarToolTitle\";\n\ntype TooltipCardProps = {\n  name: string;\n  onClose: () => void;\n};\n\ntype ToolProps = {\n  children: React.ReactNode;\n  name: string;\n  onClick: () => void;\n  selected: boolean;\n};\n\nexport const TooltipCard = ({ name, onClose }: TooltipCardProps) => {\n  const classes = useStyles();\n\n  let description: string | ReactElement;\n\n  switch (name) {\n    case \"Pointer\":\n      description = (\n        <ToolBarToolTitle toolName={\"Select annotations\"} letter={\"S\"} />\n      );\n      break;\n    case \"Rectangular annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Rectangular annotation\"} letter={\"R\"} />\n      );\n      break;\n    case \"Elliptical annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Elliptical annotation\"} letter={\"E\"} />\n      );\n      break;\n    case \"Freehand annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Pen annotation\"} letter={\"D\"} />\n      );\n      break;\n    case \"Lasso annotation (L)\":\n      description = (\n        <ToolBarToolTitle toolName={\"Lasso annotation\"} letter={\"L\"} />\n      );\n      break;\n    case \"Polygonal annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Polygonal annotation\"} letter={\"P\"} />\n      );\n      break;\n    case \"Magnetic annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Magnetic annotation\"} letter={\"M\"} />\n      );\n      break;\n    case \"Color annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Color annotation\"} letter={\"C\"} />\n      );\n      break;\n    case \"Quick annotation\":\n      description = (\n        <ToolBarToolTitle toolName={\"Quick annotation\"} letter={\"Q\"} />\n      );\n      break;\n    case \"Object annotation\":\n      description =\n        \"Select a rectangular annotation around a desired object to automatically generate its boundaries.\";\n      break;\n    case \"Hand\":\n      description = <ToolBarToolTitle toolName={\"Hand tool\"} letter={\"H\"} />;\n      break;\n    case \"Zoom\":\n      description = <ToolBarToolTitle toolName={\"Zoom tool\"} letter={\"Z\"} />;\n      break;\n    case \"Color Adjustment\":\n      description = (\n        <ToolBarToolTitle toolName={\"Itensity adjustment\"} letter={\"I\"} />\n      );\n      break;\n    default:\n      description = \"\";\n  }\n\n  return (\n    <Card className={classes.card} raised variant=\"outlined\">\n      <CardActionArea>\n        <div>\n          {/*<CardHeader*/}\n          {/*  action={*/}\n          {/*    <IconButton onClick={onClose}>*/}\n          {/*      <CancelIcon />*/}\n          {/*    </IconButton>*/}\n          {/*  }*/}\n          {/*  className={classes.cardHeader}*/}\n          {/*/>*/}\n\n          {/*<CardMedia className={classes.cardMedia} image={image} />*/}\n        </div>\n\n        <CardContent>\n          {/*<Typography gutterBottom variant=\"h6\" component=\"h2\">*/}\n          {/*  {name}*/}\n          {/*</Typography>*/}\n\n          <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n            {description}\n          </Typography>\n        </CardContent>\n      </CardActionArea>\n\n      {/*<CardActions>*/}\n      {/*  <Button size=\"small\" color=\"primary\">*/}\n      {/*    Learn More*/}\n      {/*  </Button>*/}\n      {/*</CardActions>*/}\n    </Card>\n  );\n};\n\nexport const Tool = ({ children, name, onClick, selected }: ToolProps) => {\n  const classes = useStyles();\n\n  const [open, setOpen] = useState<boolean>(false);\n\n  const onClose = () => {\n    setOpen(false);\n  };\n\n  const onOpen = () => {\n    setOpen(true);\n  };\n\n  return (\n    <Tooltip\n      classes={{ tooltip: classes.tooltip }}\n      onClose={onClose}\n      onOpen={onOpen}\n      open={open}\n      placement=\"left\"\n      title={<TooltipCard name={name} onClose={onClose} />}\n      // title={\"test\"}\n    >\n      <ListItem button onClick={onClick} selected={selected}>\n        <ListItemIcon>\n          <SvgIcon fontSize=\"small\">{children}</SvgIcon>\n        </ListItemIcon>\n      </ListItem>\n    </Tooltip>\n    // <ListItem button onClick={onClick} selected={selected}>\n    //   <ListItemIcon>\n    //     <SvgIcon fontSize=\"small\">{children}</SvgIcon>\n    //   </ListItemIcon>\n    // </ListItem>\n  );\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nconst operationsWidth = 56;\n\nexport const useStyles = makeStyles((theme) => ({\n  drawer: {\n    flexShrink: 0,\n    whiteSpace: \"nowrap\",\n    width: operationsWidth,\n  },\n  paper: {\n    width: operationsWidth,\n  },\n  toolbar: {\n    alignItems: \"center\",\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n  },\n  child: {\n    position: \"absolute\",\n    top: \"50%\",\n    transform: \"translateY(-50%)\",\n  },\n}));\n","import Drawer from \"@material-ui/core/Drawer\";\nimport React from \"react\";\nimport { ToolType as OperationType } from \"../../../../types/ToolType\";\nimport { Tool } from \"../Tool\";\nimport { useStyles } from \"./Tools.css\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../../../store/selectors\";\nimport { applicationSlice } from \"../../../../store\";\nimport {\n  ColorAdjustmentIcon,\n  ColorSelectionIcon,\n  EllipticalSelectionIcon,\n  HandIcon,\n  LassoSelectionIcon,\n  MagneticSelectionIcon,\n  ObjectSelectionIcon,\n  PenSelectionIcon,\n  PolygonalSelectionIcon,\n  QuickSelectionIcon,\n  RectangularSelectionIcon,\n  SelectionIcon,\n  ZoomIcon,\n} from \"../../../icons\";\nimport { useTranslation } from \"../../../../hooks/useTranslation\";\n\nexport const Tools = () => {\n  const classes = useStyles();\n\n  const dispatch = useDispatch();\n\n  const activeOperation = useSelector(toolTypeSelector);\n\n  const t = useTranslation();\n\n  return (\n    <Drawer\n      anchor=\"right\"\n      className={classes.drawer}\n      classes={{ paper: classes.paper }}\n      variant=\"permanent\"\n    >\n      <br />\n      <Tool\n        name={t(\"Hand\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.Hand,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.Hand}\n      >\n        <HandIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Zoom\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.Zoom,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.Zoom}\n      >\n        <ZoomIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Color Adjustment\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.ColorAdjustment,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.ColorAdjustment}\n      >\n        <ColorAdjustmentIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Pointer\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.Pointer,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.Pointer}\n      >\n        <SelectionIcon />\n      </Tool>\n\n      <br />\n      <Tool\n        name={t(\"Rectangular annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.RectangularAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.RectangularAnnotation}\n      >\n        <RectangularSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Elliptical annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.EllipticalAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.EllipticalAnnotation}\n      >\n        <EllipticalSelectionIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Freehand annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.PenAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.PenAnnotation}\n      >\n        <PenSelectionIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Lasso annotation (L)\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.LassoAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.LassoAnnotation}\n      >\n        <LassoSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Polygonal annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.PolygonalAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.PolygonalAnnotation}\n      >\n        <PolygonalSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Magnetic annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.MagneticAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.MagneticAnnotation}\n      >\n        <MagneticSelectionIcon />\n      </Tool>\n\n      <br />\n\n      <Tool\n        name={t(\"Color annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.ColorAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.ColorAnnotation}\n      >\n        <ColorSelectionIcon />\n      </Tool>\n\n      <Tool\n        name={t(\"Quick annotation\")}\n        onClick={() => {\n          dispatch(\n            applicationSlice.actions.setOperation({\n              operation: OperationType.QuickAnnotation,\n            })\n          );\n        }}\n        selected={activeOperation === OperationType.QuickAnnotation}\n      >\n        <QuickSelectionIcon />\n      </Tool>\n\n      {/*<Tool*/}\n      {/*  name={t(\"Object annotation\")}*/}\n      {/*  onClick={() => {*/}\n      {/*    dispatch(*/}\n      {/*      applicationSlice.actions.setOperation({*/}\n      {/*        operation: OperationType.ObjectAnnotation,*/}\n      {/*      })*/}\n      {/*    );*/}\n      {/*  }}*/}\n      {/*  selected={activeOperation === OperationType.ObjectAnnotation}*/}\n      {/*>*/}\n      {/*  <ObjectSelectionIcon />*/}\n      {/*</Tool>*/}\n      <br />\n    </Drawer>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const scaledImageHeightSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  if (!state.present.images.length) return;\n\n  const image = state.present.images.filter((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  })[0];\n\n  if (!image) return;\n\n  return image.shape.height * state.present.stageScale;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport useImage from \"use-image\";\nimport Konva from \"konva\";\nimport { useSelector } from \"react-redux\";\nimport {\n  boundingClientRectSelector,\n  stageScaleSelector,\n} from \"../../../../../store/selectors\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\nimport { imageSrcSelector } from \"../../../../../store/selectors/imageSrcSelector\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\nimport { createIntensityFilter } from \"../../../ToolOptions/ColorAdjustmentOptions/ColorAdjustmentOptions/ColorAdjustmentOptions\";\nimport { ChannelType } from \"../../../../../types/ChannelType\";\nimport { isEqual } from \"lodash\";\n\nexport const Image = React.forwardRef<Konva.Image>((_, ref) => {\n  const src = useSelector(imageSrcSelector);\n\n  const width = useSelector(scaledImageWidthSelector);\n\n  const height = useSelector(scaledImageHeightSelector);\n\n  const [image] = useImage(src ? src : \"\", \"Anonymous\");\n\n  const [filters, setFilters] = useState<Array<any>>();\n\n  const channels = useSelector(channelsSelector);\n\n  const boundingClientRect = useSelector(boundingClientRectSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const normalizeFont = 1300;\n\n  useEffect(() => {\n    // @ts-ignore\n    if (!ref || !ref.current) return;\n    const defaultChannels: Array<ChannelType> = []; //number of channels depends on whether image is greyscale or RGB\n    for (let i = 0; i < channels.length; i++) {\n      defaultChannels.push({\n        range: [0, 255],\n        visible: true,\n      });\n    }\n    if (isEqual(channels, defaultChannels)) {\n      setFilters([]);\n      // @ts-ignore\n      ref?.current.clearCache();\n    } else {\n      const IntensityFilter = createIntensityFilter(channels);\n      setFilters([IntensityFilter]);\n      // @ts-ignore\n      ref?.current.cache();\n    }\n  }, [channels, stageScale]);\n\n  useEffect(() => {\n    // @ts-ignore\n    if (!ref || !ref.current) return;\n    setFilters([]);\n    // @ts-ignore\n    ref?.current.clearCache();\n  }, [image]);\n\n  if (!src) {\n    return (\n      <ReactKonva.Text\n        x={\n          boundingClientRect.x + (80 * boundingClientRect.width) / normalizeFont\n        } //center depending on window width\n        y={0.4 * boundingClientRect.height}\n        text={\n          'To start annotating, drag and drop an image onto the canvas or click on \"Open Image\".'\n        }\n        fill={\"white\"}\n        fontSize={(30 * boundingClientRect.width) / normalizeFont} //scale font depending on window width\n      />\n    );\n  }\n\n  return (\n    <ReactKonva.Image\n      height={height}\n      image={image}\n      ref={ref}\n      width={width}\n      filters={filters}\n    />\n  );\n});\n","import { EllipticalAnnotationTool } from \"../../../../../../image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype EllipticalSelectionProps = {\n  operator: EllipticalAnnotationTool;\n};\n\nexport const EllipticalSelection = ({ operator }: EllipticalSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.center || !operator.radius) return null;\n\n  const x = operator.center.x * stageScale;\n  const y = operator.center.y * stageScale;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Ellipse\n        dash={[4, 2]}\n        dashOffset={-dashOffset}\n        radiusX={operator.radius.x}\n        radiusY={operator.radius.y}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"black\"\n        strokeWidth={1 / stageScale}\n        x={x}\n        y={y}\n      />\n\n      <ReactKonva.Ellipse\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        radiusX={operator.radius.x}\n        radiusY={operator.radius.y}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"white\"\n        strokeWidth={1 / stageScale}\n        x={x}\n        y={y}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { LassoAnnotationTool } from \"../../../../../../image/Tool\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype LassoSelectionProps = {\n  operator: LassoAnnotationTool;\n};\n\nexport const LassoSelection = ({ operator }: LassoSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin) return <React.Fragment />;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Circle\n        fill=\"white\"\n        radius={3}\n        stroke=\"black\"\n        strokeWidth={1}\n        x={operator.origin.x * stageScale}\n        y={operator.origin.y * stageScale}\n      />\n\n      {operator.anchor && (\n        <ReactKonva.Circle\n          fill=\"black\"\n          radius={3}\n          stroke=\"white\"\n          strokeWidth={1}\n          x={operator.anchor.x * stageScale}\n          y={operator.anchor.y * stageScale}\n        />\n      )}\n\n      <ReactKonva.Line\n        points={operator.buffer}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"black\"\n        strokeWidth={1 / stageScale}\n      />\n\n      <ReactKonva.Line\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"white\"\n        points={operator.buffer}\n        strokeWidth={1 / stageScale}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { MagneticAnnotationTool } from \"../../../../../../image/Tool\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype MagneticSelectionProps = {\n  operator: MagneticAnnotationTool;\n};\n\nexport const MagneticSelection = ({ operator }: MagneticSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin) return <React.Fragment />;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Circle\n        fill=\"white\"\n        radius={3}\n        stroke=\"black\"\n        strokeWidth={1}\n        x={operator.origin.x * stageScale}\n        y={operator.origin.y * stageScale}\n      />\n\n      {operator.anchor && (\n        <ReactKonva.Circle\n          fill=\"black\"\n          radius={3}\n          stroke=\"white\"\n          strokeWidth={1}\n          x={operator.anchor.x * stageScale}\n          y={operator.anchor.y * stageScale}\n        />\n      )}\n\n      <ReactKonva.Line\n        points={operator.buffer}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"black\"\n        strokeWidth={1 / stageScale}\n      />\n\n      <ReactKonva.Line\n        dash={[4 / stageScale, 2 / stageScale]}\n        scale={{ x: stageScale, y: stageScale }}\n        dashOffset={-dashOffset}\n        stroke=\"white\"\n        points={operator.buffer}\n        strokeWidth={1 / stageScale}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import { ObjectAnnotationTool } from \"../../../../../../image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype ObjectSelectionProps = {\n  operator: ObjectAnnotationTool;\n};\n\nexport const ObjectSelection = ({ operator }: ObjectSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin || !operator.width || !operator.height) return null;\n\n  if (!operator.origin) return null;\n\n  const x = operator.origin.x * stageScale;\n  const y = operator.origin.y * stageScale;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Rect\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        scale={{ x: stageScale, y: stageScale }}\n        height={operator.height}\n        stroke=\"black\"\n        strokeWidth={1 / stageScale}\n        width={operator.width}\n        x={x}\n        y={y}\n      />\n\n      <ReactKonva.Rect\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        height={operator.height}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"white\"\n        strokeWidth={1 / stageScale}\n        width={operator.width}\n        x={x}\n        y={y}\n      />\n\n      <ReactKonva.Line\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"white\"\n        points={operator.points}\n        strokeWidth={1}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { PolygonalAnnotationTool } from \"../../../../../../image/Tool\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype PolygonalSelectionProps = {\n  operator: PolygonalAnnotationTool;\n};\n\nexport const PolygonalSelection = ({ operator }: PolygonalSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin) return <React.Fragment />;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Circle\n        fill=\"white\"\n        radius={3}\n        stroke=\"black\"\n        strokeWidth={1}\n        x={operator.origin.x * stageScale}\n        y={operator.origin.y * stageScale}\n      />\n\n      {operator.anchor && (\n        <ReactKonva.Circle\n          fill=\"black\"\n          radius={3}\n          stroke=\"white\"\n          strokeWidth={1}\n          x={operator.anchor.x * stageScale}\n          y={operator.anchor.y * stageScale}\n        />\n      )}\n\n      <ReactKonva.Line\n        points={operator.buffer}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"black\"\n        strokeWidth={1 / stageScale}\n      />\n\n      <ReactKonva.Line\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"white\"\n        points={operator.buffer}\n        strokeWidth={1 / stageScale}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import { RectangularAnnotationTool } from \"../../../../../../image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype RectangularSelectionProps = {\n  operator: RectangularAnnotationTool;\n};\n\nexport const RectangularSelection = ({\n  operator,\n}: RectangularSelectionProps) => {\n  const dashOffset = useMarchingAnts();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.origin || !operator.width || !operator.height) return null;\n\n  const x = operator.origin.x * stageScale;\n  const y = operator.origin.y * stageScale;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Rect\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        height={operator.height}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"black\"\n        strokeWidth={1 / stageScale}\n        width={operator.width}\n        x={x}\n        y={y}\n      />\n\n      <ReactKonva.Rect\n        dash={[4 / stageScale, 2 / stageScale]}\n        dashOffset={-dashOffset}\n        height={operator.height}\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"white\"\n        strokeWidth={1 / stageScale}\n        width={operator.width}\n        x={x}\n        y={y}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import { ColorAnnotationTool } from \"../../../../../../image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype ColorSelectionProps = {\n  operator: ColorAnnotationTool;\n};\n\nexport const ColorSelection = ({ operator }: ColorSelectionProps) => {\n  const [image, setImage] = useState<HTMLImageElement>();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  useEffect(() => {\n    const image = new Image();\n    image.src = operator.overlayData;\n    setImage(image);\n  }, [operator.overlayData]);\n\n  if (!operator.overlayData || !operator.offset) return null;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Image\n        image={image}\n        scale={{ x: stageScale, y: stageScale }}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import { QuickAnnotationTool } from \"../../../../../../image/Tool\";\nimport * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype QuickSelectionProps = {\n  operator: QuickAnnotationTool;\n};\n\nexport const QuickSelection = ({ operator }: QuickSelectionProps) => {\n  const [image, setImage] = useState<HTMLImageElement>();\n\n  useEffect(() => {\n    if (!operator.currentMask) return;\n\n    const image = new Image();\n    image.src = operator.currentMask.toDataURL(\"image/png\", {\n      useCanvas: true,\n    });\n    setImage(image);\n  }, [operator.currentMask, operator.lastSuperpixel]);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  if (!operator.currentMask) return null;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Image\n        image={image}\n        scale={{ x: stageScale, y: stageScale }}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { PenAnnotationTool } from \"../../../../../../image/Tool\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../../store/selectors\";\n\ntype PenSelectionProps = {\n  operator: PenAnnotationTool;\n};\n\nexport const PenSelection = ({ operator }: PenSelectionProps) => {\n  const stageScale = useSelector(stageScaleSelector);\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Line\n        points={operator.buffer}\n        lineJoin=\"round\"\n        lineCap=\"round\"\n        scale={{ x: stageScale, y: stageScale }}\n        stroke=\"red\"\n        strokeWidth={operator.brushSize * 2}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\nimport { zoomSelectionSelector } from \"../../../../../../store/selectors\";\n\nexport const ZoomSelection = ({}) => {\n  const dashOffset = useMarchingAnts();\n\n  const { dragging, minimum, maximum, selecting } = useSelector(\n    zoomSelectionSelector\n  );\n\n  if (!minimum || !maximum || !selecting || !dragging)\n    return <React.Fragment />;\n\n  return (\n    <React.Fragment>\n      <ReactKonva.Rect\n        dash={[4, 2]}\n        dashOffset={-dashOffset}\n        height={maximum.y - minimum.y}\n        stroke=\"black\"\n        strokeWidth={1}\n        width={maximum.x - minimum.x}\n        x={minimum.x}\n        y={minimum.y}\n      />\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport {\n  ColorAnnotationTool,\n  EllipticalAnnotationTool,\n  LassoAnnotationTool,\n  MagneticAnnotationTool,\n  ObjectAnnotationTool,\n  PenAnnotationTool,\n  PolygonalAnnotationTool,\n  QuickAnnotationTool,\n  RectangularAnnotationTool,\n  Tool,\n} from \"../../../../../../image/Tool\";\nimport { EllipticalSelection } from \"../EllipticalSelection\";\nimport { ToolType } from \"../../../../../../types/ToolType\";\nimport { LassoSelection } from \"../LassoSelection\";\nimport { MagneticSelection } from \"../MagneticSelection\";\nimport { ObjectSelection } from \"../ObjectSelection\";\nimport { PolygonalSelection } from \"../PolygonalSelection\";\nimport { RectangularSelection } from \"../RectangularSelection\";\nimport { ColorSelection } from \"../ColorSelection/ColorSelection\";\nimport { QuickSelection } from \"../QuickSelection/QuickSelection\";\nimport { PenSelection } from \"../PenSelection\";\nimport { ZoomSelection } from \"../ZoomSelection\";\n\ntype SelectionProps = {\n  tool?: Tool;\n  toolType?: ToolType;\n};\n\nexport const Selection = ({ tool, toolType }: SelectionProps) => {\n  if (!toolType || !tool) return <React.Fragment />;\n\n  switch (toolType) {\n    case ToolType.ColorAnnotation:\n      return <ColorSelection operator={tool as ColorAnnotationTool} />;\n    case ToolType.EllipticalAnnotation:\n      return (\n        <EllipticalSelection operator={tool as EllipticalAnnotationTool} />\n      );\n    case ToolType.LassoAnnotation:\n      return <LassoSelection operator={tool as LassoAnnotationTool} />;\n    case ToolType.MagneticAnnotation:\n      return <MagneticSelection operator={tool as MagneticAnnotationTool} />;\n    case ToolType.ObjectAnnotation:\n      return <ObjectSelection operator={tool as ObjectAnnotationTool} />;\n    case ToolType.PenAnnotation:\n      return <PenSelection operator={tool as PenAnnotationTool} />;\n    case ToolType.PolygonalAnnotation:\n      return <PolygonalSelection operator={tool as PolygonalAnnotationTool} />;\n    case ToolType.RectangularAnnotation:\n      return (\n        <RectangularSelection operator={tool as RectangularAnnotationTool} />\n      );\n    case ToolType.Zoom:\n      return <ZoomSelection />;\n    case ToolType.QuickAnnotation:\n      return <QuickSelection operator={tool as QuickAnnotationTool} />;\n    default:\n      return <React.Fragment />;\n  }\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const annotatedSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): boolean => {\n  return state.present.annotated;\n};\n","import React from \"react\";\nimport { Selection } from \"../Selection\";\nimport { useSelector } from \"react-redux\";\nimport { annotatedSelector } from \"../../../../../store/selectors/annotatedSelector\";\nimport {\n  annotatingSelector,\n  toolTypeSelector,\n} from \"../../../../../store/selectors\";\nimport { Tool } from \"../../../../../image/Tool\";\nimport { ToolType } from \"../../../../../types/ToolType\";\n\ntype SelectingProps = {\n  tool: Tool;\n};\n\nexport const Selecting = ({ tool }: SelectingProps) => {\n  const annotated = useSelector(annotatedSelector);\n\n  const annotating = useSelector(annotatingSelector);\n\n  const toolType = useSelector(toolTypeSelector);\n\n  if ((annotated || !annotating) && toolType !== ToolType.QuickAnnotation)\n    return <React.Fragment />;\n\n  return (\n    <React.Fragment>\n      <Selection tool={tool} toolType={toolType} />\n    </React.Fragment>\n  );\n};\n","import * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  annotatingSelector,\n  stageScaleSelector,\n  toolTypeSelector,\n} from \"../../../../../store/selectors\";\nimport { useSelector } from \"react-redux\";\nimport { ToolType } from \"../../../../../types/ToolType\";\nimport { annotatedSelector } from \"../../../../../store/selectors/annotatedSelector\";\n\ntype ColorAnnotationToolTipProps = {\n  toolTipPosition?: { x: number; y: number };\n  initialPosition?: { x: number; y: number };\n  tolerance: number;\n};\n\nexport const ColorAnnotationToolTip = ({\n  toolTipPosition,\n  initialPosition,\n  tolerance,\n}: ColorAnnotationToolTipProps) => {\n  const [text, setText] = useState<string>(\"Tolerance: 0%\");\n  const toolType = useSelector(toolTypeSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const annotated = useSelector(annotatedSelector);\n  const annotating = useSelector(annotatingSelector);\n\n  useEffect(() => {\n    if (!toolTipPosition) return;\n    setText(`Tolerance: ${tolerance}`);\n  }, [toolTipPosition]);\n\n  if (toolType !== ToolType.ColorAnnotation) return <React.Fragment />;\n\n  if (!annotating || annotated || !toolTipPosition || !initialPosition) {\n    return <React.Fragment />;\n  }\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Line\n        points={[\n          toolTipPosition.x,\n          toolTipPosition.y!,\n          initialPosition.x,\n          initialPosition.y,\n        ]}\n        scale={{ x: stageScale, y: stageScale }}\n        strokeWidth={1}\n        stroke=\"white\"\n      />\n      <ReactKonva.Label\n        position={{\n          x: toolTipPosition.x * stageScale,\n          y: toolTipPosition.y * stageScale,\n        }}\n        opacity={0.75}\n      >\n        <ReactKonva.Tag fill={\"black\"} />\n        <ReactKonva.Text fill={\"white\"} fontSize={12} padding={5} text={text} />\n      </ReactKonva.Label>\n    </ReactKonva.Group>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/pop-up-on.b776a1ef.mp3\";","export default __webpack_public_path__ + \"static/media/pop-up-off.83c6ba5b.mp3\";","import React, { useEffect, useState } from \"react\";\nimport * as ReactKonva from \"react-konva\";\nimport { useSelector } from \"react-redux\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\nimport {\n  stageHeightSelector,\n  stageWidthSelector,\n  zoomToolOptionsSelector,\n} from \"../../../../../store/selectors\";\nimport { offsetSelector } from \"../../../../../store/selectors/offsetSelector\";\n\ntype LayerProps = {\n  children?: React.ReactNode;\n};\n\nexport const Layer = ({ children }: LayerProps) => {\n  const imageWidth = useSelector(scaledImageWidthSelector);\n  const imageHeight = useSelector(scaledImageHeightSelector);\n\n  const offset = useSelector(offsetSelector);\n\n  const { automaticCentering } = useSelector(zoomToolOptionsSelector);\n\n  const stageWidth = useSelector(stageWidthSelector);\n  const stageHeight = useSelector(stageHeightSelector);\n\n  const [position, setPosition] = useState<{ x: number; y: number }>({\n    x: 0,\n    y: 0,\n  });\n\n  useEffect(() => {\n    if (!imageWidth || !imageHeight) return;\n\n    if (automaticCentering) {\n      setPosition({\n        x: (stageWidth - imageWidth) / 2,\n        y: (stageHeight - imageHeight) / 2,\n      });\n    } else {\n      setPosition({ x: stageWidth / 2, y: stageHeight / 2 });\n    }\n  }, [automaticCentering, stageWidth, stageHeight, imageWidth, imageHeight]);\n\n  return (\n    <ReactKonva.Layer\n      imageSmoothingEnabled={false}\n      offset={offset}\n      position={position}\n    >\n      {children}\n    </ReactKonva.Layer>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\n\nexport const selectedAnnotationSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): AnnotationType | undefined => {\n  return state.present.selectedAnnotation;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageWidthSelector = ({ state }: { state: HistoryStateType }) => {\n  if (!state.present.images.length || !state.present.activeImageId) return;\n\n  const image = state.present.images.filter((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  })[0];\n\n  return image.shape.width;\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\nimport { ImageType } from \"../../types/ImageType\";\n\nexport const imageHeightSelector = ({ state }: { state: HistoryStateType }) => {\n  if (!state.present.images.length || !state.present.activeImageId) return;\n\n  const image = state.present.images.find((image: ImageType) => {\n    return image.id === state.present.activeImageId;\n  });\n\n  if (!image) return;\n\n  return image.shape.height;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React, { useRef, useState } from \"react\";\nimport * as _ from \"lodash\";\nimport { AnnotationType } from \"../../../../../types/AnnotationType\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { stageScaleSelector } from \"../../../../../store/selectors\";\nimport {\n  applicationSlice,\n  setSelectedAnnotations,\n} from \"../../../../../store/slices\";\nimport Konva from \"konva\";\nimport { selectedAnnotationSelector } from \"../../../../../store/selectors/selectedAnnotationSelector\";\nimport { decode, encode } from \"../../../../../image/rle\";\nimport * as ImageJS from \"image-js\";\nimport { selectedAnnotationsSelector } from \"../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { useCursor } from \"../../../../../hooks\";\nimport { AnnotationModeType } from \"../../../../../types/AnnotationModeType\";\nimport { unselectedAnnotationsSelector } from \"../../../../../store/selectors/unselectedAnnotationsSelector\";\nimport useSound from \"use-sound\";\nimport createAnnotationSoundEffect from \"../../../../../sounds/pop-up-on.mp3\";\nimport { soundEnabledSelector } from \"../../../../../store/selectors/soundEnabledSelector\";\nimport deleteAnnotationSoundEffect from \"../../../../../sounds/pop-up-off.mp3\";\nimport { imageWidthSelector } from \"../../../../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../../../../store/selectors/imageHeightSelector\";\n\ntype box = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  rotation: number;\n};\n\ntype TransformerProps = {\n  transformPosition: ({\n    x,\n    y,\n  }: {\n    x: number;\n    y: number;\n  }) => { x: number; y: number } | undefined;\n  annotationId: string;\n};\n\nexport const Transformer = ({\n  transformPosition,\n  annotationId,\n}: TransformerProps) => {\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  const transformerRef = useRef<Konva.Transformer | null>(null);\n\n  const dispatch = useDispatch();\n\n  const [boundBox, setBoundBox] = useState<box | null>(null);\n\n  const [startBox, setStartBox] = useState<box>({\n    x: 0,\n    y: 0,\n    height: 0,\n    width: 0,\n    rotation: 0,\n  });\n\n  const [center, setCenter] = useState<{ x: number; y: number } | undefined>();\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const cursor = useCursor();\n\n  const soundEnabled = useSelector(soundEnabledSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n  const imageHeight = useSelector(imageHeightSelector);\n\n  const [playCreateAnnotationSoundEffect] = useSound(\n    createAnnotationSoundEffect\n  );\n\n  const [playDeleteAnnotationSoundEffect] = useSound(\n    deleteAnnotationSoundEffect\n  );\n\n  const boundingBoxFunc = (oldBox: box, newBox: box) => {\n    if (!boundBox) {\n      setStartBox(oldBox);\n    }\n\n    const relativeNewBox = getRelativeBox(newBox);\n\n    if (!imageWidth || !imageHeight || !relativeNewBox)\n      return boundBox ? boundBox : startBox;\n\n    const minimumBoxArea = 5;\n\n    if (\n      relativeNewBox.width < minimumBoxArea ||\n      relativeNewBox.height < minimumBoxArea\n    )\n      return boundBox ? boundBox : oldBox;\n\n    if (\n      Math.floor(relativeNewBox.x + relativeNewBox.width) > imageWidth ||\n      Math.floor(relativeNewBox.y + relativeNewBox.height) > imageHeight ||\n      relativeNewBox.x < 0 ||\n      relativeNewBox.y < 0\n    ) {\n      return boundBox ? boundBox : oldBox;\n    }\n\n    setBoundBox(newBox);\n    return newBox;\n  };\n\n  /*\n   * Obtain box coordinates in image space\n   */\n  const getRelativeBox = (boundBox: box) => {\n    const relativePosition = transformPosition({\n      x: boundBox.x,\n      y: boundBox.y,\n    });\n    if (!relativePosition) return;\n    return {\n      x: relativePosition.x / stageScale,\n      y: relativePosition.y / stageScale,\n      height: boundBox.height / stageScale,\n      width: boundBox.width / stageScale,\n      rotation: 0,\n    };\n  };\n\n  const getScaledCoordinate = (\n    contour: Array<number>,\n    center: { x: number; y: number },\n    scale: { x: number; y: number }\n  ) => {\n    return _.flatten(\n      _.map(_.chunk(contour, 2), (el: Array<number>) => {\n        return [\n          Math.round(center.x + scale.x * (el[0] - center.x)),\n          Math.round(center.y + scale.y * (el[1] - center.y)),\n        ];\n      })\n    );\n  };\n\n  const onTransformEnd = () => {\n    if (!selectedAnnotation) return;\n\n    if (!boundBox || !startBox) return;\n\n    if (!imageWidth || !imageHeight) return;\n\n    const relativeBoundBox = getRelativeBox(boundBox);\n    const relativeStartBox = getRelativeBox(startBox);\n\n    if (!relativeBoundBox || !relativeStartBox || !center) return;\n\n    // get necessary parameters for transformation\n    const scaleX = relativeBoundBox.width / relativeStartBox.width;\n    const scaleY = relativeBoundBox.height / relativeStartBox.height;\n\n    //extract roi and resize\n    const mask = selectedAnnotation.mask;\n    const boundingBox = selectedAnnotation.boundingBox;\n\n    const roiWidth = boundingBox[2] - boundingBox[0];\n    const roiHeight = boundingBox[3] - boundingBox[1];\n    const roiX = boundingBox[0];\n    const roiY = boundingBox[1];\n\n    const decodedData = new Uint8Array(decode(mask));\n    const roi = new ImageJS.Image(roiWidth, roiHeight, decodedData, {\n      components: 1,\n      alpha: 0,\n    });\n\n    const resizedMaskROI = roi.resize({\n      height: Math.round(roiHeight * scaleY),\n      width: Math.round(roiWidth * scaleX),\n      preserveAspectRatio: false,\n    });\n\n    const scaledOffset = getScaledCoordinate([roiX, roiY], center, {\n      x: scaleX,\n      y: scaleY,\n    });\n\n    const resizedMask = encode(Uint8Array.from(resizedMaskROI.data));\n\n    const updatedAnnotation = {\n      ...selectedAnnotation,\n      boundingBox: [\n        scaledOffset[0],\n        scaledOffset[1],\n        scaledOffset[0] + resizedMaskROI.width,\n        scaledOffset[1] + resizedMaskROI.height,\n      ] as [number, number, number, number],\n      mask: resizedMask,\n    };\n\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n\n    updateSelectedAnnotation(updatedAnnotation);\n\n    setCenter(undefined);\n    setBoundBox(null);\n  };\n\n  const updateSelectedAnnotation = (updatedAnnotation: AnnotationType) => {\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [updatedAnnotation],\n        selectedAnnotation: updatedAnnotation,\n      })\n    );\n  };\n\n  const getOppositeAnchorPosition = () => {\n    if (!transformerRef || !transformerRef.current) return { x: 0, y: 0 };\n    const activeAnchor = transformerRef.current.getActiveAnchor();\n    switch (activeAnchor) {\n      case \"bottom-right\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"top-left\"))\n          .position();\n      }\n      case \"bottom-center\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"top-center\"))\n          .position();\n      }\n      case \"bottom-left\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"top-right\"))\n          .position();\n      }\n      case \"middle-left\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"middle-right\"))\n          .position();\n      }\n      case \"top-left\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"bottom-right\"))\n          .position();\n      }\n      case \"top-center\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"bottom-center\"))\n          .position();\n      }\n      case \"top-right\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"bottom-left\"))\n          .position();\n      }\n      case \"middle-right\": {\n        return transformerRef.current\n          .findOne(\".\".concat(\"middle-left\"))\n          .position();\n      }\n      default: {\n        return { x: 0, y: 0 };\n      }\n    }\n  };\n\n  const onTransform = () => {\n    if (!center) {\n      //at the beginning of transform, find out the \"center\" coordinate used for the resizing (i.e., the coordinate that does not move during resize)\n      const oppositeAnchorPosition = getOppositeAnchorPosition();\n      const scaledOppositeAnchorPosition = {\n        x: oppositeAnchorPosition.x / stageScale,\n        y: oppositeAnchorPosition.y / stageScale,\n      };\n\n      const relativeStartBox = getRelativeBox(startBox);\n\n      if (!relativeStartBox) return;\n\n      setCenter({\n        x: scaledOppositeAnchorPosition.x + relativeStartBox.x,\n        y: scaledOppositeAnchorPosition.y + relativeStartBox.y,\n      });\n    }\n  };\n\n  const onTransformStart = () => {\n    const selected = selectedAnnotations.find((annotation: AnnotationType) => {\n      return annotation.id === annotationId;\n    });\n\n    if (!selected) return;\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [selected],\n        selectedAnnotation: selected,\n      })\n    );\n  };\n\n  const onSaveAnnotationClick = (event: Konva.KonvaEventObject<MouseEvent>) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = cursor.cursor!;\n\n    dispatch(\n      applicationSlice.actions.setImageInstances({\n        instances: [...unselectedAnnotations, ...selectedAnnotations],\n      })\n    );\n\n    transformerRef.current!.detach();\n    transformerRef.current!.getLayer()?.batchDraw();\n    dispatch(applicationSlice.actions.setAnnotating({ annotating: false }));\n    dispatch(\n      applicationSlice.actions.setSelectionMode({\n        selectionMode: AnnotationModeType.New,\n      })\n    );\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n    if (soundEnabled) playCreateAnnotationSoundEffect();\n  };\n\n  const onClearAnnotationClick = (\n    event: Konva.KonvaEventObject<MouseEvent>\n  ) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = cursor.cursor!;\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n    if (soundEnabled) playDeleteAnnotationSoundEffect();\n  };\n\n  const onMouseEnter = (event: Konva.KonvaEventObject<MouseEvent>) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = \"pointer\";\n  };\n\n  const onMouseLeave = (event: Konva.KonvaEventObject<MouseEvent>) => {\n    const container = event.target.getStage()!.container();\n    container.style.cursor = cursor.cursor!;\n  };\n\n  let posX = 0;\n  let posY = 0;\n\n  if (selectedAnnotation && selectedAnnotations.length === 1) {\n    posX =\n      Math.max(\n        selectedAnnotation.boundingBox[0],\n        selectedAnnotation.boundingBox[2]\n      ) * stageScale;\n    posY =\n      Math.max(\n        selectedAnnotation.boundingBox[1],\n        selectedAnnotation.boundingBox[3]\n      ) * stageScale;\n  }\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Transformer\n        boundBoxFunc={boundingBoxFunc}\n        onTransform={onTransform}\n        onTransformEnd={onTransformEnd}\n        onTransformStart={onTransformStart}\n        id={\"tr-\".concat(annotationId)}\n        ref={transformerRef}\n        rotateEnabled={false}\n      />\n      {selectedAnnotation && selectedAnnotations.length === 1 && (\n        <ReactKonva.Group>\n          <ReactKonva.Label\n            position={{\n              x: posX - 58,\n              y: posY + 6,\n            }}\n            onClick={onSaveAnnotationClick}\n            id={\"label\"}\n            onMouseEnter={onMouseEnter}\n            onMouseLeave={onMouseLeave}\n          >\n            <ReactKonva.Tag\n              cornerRadius={3}\n              fill={\"darkgreen\"}\n              lineJoin={\"round\"}\n              shadowColor={\"black\"}\n              shadowBlur={10}\n              shadowOffset={{ x: 5, y: 5 }}\n            />\n            <ReactKonva.Text\n              fill={\"white\"}\n              fontSize={14}\n              padding={6}\n              text={\"Confirm\"}\n            />\n          </ReactKonva.Label>\n          <ReactKonva.Label\n            position={{\n              x: posX - 52,\n              y: posY + 35,\n            }}\n            onClick={onClearAnnotationClick}\n            id={\"label\"}\n            onMouseEnter={onMouseEnter}\n            onMouseLeave={onMouseLeave}\n          >\n            <ReactKonva.Tag\n              cornerRadius={3}\n              fill={\"darkred\"}\n              lineJoin={\"round\"}\n              shadowColor={\"black\"}\n              shadowBlur={10}\n              shadowOffset={{ x: 5, y: 5 }}\n            />\n            <ReactKonva.Text\n              fill={\"white\"}\n              fontSize={14}\n              padding={6}\n              text={\"Cancel\"}\n            />\n          </ReactKonva.Label>\n        </ReactKonva.Group>\n      )}\n    </ReactKonva.Group>\n  );\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectedAnnotationsIdsSelector } from \"../../../../../store/selectors/selectedAnnotationsIdsSelector\";\n\nimport { Transformer } from \"../Transformer/Transformer\";\n\ntype TransformersProps = {\n  transformPosition: ({\n    x,\n    y,\n  }: {\n    x: number;\n    y: number;\n  }) => { x: number; y: number } | undefined;\n};\n\nexport const Transformers = ({ transformPosition }: TransformersProps) => {\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n\n  if (!selectedAnnotationsIds) return <React.Fragment />;\n\n  return (\n    <>\n      {selectedAnnotationsIds.map((annotationId, idx) => {\n        return (\n          <React.Fragment key={annotationId}>\n            <Transformer\n              transformPosition={transformPosition}\n              annotationId={annotationId}\n            />\n          </React.Fragment>\n        );\n      })}\n    </>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const stagePositionSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): { x: number; y: number } => {\n  return state.present.stagePosition;\n};\n","import React from \"react\";\nimport { ToolType } from \"../../../../../types/ToolType\";\nimport * as ReactKonva from \"react-konva\";\nimport { useSelector } from \"react-redux\";\nimport { AnnotationTool } from \"../../../../../image/Tool/AnnotationTool/AnnotationTool\";\nimport { toolTypeSelector } from \"../../../../../store/selectors\";\nimport { penSelectionBrushSizeSelector } from \"../../../../../store/selectors/penSelectionBrushSizeSelector\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\n\ntype PenAnnotationToolTipProps = {\n  currentPosition?: { x: number; y: number };\n\n  annotationTool?: AnnotationTool;\n};\nexport const PenAnnotationToolTip = ({\n  annotationTool,\n  currentPosition,\n}: PenAnnotationToolTipProps) => {\n  const toolType = useSelector(toolTypeSelector);\n\n  const penSelectionBrushSize = useSelector(penSelectionBrushSizeSelector);\n\n  const imageWidth = useSelector(scaledImageWidthSelector);\n  const imageHeight = useSelector(scaledImageHeightSelector);\n\n  if (\n    !currentPosition ||\n    !annotationTool ||\n    annotationTool.annotating ||\n    toolType !== ToolType.PenAnnotation ||\n    !imageWidth ||\n    !imageHeight\n  )\n    return <React.Fragment />;\n\n  if (\n    currentPosition.x > imageWidth - penSelectionBrushSize ||\n    currentPosition.y > imageHeight - penSelectionBrushSize ||\n    currentPosition.x < 0 ||\n    currentPosition.y < 0\n  )\n    return <React.Fragment />;\n\n  return (\n    <ReactKonva.Ellipse\n      radiusX={penSelectionBrushSize}\n      radiusY={penSelectionBrushSize}\n      x={currentPosition.x}\n      y={currentPosition.y}\n      stroke=\"grey\"\n      strokewidth={1}\n      dash={[2, 2]}\n    />\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const visibleCategoriesSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.categories\n    .filter((category) => category.visible)\n    .map((category) => {\n      return category.id;\n    });\n};\n","export const toRGBA = (color: string, alpha: number) => {\n  const r = parseInt(color.slice(1, 3), 16);\n  const g = parseInt(color.slice(3, 5), 16);\n  const b = parseInt(color.slice(5, 7), 16);\n\n  return [r, g, b];\n  // return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n};\n","import React, { useEffect, useState } from \"react\";\nimport { CategoryType } from \"../../../../../../../types/CategoryType\";\nimport * as ReactKonva from \"react-konva\";\nimport * as _ from \"lodash\";\nimport { AnnotationType } from \"../../../../../../../types/AnnotationType\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  stageScaleSelector,\n} from \"../../../../../../../store/selectors\";\nimport { colorOverlayROI } from \"../../../../../../../image/imageHelper\";\nimport { imageWidthSelector } from \"../../../../../../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../../../../../../store/selectors/imageHeightSelector\";\nimport { toRGBA } from \"../../../../../../../image\";\n\ntype AnnotationProps = {\n  annotation: AnnotationType;\n};\n\nexport const Annotation = ({ annotation }: AnnotationProps) => {\n  const categories = useSelector(categoriesSelector);\n  const stageScale = useSelector(stageScaleSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n  const imageHeight = useSelector(imageHeightSelector);\n\n  const [imageMask, setImageMask] = useState<HTMLImageElement>();\n\n  const fill = _.find(\n    categories,\n    (category: CategoryType) => category.id === annotation.categoryId\n  )?.color;\n\n  useEffect(() => {\n    if (!annotation.mask || !imageWidth || !imageHeight) return;\n    if (!fill) return;\n    const boxWidth = annotation.boundingBox[2] - annotation.boundingBox[0];\n    const boxHeight = annotation.boundingBox[3] - annotation.boundingBox[1];\n    if (Math.round(boxWidth) <= 0 || Math.round(boxHeight) <= 0) return;\n    const color = toRGBA(fill, 0);\n    setImageMask(\n      colorOverlayROI(\n        annotation.mask,\n        annotation.boundingBox,\n        imageWidth,\n        imageHeight,\n        color\n      )\n    );\n  }, [annotation.mask, fill]);\n\n  if (!annotation) return <React.Fragment />;\n\n  return (\n    <ReactKonva.Group>\n      <ReactKonva.Image\n        id={annotation.id}\n        image={imageMask}\n        scale={{ x: stageScale, y: stageScale }}\n        x={annotation.boundingBox[0] * stageScale}\n        y={annotation.boundingBox[1] * stageScale}\n      />\n    </ReactKonva.Group>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { AnnotationType } from \"../../../../../../types/AnnotationType\";\nimport { useSelector } from \"react-redux\";\nimport { visibleCategoriesSelector } from \"../../../../../../store/selectors/visibleCategoriesSelector\";\nimport { Annotation } from \"./Annotation\";\nimport { imageInstancesSelector } from \"../../../../../../store/selectors\";\nimport { selectedAnnotationsSelector } from \"../../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { unselectedAnnotationsSelector } from \"../../../../../../store/selectors/unselectedAnnotationsSelector\";\n\nexport const ConfirmedAnnotations = () => {\n  const annotations = useSelector(imageInstancesSelector);\n\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  const visibleCategories = useSelector(visibleCategoriesSelector);\n\n  const [visibleAnnotations, setVisibleAnnotations] = useState<\n    Array<AnnotationType>\n  >([]);\n\n  useEffect(() => {\n    if (!annotations) return;\n\n    setVisibleAnnotations(\n      unselectedAnnotations.filter((annotation: AnnotationType) =>\n        visibleCategories.includes(annotation.categoryId)\n      )\n    );\n  }, [annotations, selectedAnnotations, visibleCategories]);\n\n  return (\n    <React.Fragment>\n      {visibleAnnotations.map((annotation: AnnotationType) => (\n        <Annotation annotation={annotation} key={annotation.id} />\n      ))}\n    </React.Fragment>\n  );\n};\n","import * as _ from \"lodash\";\nimport { CategoryType } from \"../../../../../../types/CategoryType\";\nimport * as ReactKonva from \"react-konva\";\nimport React, { useEffect, useState } from \"react\";\nimport { AnnotationType } from \"../../../../../../types/AnnotationType\";\nimport { useSelector } from \"react-redux\";\nimport {\n  categoriesSelector,\n  stageScaleSelector,\n} from \"../../../../../../store/selectors\";\nimport { imageWidthSelector } from \"../../../../../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../../../../../store/selectors/imageHeightSelector\";\nimport { toRGBA } from \"../../../../../../image\";\nimport { colorOverlayROI } from \"../../../../../../image/imageHelper\";\n\ntype AnnotationProps = {\n  annotation: AnnotationType;\n};\n\nexport const SelectedAnnotation = ({ annotation }: AnnotationProps) => {\n  const categories = useSelector(categoriesSelector);\n  const stageScale = useSelector(stageScaleSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n  const imageHeight = useSelector(imageHeightSelector);\n\n  const [imageMask, setImageMask] = useState<HTMLImageElement>();\n\n  const fill = _.find(\n    categories,\n    (category: CategoryType) => category.id === annotation.categoryId\n  )?.color;\n\n  useEffect(() => {\n    if (!annotation.mask || !imageWidth || !imageHeight) return;\n    if (!fill) return;\n    const color = toRGBA(fill, 0);\n    setImageMask(\n      colorOverlayROI(\n        annotation.mask,\n        annotation.boundingBox,\n        imageWidth,\n        imageHeight,\n        color\n      )\n    );\n  }, [annotation.mask, fill]);\n\n  return (\n    <React.Fragment>\n      <ReactKonva.Image\n        image={imageMask}\n        id={annotation.id}\n        scale={{ x: stageScale, y: stageScale }}\n        key={annotation.id}\n        x={annotation.boundingBox[0] * stageScale}\n        y={annotation.boundingBox[1] * stageScale}\n        width={annotation.boundingBox[2] - annotation.boundingBox[0]}\n        height={annotation.boundingBox[3] - annotation.boundingBox[1]}\n      />\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectedAnnotationSelector } from \"../../../../../../store/selectors/selectedAnnotationSelector\";\nimport { AnnotationType } from \"../../../../../../types/AnnotationType\";\nimport { selectedAnnotationsSelector } from \"../../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { SelectedAnnotation } from \"../SelectedAnnotation/SelectedAnnotation\";\n\nexport const SelectedAnnotations = () => {\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  if (!selectedAnnotations || !selectedAnnotation) return <React.Fragment />;\n\n  return (\n    <React.Fragment>\n      {selectedAnnotations.map((annotation: AnnotationType) => {\n        return (\n          <SelectedAnnotation key={annotation.id} annotation={annotation} />\n        );\n      })}\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport { ConfirmedAnnotations } from \"./ConfirmedAnnotations\";\nimport { SelectedAnnotations } from \"./SelectedAnnotations/SelectedAnnotations\";\n\nexport const Annotations = () => {\n  return (\n    <React.Fragment>\n      <SelectedAnnotations />\n      <ConfirmedAnnotations />\n    </React.Fragment>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const pointerSelectionSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}): {\n  dragging: boolean;\n  minimum: { x: number; y: number } | undefined;\n  maximum: { x: number; y: number } | undefined;\n  selecting: boolean;\n} => {\n  return state.present.pointerSelection;\n};\n","import * as ReactKonva from \"react-konva\";\nimport React from \"react\";\nimport { useMarchingAnts } from \"../../../../../../hooks\";\nimport { useSelector } from \"react-redux\";\n\nimport { pointerSelectionSelector } from \"../../../../../../store/selectors/pointerSelectionSelector\";\nimport { toolTypeSelector } from \"../../../../../../store/selectors\";\nimport { ToolType } from \"../../../../../../types/ToolType\";\n\nexport const PointerSelection = () => {\n  const dashOffset = useMarchingAnts();\n\n  const toolType = useSelector(toolTypeSelector);\n\n  const { dragging, minimum, maximum, selecting } = useSelector(\n    pointerSelectionSelector\n  );\n\n  if (!minimum || !maximum || !selecting || !dragging)\n    return <React.Fragment />;\n\n  if (toolType !== ToolType.Pointer) return <React.Fragment />;\n\n  return (\n    <React.Fragment>\n      <ReactKonva.Rect\n        dash={[4, 2]}\n        dashOffset={-dashOffset}\n        height={maximum.y - minimum.y}\n        stroke=\"white\"\n        strokeWidth={1}\n        width={maximum.x - minimum.x}\n        x={minimum.x}\n        y={minimum.y}\n      />\n    </React.Fragment>\n  );\n};\n","import { HistoryStateType } from \"../../types/HistoryStateType\";\n\nexport const currentIndexSelector = ({\n  state,\n}: {\n  state: HistoryStateType;\n}) => {\n  return state.present.currentIndex;\n};\n","import { ToolType } from \"../../types/ToolType\";\nimport {\n  getAnnotationsInBox,\n  getOverlappingAnnotations,\n} from \"../../image/imageHelper\";\nimport { AnnotationType } from \"../../types/AnnotationType\";\nimport {\n  applicationSlice,\n  setPointerSelection,\n  setSelectedAnnotations,\n  setSelectedCategory,\n} from \"../../store/slices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  imageInstancesSelector,\n  stageScaleSelector,\n  toolTypeSelector,\n} from \"../../store/selectors\";\nimport { selectedAnnotationsSelector } from \"../../store/selectors/selectedAnnotationsSelector\";\nimport { currentIndexSelector } from \"../../store/selectors/currentIndexSelector\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\nimport hotkeys from \"hotkeys-js\";\nimport { useState } from \"react\";\nimport { pointerSelectionSelector } from \"../../store/selectors/pointerSelectionSelector\";\nimport { selectedAnnotationsIdsSelector } from \"../../store/selectors/selectedAnnotationsIdsSelector\";\nimport { imageWidthSelector } from \"../../store/selectors/imageWidthSelector\";\nimport { imageHeightSelector } from \"../../store/selectors/imageHeightSelector\";\n\nexport const usePointer = () => {\n  const dispatch = useDispatch();\n\n  const delta = 10;\n\n  const toolType = useSelector(toolTypeSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n\n  const pointerSelection = useSelector(pointerSelectionSelector);\n\n  const annotations = useSelector(imageInstancesSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const imageWidth = useSelector(imageWidthSelector);\n\n  const imageHeight = useSelector(imageHeightSelector);\n\n  let overlappingAnnotationsIds: Array<string> = [];\n\n  const currentIndex = useSelector(currentIndexSelector);\n\n  const [shift, setShift] = useState<boolean>(false);\n\n  useHotkeys(\n    \"*\",\n    (event) => {\n      if (hotkeys.shift) {\n        if (event.type === \"keyup\") {\n          setShift(false);\n        }\n      }\n    },\n    { keyup: true }\n  );\n\n  useHotkeys(\n    \"*\",\n    (event) => {\n      if (hotkeys.shift) {\n        if (event.type === \"keydown\") {\n          setShift(true);\n        }\n      }\n    },\n    { keydown: true }\n  );\n\n  const onMouseDown = (position: { x: number; y: number }) => {\n    dispatch(\n      setPointerSelection({\n        pointerSelection: {\n          ...pointerSelection,\n          dragging: false,\n          minimum: position,\n          selecting: true,\n        },\n      })\n    );\n  };\n\n  const onMouseMove = (position: { x: number; y: number }) => {\n    if (!pointerSelection.selecting) return;\n\n    if (!position || !pointerSelection.minimum) return;\n\n    dispatch(\n      setPointerSelection({\n        pointerSelection: {\n          ...pointerSelection,\n          dragging: Math.abs(position.x - pointerSelection.minimum.x) >= delta,\n          maximum: position,\n        },\n      })\n    );\n  };\n\n  const onMouseUp = (position: { x: number; y: number }) => {\n    if (!pointerSelection.selecting || !pointerSelection.minimum) return;\n\n    if (pointerSelection.dragging) {\n      if (!position) return;\n\n      // correct minimum or maximum in the case where user may have selected rectangle from right to left\n      const maximum: { x: number; y: number } = {\n        x:\n          pointerSelection.minimum.x > position.x\n            ? pointerSelection.minimum.x\n            : position.x,\n        y:\n          pointerSelection.minimum.y > position.y\n            ? pointerSelection.minimum.y\n            : position.y,\n      };\n      const minimum: { x: number; y: number } = {\n        x:\n          pointerSelection.minimum.x > position.x\n            ? position.x\n            : pointerSelection.minimum.x,\n        y:\n          pointerSelection.minimum.y > position.y\n            ? position.y\n            : pointerSelection.minimum.y,\n      };\n\n      dispatch(\n        setPointerSelection({\n          pointerSelection: {\n            ...pointerSelection,\n            minimum: minimum,\n            maximum: maximum,\n          },\n        })\n      );\n\n      if (!minimum || !annotations) return;\n\n      const scaledMinimum = {\n        x: minimum.x / stageScale,\n        y: minimum.y / stageScale,\n      };\n      const scaledMaximum = {\n        x: maximum.x / stageScale,\n        y: maximum.y / stageScale,\n      };\n\n      const annotationsInBox = getAnnotationsInBox(\n        scaledMinimum,\n        scaledMaximum,\n        annotations\n      );\n\n      if (!shift) {\n        dispatch(\n          setSelectedAnnotations({\n            selectedAnnotations: annotationsInBox,\n            selectedAnnotation: annotationsInBox[0],\n          })\n        );\n        dispatch(\n          setSelectedCategory({\n            selectedCategory: annotationsInBox[0].categoryId,\n          })\n        );\n      } else {\n        //only include if not already selected\n        const additionalAnnotations = annotationsInBox.filter(\n          (annotation: AnnotationType) => {\n            return !selectedAnnotationsIds.includes(annotation.id);\n          }\n        );\n        dispatch(\n          setSelectedAnnotations({\n            selectedAnnotations: [\n              ...selectedAnnotations,\n              ...additionalAnnotations,\n            ],\n            selectedAnnotation: annotationsInBox[0],\n          })\n        );\n      }\n    } else {\n      onClick(position);\n    }\n\n    dispatch(\n      setPointerSelection({\n        pointerSelection: { ...pointerSelection, selecting: false },\n      })\n    );\n  };\n\n  const onClick = (position: { x: number; y: number }) => {\n    if (toolType !== ToolType.Pointer) return;\n\n    if (!position) return;\n\n    if (!annotations || !annotations.length || !imageWidth || !imageHeight)\n      return;\n\n    const scaledCurrentPosition = {\n      x: position.x / stageScale,\n      y: position.y / stageScale,\n    };\n\n    overlappingAnnotationsIds = getOverlappingAnnotations(\n      scaledCurrentPosition,\n      annotations,\n      imageWidth,\n      imageHeight\n    );\n\n    let currentAnnotation: AnnotationType | undefined;\n\n    if (overlappingAnnotationsIds.length > 1) {\n      dispatch(\n        applicationSlice.actions.setCurrentIndex({\n          currentIndex:\n            currentIndex + 1 === overlappingAnnotationsIds.length\n              ? 0\n              : currentIndex + 1,\n        })\n      );\n      const nextAnnotationId = overlappingAnnotationsIds[currentIndex];\n\n      currentAnnotation = annotations.find((annotation: AnnotationType) => {\n        return annotation.id === nextAnnotationId;\n      });\n    } else {\n      currentAnnotation = annotations.find((annotation: AnnotationType) => {\n        return annotation.id === overlappingAnnotationsIds[0];\n      });\n      dispatch(\n        applicationSlice.actions.setCurrentIndex({\n          currentIndex: 0,\n        })\n      );\n    }\n\n    if (!currentAnnotation) return;\n\n    if (!shift) {\n      dispatch(\n        setSelectedAnnotations({\n          selectedAnnotations: [currentAnnotation],\n          selectedAnnotation: currentAnnotation,\n        })\n      );\n      dispatch(\n        setSelectedCategory({\n          selectedCategory: currentAnnotation.categoryId,\n        })\n      );\n    }\n\n    if (shift && !selectedAnnotationsIds.includes(currentAnnotation.id)) {\n      //include newly selected annotation if not already selected\n      dispatch(\n        setSelectedAnnotations({\n          selectedAnnotations: [...selectedAnnotations, currentAnnotation],\n          selectedAnnotation: currentAnnotation,\n        })\n      );\n    }\n  };\n\n  return { onMouseDown, onMouseUp, onMouseMove, onPointerClick: onClick };\n};\n","import * as ReactKonva from \"react-konva\";\nimport * as _ from \"lodash\";\nimport Konva from \"konva\";\nimport React, { useEffect, useMemo, useReducer, useRef, useState } from \"react\";\nimport { ToolType } from \"../../../../../types/ToolType\";\nimport {\n  imageInstancesSelector,\n  imageOriginalSrcSelector,\n  invertModeSelector,\n  selectedCategorySelector,\n  selectionModeSelector,\n  stageHeightSelector,\n  stageScaleSelector,\n  stageWidthSelector,\n  toolTypeSelector,\n  zoomSelectionSelector,\n} from \"../../../../../store/selectors\";\nimport { applicationSlice, setSelectedAnnotations } from \"../../../../../store\";\nimport {\n  Provider,\n  ReactReduxContext,\n  useDispatch,\n  useSelector,\n} from \"react-redux\";\nimport { useAnnotationTool, useHandTool, useZoom } from \"../../../../../hooks\";\nimport { AnnotationType } from \"../../../../../types/AnnotationType\";\nimport { penSelectionBrushSizeSelector } from \"../../../../../store/selectors/penSelectionBrushSizeSelector\";\nimport { AnnotationModeType } from \"../../../../../types/AnnotationModeType\";\nimport { Image } from \"../Image\";\nimport { Selecting } from \"../Selecting\";\nimport { annotatedSelector } from \"../../../../../store/selectors/annotatedSelector\";\nimport {\n  ColorAnnotationTool,\n  ObjectAnnotationTool,\n  Tool,\n} from \"../../../../../image/Tool\";\nimport { ColorAnnotationToolTip } from \"../ColorAnnotationToolTip\";\nimport useSound from \"use-sound\";\nimport createAnnotationSoundEffect from \"../../../../../sounds/pop-up-on.mp3\";\nimport deleteAnnotationSoundEffect from \"../../../../../sounds/pop-up-off.mp3\";\nimport { soundEnabledSelector } from \"../../../../../store/selectors/soundEnabledSelector\";\nimport { Layer } from \"../Layer\";\nimport { ZoomSelection } from \"../Selection/ZoomSelection\";\nimport { useKeyboardShortcuts } from \"../../../../../hooks/useKeyboardShortcuts\";\nimport { selectedAnnotationSelector } from \"../../../../../store/selectors/selectedAnnotationSelector\";\nimport { selectedAnnotationsIdsSelector } from \"../../../../../store/selectors/selectedAnnotationsIdsSelector\";\nimport { Transformers } from \"../Transformers/Transformers\";\nimport { useWindowFocusHandler } from \"../../../../../hooks/useWindowFocusHandler/useWindowFocusHandler\";\nimport { stagePositionSelector } from \"../../../../../store/selectors/stagePositionSelector\";\nimport { KonvaEventObject } from \"konva/types/Node\";\nimport { scaledImageWidthSelector } from \"../../../../../store/selectors/scaledImageWidthSelector\";\nimport { scaledImageHeightSelector } from \"../../../../../store/selectors/scaledImageHeightSelector\";\nimport { PenAnnotationToolTip } from \"../PenAnnotationToolTip/PenAnnotationToolTip\";\nimport { selectedAnnotationsSelector } from \"../../../../../store/selectors/selectedAnnotationsSelector\";\nimport { Annotations } from \"../Annotations/Annotations\";\nimport { unselectedAnnotationsSelector } from \"../../../../../store/selectors/unselectedAnnotationsSelector\";\nimport { quickSelectionBrushSizeSelector } from \"../../../../../store/selectors/quickSelectionBrushSizeSelector\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\nimport { PointerSelection } from \"../Selection/PointerSelection\";\nimport { usePointer } from \"../../../../../hooks/usePointer/usePointer\";\nimport { pointerSelectionSelector } from \"../../../../../store/selectors/pointerSelectionSelector\";\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport { channelsSelector } from \"../../../../../store/selectors/intensityRangeSelector\";\n\nexport const Stage = () => {\n  const imageRef = useRef<Konva.Image | null>(null);\n  const stageRef = useRef<Konva.Stage>(null);\n\n  const src = useSelector(imageOriginalSrcSelector);\n\n  const selectingRef = useRef<Konva.Line | null>(null);\n\n  const toolType = useSelector(toolTypeSelector);\n\n  const invertMode = useSelector(invertModeSelector);\n  const penSelectionBrushSize = useSelector(penSelectionBrushSizeSelector);\n  const selectedAnnotationsIds = useSelector(selectedAnnotationsIdsSelector);\n  const quickSelectionBrushSize = useSelector(quickSelectionBrushSizeSelector);\n  const selectedCategory = useSelector(selectedCategorySelector);\n\n  const channels = useSelector(channelsSelector);\n\n  const selectedAnnotations = useSelector(selectedAnnotationsSelector);\n  const unselectedAnnotations = useSelector(unselectedAnnotationsSelector);\n  const selectionMode = useSelector(selectionModeSelector);\n\n  const stageHeight = useSelector(stageHeightSelector);\n  const stageWidth = useSelector(stageWidthSelector);\n  const stagePosition = useSelector(stagePositionSelector);\n\n  const saveLabelRef = useRef<Konva.Label>();\n  const clearLabelRef = useRef<Konva.Label>();\n\n  const [currentPosition, setCurrentPosition] = useState<{\n    x: number;\n    y: number;\n  }>();\n\n  const scaledImageWidth = useSelector(scaledImageWidthSelector);\n  const scaledImageHeight = useSelector(scaledImageHeightSelector);\n\n  const stageScale = useSelector(stageScaleSelector);\n\n  const dispatch = useDispatch();\n\n  const {\n    deselect: onZoomDeselect,\n    onMouseUp: onZoomMouseUp,\n    onMouseMove: onZoomMouseMove,\n    onMouseDown: onZoomMouseDown,\n    onWheel: onZoomWheel,\n  } = useZoom();\n\n  const {\n    onMouseDown: onPointerMouseDown,\n    onMouseMove: onPointerMouseMove,\n    onMouseUp: onPointerMouseUp,\n  } = usePointer();\n\n  const [annotationTool] = useAnnotationTool();\n\n  const [, update] = useReducer((x) => x + 1, 0);\n\n  const annotations = useSelector(imageInstancesSelector);\n\n  const annotated = useSelector(annotatedSelector);\n\n  const selectedAnnotation = useSelector(selectedAnnotationSelector);\n\n  const { dragging: zoomDragging, selecting: zoomSelecting } = useSelector(\n    zoomSelectionSelector\n  );\n\n  const {\n    dragging: pointerDragging,\n    selecting: pointerSelecting,\n  } = useSelector(pointerSelectionSelector);\n\n  useWindowFocusHandler();\n\n  const [playCreateAnnotationSoundEffect] = useSound(\n    createAnnotationSoundEffect\n  );\n  const [playDeleteAnnotationSoundEffect] = useSound(\n    deleteAnnotationSoundEffect\n  );\n\n  const soundEnabled = useSelector(soundEnabledSelector);\n\n  const detachTransformer = (transformerId: string) => {\n    if (!stageRef || !stageRef.current) return;\n    const transformer = stageRef.current.findOne(`#${transformerId}`);\n\n    if (!transformer) return;\n\n    (transformer as Konva.Transformer).detach();\n    (transformer as Konva.Transformer).getLayer()?.batchDraw();\n  };\n\n  const deselectAllTransformers = () => {\n    if (!stageRef || !stageRef.current) return;\n\n    const transformers = stageRef.current.find(\"Transformer\").toArray();\n    transformers.forEach((tr: any) => {\n      (tr as Konva.Transformer).detach();\n      (tr as Konva.Transformer).getLayer()?.batchDraw();\n    });\n  };\n\n  const deselectAllAnnotations = () => {\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [],\n        selectedAnnotation: undefined,\n      })\n    );\n  };\n\n  const deselectAnnotation = () => {\n    if (!annotationTool) return;\n\n    annotationTool.deselect();\n\n    dispatch(applicationSlice.actions.setAnnotating({ annotating: false }));\n    dispatch(applicationSlice.actions.setAnnotated({ annotated: false }));\n\n    if (!selectedAnnotation) return;\n\n    selectingRef.current = null;\n\n    const transformerId = \"tr-\".concat(selectedAnnotation.id);\n    detachTransformer(transformerId);\n  };\n\n  useEffect(() => {\n    if (!annotationTool) return;\n\n    if (!selectedAnnotation || !selectedAnnotation.mask) return;\n\n    const [invertedMask, invertedBoundingBox] = annotationTool.invert(\n      selectedAnnotation.mask,\n      selectedAnnotation.boundingBox\n    );\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [\n          {\n            ...selectedAnnotation,\n            boundingBox: invertedBoundingBox,\n            mask: invertedMask,\n          },\n        ],\n        selectedAnnotation: {\n          ...selectedAnnotation,\n          boundingBox: invertedBoundingBox,\n          mask: invertedMask,\n        },\n      })\n    );\n  }, [invertMode]);\n\n  useEffect(() => {\n    if (toolType === ToolType.Zoom) return;\n\n    if (selectionMode === AnnotationModeType.New) return;\n\n    if (!annotated || !annotationTool) return;\n\n    dispatch(applicationSlice.actions.setAnnotating({ annotating: false }));\n\n    if (!annotationTool.annotated) return;\n\n    let combinedMask, combinedBoundingBox;\n\n    if (!selectedAnnotation) return;\n\n    if (selectionMode === AnnotationModeType.Add) {\n      [combinedMask, combinedBoundingBox] = annotationTool.add(\n        selectedAnnotation.mask,\n        selectedAnnotation.boundingBox\n      );\n    } else if (selectionMode === AnnotationModeType.Subtract) {\n      [combinedMask, combinedBoundingBox] = annotationTool.subtract(\n        selectedAnnotation.mask,\n        selectedAnnotation.boundingBox\n      );\n    } else if (selectionMode === AnnotationModeType.Intersect) {\n      [combinedMask, combinedBoundingBox] = annotationTool.intersect(\n        selectedAnnotation.mask,\n        selectedAnnotation.boundingBox\n      );\n    }\n\n    annotationTool.mask = combinedMask;\n\n    annotationTool.boundingBox = combinedBoundingBox;\n\n    if (!annotationTool.boundingBox || !annotationTool.mask) return;\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [\n          {\n            ...selectedAnnotation,\n            boundingBox: annotationTool.boundingBox,\n            mask: annotationTool.mask,\n          },\n        ],\n        selectedAnnotation: {\n          ...selectedAnnotation,\n          boundingBox: annotationTool.boundingBox,\n          mask: annotationTool.mask,\n        },\n      })\n    );\n  }, [annotated]);\n\n  useEffect(() => {\n    if (!selectedAnnotationsIds) return;\n\n    if (!annotations) return;\n\n    const updatedAnnotations = _.map(\n      selectedAnnotations,\n      (annotation: AnnotationType) => {\n        return { ...annotation, categoryId: selectedCategory.id };\n      }\n    );\n\n    if (!selectedAnnotation) return;\n\n    dispatch(\n      applicationSlice.actions.setSelectedAnnotations({\n        selectedAnnotations: updatedAnnotations,\n        selectedAnnotation: {\n          ...selectedAnnotation,\n          categoryId: selectedCategory.id,\n        },\n      })\n    );\n  }, [selectedCategory]);\n\n  useEffect(() => {\n    if (!annotationTool) return;\n\n    if (annotationTool.annotated) {\n      dispatch(\n        applicationSlice.actions.setAnnotated({\n          annotated: annotationTool.annotated,\n        })\n      );\n\n      if (selectionMode !== AnnotationModeType.New) return;\n      annotationTool.annotate(selectedCategory);\n    }\n\n    if (annotationTool.annotating)\n      dispatch(\n        applicationSlice.actions.setAnnotating({\n          annotating: annotationTool.annotating,\n        })\n      );\n\n    if (selectionMode === AnnotationModeType.New) return;\n  }, [annotationTool?.annotated, annotationTool?.annotating]);\n\n  useEffect(() => {\n    if (toolType === ToolType.PenAnnotation) {\n      // @ts-ignore\n      annotationTool.brushSize = penSelectionBrushSize / stageScale;\n    }\n  }, [penSelectionBrushSize]);\n\n  useEffect(() => {\n    if (toolType === ToolType.QuickAnnotation) {\n      //@ts-ignore\n      annotationTool.update(Math.round(quickSelectionBrushSize / stageScale));\n    }\n  }, [quickSelectionBrushSize]);\n\n  useEffect(() => {\n    if (!annotated) return;\n\n    if (!annotationTool) return;\n\n    annotationTool.annotate(selectedCategory);\n\n    if (!annotationTool.annotation) return;\n\n    if (selectionMode !== AnnotationModeType.New) return;\n\n    dispatch(\n      setSelectedAnnotations({\n        selectedAnnotations: [annotationTool.annotation],\n        selectedAnnotation: annotationTool.annotation,\n      })\n    );\n  }, [annotated]);\n\n  useEffect(() => {\n    if (!stageRef || !stageRef.current) return;\n\n    _.forEach(selectedAnnotationsIds, (annotationId) => {\n      if (!stageRef || !stageRef.current) return;\n\n      const transformerId = \"tr-\".concat(annotationId);\n\n      const transformer = stageRef.current.findOne(`#${transformerId}`);\n      const line = stageRef.current.findOne(`#${annotationId}`);\n\n      if (!line) return;\n\n      if (!transformer) return;\n\n      (transformer as Konva.Transformer).nodes([line]);\n\n      const layer = (transformer as Konva.Transformer).getLayer();\n\n      if (!layer) return;\n\n      layer.batchDraw();\n\n      // Not ideal but this figures out which label is which\n      const label = stageRef.current.find(`#label`);\n      if (label.length > 1) {\n        saveLabelRef.current = label[0] as Konva.Label;\n        clearLabelRef.current = label[1] as Konva.Label;\n      }\n    });\n  }, [selectedAnnotationsIds, selectedAnnotation?.mask]);\n\n  const getRelativePointerPosition = (position: { x: number; y: number }) => {\n    if (!imageRef || !imageRef.current) return;\n\n    const transform = imageRef.current.getAbsoluteTransform().copy();\n\n    transform.invert();\n\n    return transform.point(position);\n  };\n\n  const onMouseDown = (event: KonvaEventObject<MouseEvent>) => {\n    if (\n      !event.target.getParent() ||\n      event.target.getParent().className === \"Transformer\"\n    )\n      return;\n    memoizedOnMouseDown();\n  };\n\n  const memoizedOnMouseDown = useMemo(() => {\n    const func = () => {\n      if (toolType === ToolType.Hand || toolType === ToolType.ColorAdjustment)\n        return;\n\n      if (!stageRef || !stageRef.current) return;\n\n      const position = stageRef.current.getPointerPosition();\n\n      if (!position) return;\n\n      const relative = getRelativePointerPosition(position);\n\n      if (!relative) return;\n\n      if (\n        saveLabelRef &&\n        saveLabelRef.current &&\n        saveLabelRef.current.getText() &&\n        clearLabelRef.current\n      ) {\n        //do not proceed with mouse down events if user has clicked on Save Annotation button\n        if (\n          (relative.x <\n            saveLabelRef.current.x() + saveLabelRef.current.width() &&\n            relative.x > saveLabelRef.current.x() &&\n            relative.y <\n              saveLabelRef.current.y() + saveLabelRef.current.height() &&\n            relative.y > saveLabelRef.current.y()) ||\n          (relative.x <\n            clearLabelRef.current.x() + clearLabelRef.current.width() &&\n            relative.x > clearLabelRef.current.x() &&\n            relative.y <\n              clearLabelRef.current.y() + clearLabelRef.current.height() &&\n            relative.y > clearLabelRef.current.y())\n        ) {\n          return;\n        }\n      }\n\n      if (toolType === ToolType.Pointer) {\n        onPointerMouseDown(relative);\n        return;\n      }\n\n      const rawImagePosition = {\n        x: relative.x / stageScale,\n        y: relative.y / stageScale,\n      };\n\n      if (toolType === ToolType.Zoom) {\n        onZoomMouseDown(relative);\n      } else {\n        if (annotated) {\n          deselectAnnotation();\n          dispatch(applicationSlice.actions.setAnnotated({ annotated: false }));\n        }\n\n        if (selectionMode === AnnotationModeType.New) {\n          dispatch(\n            applicationSlice.actions.setSelectedAnnotations({\n              selectedAnnotations: [],\n              selectedAnnotation: undefined,\n            })\n          );\n        }\n\n        if (!annotationTool) return;\n\n        annotationTool.onMouseDown(rawImagePosition);\n\n        update();\n      }\n    };\n    const throttled = _.throttle(func, 5);\n    return () => throttled();\n  }, [\n    annotated,\n    annotationTool,\n    saveLabelRef,\n    pointerDragging,\n    pointerSelecting,\n    selectionMode,\n    toolType,\n    zoomDragging,\n    zoomSelecting,\n  ]);\n\n  const onMouseMove = useMemo(() => {\n    const func = () => {\n      if (!stageRef || !stageRef.current) return;\n\n      if (toolType === ToolType.ColorAdjustment) return;\n\n      const position = stageRef.current.getPointerPosition();\n\n      if (!position) return;\n\n      const relative = getRelativePointerPosition(position);\n\n      if (!relative || !scaledImageWidth || !scaledImageHeight) return;\n\n      if (toolType === ToolType.PenAnnotation) setCurrentPosition(relative);\n\n      // Add a little leeway around the canvas to aid drawing up to the edges\n      if (relative.x > -50 && relative.x < 0) {\n        relative.x = 0;\n      } else if (\n        relative.x > scaledImageWidth &&\n        relative.x < scaledImageWidth + 50\n      ) {\n        relative.x = scaledImageWidth;\n      }\n      if (relative.y > -50 && relative.y < 0) {\n        relative.y = 0;\n      } else if (\n        relative.y > scaledImageHeight &&\n        relative.y < scaledImageHeight + 50\n      ) {\n        relative.y = scaledImageHeight;\n      }\n\n      if (\n        relative.x > scaledImageWidth ||\n        relative.y > scaledImageHeight ||\n        relative.x < 0 ||\n        relative.y < 0\n      )\n        return;\n\n      const rawImagePosition = {\n        x: relative.x / stageScale,\n        y: relative.y / stageScale,\n      };\n\n      if (toolType === ToolType.Zoom) {\n        onZoomMouseMove(relative);\n      } else if (toolType === ToolType.Pointer) {\n        onPointerMouseMove(relative);\n      } else {\n        if (!annotationTool) return;\n\n        annotationTool.onMouseMove(rawImagePosition);\n\n        update();\n      }\n    };\n    const throttled = _.throttle(func, 5);\n    return () => throttled();\n  }, [\n    annotationTool,\n    pointerDragging,\n    pointerSelecting,\n    toolType,\n    zoomDragging,\n    zoomSelecting,\n  ]);\n\n  const onMouseUp = useMemo(() => {\n    const func = async () => {\n      if (!stageRef || !stageRef.current) return;\n\n      const position = stageRef.current.getPointerPosition();\n\n      if (!position) return;\n\n      const relative = getRelativePointerPosition(position);\n\n      if (!relative) return;\n\n      const rawImagePosition = {\n        x: relative.x / stageScale,\n        y: relative.y / stageScale,\n      };\n\n      if (toolType === ToolType.Zoom) {\n        onZoomMouseUp(relative);\n      } else if (toolType === ToolType.Pointer) {\n        onPointerMouseUp(relative);\n      } else {\n        if (!annotationTool) return;\n\n        if (!relative || !scaledImageWidth || !scaledImageHeight) return;\n\n        if (toolType === ToolType.ObjectAnnotation) {\n          await (annotationTool as ObjectAnnotationTool).onMouseUp(\n            rawImagePosition\n          );\n        }\n        annotationTool.onMouseUp(rawImagePosition);\n\n        update();\n      }\n    };\n    const throttled = _.throttle(func, 10);\n\n    return () => throttled();\n  }, [\n    annotationTool,\n    pointerDragging,\n    pointerSelecting,\n    toolType,\n    zoomDragging,\n    zoomSelecting,\n  ]);\n\n  const confirmAnnotations = () => {\n    if (!annotations || !annotationTool || annotationTool.annotating) return;\n\n    dispatch(\n      applicationSlice.actions.setImageInstances({\n        instances: [...unselectedAnnotations, ...selectedAnnotations],\n      })\n    );\n\n    if (soundEnabled) playCreateAnnotationSoundEffect();\n\n    deselectAnnotation();\n\n    dispatch(applicationSlice.actions.setAnnotated({ annotated: false }));\n\n    if (selectionMode !== AnnotationModeType.New)\n      dispatch(\n        applicationSlice.actions.setSelectionMode({\n          selectionMode: AnnotationModeType.New,\n        })\n      );\n\n    if (!selectedAnnotationsIds.length) return;\n\n    deselectAllAnnotations();\n    deselectAllTransformers();\n  };\n\n  useHotkeys(\n    \"enter\",\n    () => {\n      confirmAnnotations();\n    },\n    [\n      annotations,\n      annotationTool,\n      annotationTool?.annotating,\n      dispatch,\n      selectedAnnotations,\n      unselectedAnnotations,\n      selectionMode,\n      selectedAnnotationsIds,\n    ]\n  );\n\n  useHotkeys(\n    \"enter\",\n    () => {\n      if (\n        toolType !== ToolType.PolygonalAnnotation &&\n        toolType !== ToolType.LassoAnnotation\n      )\n        return;\n\n      if (!annotationTool) return;\n\n      annotationTool.connect();\n    },\n    [toolType, annotationTool]\n  );\n\n  useHotkeys(\n    \"backspace, delete\",\n    () => {\n      _.map(selectedAnnotationsIds, (annotationId: string) => {\n        dispatch(\n          applicationSlice.actions.deleteImageInstance({\n            id: annotationId,\n          })\n        );\n      });\n      deselectAllAnnotations();\n      deselectAllTransformers();\n\n      if (!_.isEmpty(annotations) && soundEnabled) {\n        playDeleteAnnotationSoundEffect();\n      }\n\n      deselectAnnotation();\n    },\n    [selectedAnnotationsIds, annotations]\n  );\n\n  useHotkeys(\n    \"escape\",\n    () => {\n      deselectAllAnnotations();\n      deselectAllTransformers();\n\n      if (!_.isEmpty(annotations) && soundEnabled) {\n        playDeleteAnnotationSoundEffect();\n      }\n\n      deselectAnnotation();\n\n      if (toolType !== ToolType.Zoom) return;\n      onZoomDeselect();\n    },\n    [annotations, annotationTool, toolType]\n  );\n\n  /*/\n  Detach transformers and selections when all annotations are removed\n   */\n  useEffect(() => {\n    if (!annotations) return;\n\n    if (annotations.length) return;\n\n    deselectAllTransformers();\n    deselectAllAnnotations();\n  }, [annotations?.length]);\n\n  const [tool, setTool] = useState<Tool>();\n\n  useEffect(() => {\n    setTool(annotationTool);\n  }, [annotationTool, toolType]);\n\n  useKeyboardShortcuts();\n\n  const { draggable } = useHandTool();\n\n  return (\n    <ReactReduxContext.Consumer>\n      {({ store }) => (\n        <ReactKonva.Stage\n          draggable={draggable}\n          height={stageHeight}\n          onMouseDown={(evt) => onMouseDown(evt)}\n          onMouseMove={onMouseMove}\n          onMouseUp={onMouseUp}\n          onWheel={onZoomWheel}\n          position={stagePosition}\n          ref={stageRef}\n          width={stageWidth}\n        >\n          <Provider store={store}>\n            <DndProvider backend={HTML5Backend}>\n              <Layer>\n                <Image ref={imageRef} />\n\n                <ZoomSelection />\n\n                <Selecting tool={tool!} />\n\n                <PenAnnotationToolTip\n                  currentPosition={currentPosition}\n                  annotationTool={annotationTool}\n                />\n\n                <PointerSelection />\n\n                <Annotations />\n\n                <Transformers transformPosition={getRelativePointerPosition} />\n\n                <ColorAnnotationToolTip\n                  toolTipPosition={\n                    (annotationTool as ColorAnnotationTool)?.toolTipPosition\n                  }\n                  initialPosition={\n                    (annotationTool as ColorAnnotationTool)?.initialPosition\n                  }\n                  tolerance={(annotationTool as ColorAnnotationTool)?.tolerance}\n                />\n              </Layer>\n            </DndProvider>\n          </Provider>\n        </ReactKonva.Stage>\n      )}\n    </ReactReduxContext.Consumer>\n  );\n};\n","import { KonvaEventObject } from \"konva/types/Node\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { ZoomModeType } from \"../../types/ZoomModeType\";\nimport { setOffset, setStageScale, setZoomSelection } from \"../../store\";\nimport {\n  stageScaleSelector,\n  toolTypeSelector,\n  zoomSelectionSelector,\n  zoomToolOptionsSelector,\n} from \"../../store/selectors\";\nimport { scaledImageWidthSelector } from \"../../store/selectors/scaledImageWidthSelector\";\n\nexport const useZoom = () => {\n  const delta = 10;\n  const scaleBy = 1.25;\n\n  const dispatch = useDispatch();\n\n  const stageScale = useSelector(stageScaleSelector);\n  const toolType = useSelector(toolTypeSelector);\n  const { automaticCentering, mode } = useSelector(zoomToolOptionsSelector);\n  const zoomSelection = useSelector(zoomSelectionSelector);\n\n  const imageWidth = useSelector(scaledImageWidthSelector);\n\n  const zoomAndOffset = (\n    position: { x: number; y: number } | undefined,\n    scaleBy: number,\n    zoomIn: boolean = true\n  ) => {\n    if (!automaticCentering) {\n      if (!position) return;\n      dispatch(\n        setOffset({\n          offset: {\n            x: zoomIn ? position.x * scaleBy : position.x / scaleBy,\n            y: zoomIn ? position.y * scaleBy : position.y / scaleBy,\n          },\n        })\n      );\n    }\n    dispatch(\n      setStageScale({\n        stageScale: zoomIn ? stageScale * scaleBy : stageScale / scaleBy,\n      })\n    );\n  };\n\n  const deselect = () => {\n    dispatch(\n      setZoomSelection({\n        zoomSelection: {\n          maximum: undefined,\n          minimum: undefined,\n          selecting: false,\n          dragging: false,\n        },\n      })\n    );\n  };\n\n  const onMouseDown = (position: { x: number; y: number }) => {\n    if (toolType !== ToolType.Zoom) return;\n\n    dispatch(\n      setZoomSelection({\n        zoomSelection: {\n          ...zoomSelection,\n          dragging: false,\n          minimum: position,\n          selecting: true,\n        },\n      })\n    );\n  };\n\n  const onMouseMove = (position: { x: number; y: number }) => {\n    if (mode === ZoomModeType.Out) return;\n\n    if (!zoomSelection.selecting) return;\n\n    if (!position || !zoomSelection.minimum) return;\n\n    dispatch(\n      setZoomSelection({\n        zoomSelection: {\n          ...zoomSelection,\n          dragging: Math.abs(position.x - zoomSelection.minimum.x) >= delta,\n          maximum: position,\n        },\n      })\n    );\n  };\n\n  const onMouseUp = (position: { x: number; y: number }) => {\n    if (!imageWidth) return;\n\n    if (!zoomSelection.selecting) return;\n\n    if (zoomSelection.dragging) {\n      if (!position) return;\n\n      dispatch(\n        setZoomSelection({\n          zoomSelection: { ...zoomSelection, maximum: position },\n        })\n      );\n\n      if (!zoomSelection.minimum) return;\n\n      const selectedWidth = position.x - zoomSelection.minimum.x;\n\n      zoomAndOffset(\n        {\n          x: zoomSelection.minimum.x + selectedWidth / 2,\n          y: zoomSelection.minimum.y + selectedWidth / 2,\n        },\n        imageWidth / selectedWidth / stageScale\n      );\n    } else {\n      zoomAndOffset(position, scaleBy, mode === ZoomModeType.In);\n    }\n\n    dispatch(\n      setZoomSelection({\n        zoomSelection: { ...zoomSelection, selecting: false },\n      })\n    );\n  };\n\n  const onWheel = (event: KonvaEventObject<WheelEvent>) => {\n    if (toolType !== ToolType.Zoom) return;\n\n    if (!imageWidth) return;\n    zoomAndOffset(\n      { x: imageWidth / 2, y: imageWidth / 2 },\n      scaleBy,\n      event.evt.deltaY < 0\n    );\n  };\n\n  return {\n    deselect,\n    onMouseDown,\n    onMouseMove,\n    onMouseUp,\n    onWheel,\n  };\n};\n","import { useEffect, useState } from \"react\";\nimport * as ImageJS from \"image-js\";\nimport { ToolType } from \"../../types/ToolType\";\nimport {\n  AnnotationTool,\n  ColorAnnotationTool,\n  EllipticalAnnotationTool,\n  LassoAnnotationTool,\n  MagneticAnnotationTool,\n  ObjectAnnotationTool,\n  PenAnnotationTool,\n  PolygonalAnnotationTool,\n  QuickAnnotationTool,\n  RectangularAnnotationTool,\n} from \"../../image/Tool\";\nimport { useSelector } from \"react-redux\";\nimport { stageScaleSelector, toolTypeSelector } from \"../../store/selectors\";\nimport { penSelectionBrushSizeSelector } from \"../../store/selectors/penSelectionBrushSizeSelector\";\nimport { quickSelectionBrushSizeSelector } from \"../../store/selectors/quickSelectionBrushSizeSelector\";\nimport { imageSrcSelector } from \"../../store/selectors/imageSrcSelector\";\n\nexport const useAnnotationTool = () => {\n  const src = useSelector(imageSrcSelector);\n  const operation = useSelector(toolTypeSelector);\n  const stageScale = useSelector(stageScaleSelector);\n\n  const [operator, setOperator] = useState<AnnotationTool>();\n\n  const [image, setImage] = useState<ImageJS.Image>();\n\n  const penSelectionBrushSize = useSelector(penSelectionBrushSizeSelector);\n\n  const quickSelectionBrushSize = useSelector(quickSelectionBrushSizeSelector);\n\n  useEffect(() => {\n    if (!src) return;\n\n    const loadImage = async () => {\n      const image = await ImageJS.Image.load(src);\n      setImage(image);\n    };\n\n    loadImage();\n  }, [src]);\n\n  useEffect(() => {\n    if (!image) return;\n\n    switch (operation) {\n      case ToolType.ColorAnnotation:\n        setOperator(new ColorAnnotationTool(image));\n\n        return;\n      case ToolType.EllipticalAnnotation:\n        setOperator(new EllipticalAnnotationTool(image));\n\n        return;\n      case ToolType.LassoAnnotation:\n        setOperator(new LassoAnnotationTool(image));\n\n        return;\n      case ToolType.MagneticAnnotation:\n        setOperator(new MagneticAnnotationTool(image, 0.5));\n\n        return;\n      case ToolType.ObjectAnnotation:\n        ObjectAnnotationTool.compile(image).then(\n          (operator: ObjectAnnotationTool) => {\n            setOperator(operator);\n          }\n        );\n\n        return;\n      case ToolType.PenAnnotation:\n        PenAnnotationTool.setup(\n          image,\n          penSelectionBrushSize / (stageScale ? stageScale : 1)\n        ).then((operator: PenAnnotationTool) => {\n          setOperator(operator);\n        });\n\n        return;\n      case ToolType.PolygonalAnnotation:\n        setOperator(new PolygonalAnnotationTool(image));\n\n        return;\n      case ToolType.QuickAnnotation:\n        const quickSelectionOperator = QuickAnnotationTool.setup(\n          image,\n          quickSelectionBrushSize / Math.round(stageScale ? stageScale : 1)\n        );\n        setOperator(quickSelectionOperator);\n\n        return;\n      case ToolType.RectangularAnnotation:\n        setOperator(new RectangularAnnotationTool(image));\n\n        return;\n    }\n  }, [operation, image]);\n\n  return [operator];\n};\n","// User has switched back to the tab\nimport { useEffect, useState } from \"react\";\nimport { applicationSlice } from \"../../store/slices\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\nimport { useDispatch } from \"react-redux\";\n\nexport const useWindowFocusHandler = () => {\n  const dispatch = useDispatch();\n\n  const onBlur = () => {\n    dispatch(\n      applicationSlice.actions.setSelectionMode({\n        selectionMode: AnnotationModeType.New,\n      })\n    );\n  };\n\n  useEffect(() => {\n    // window.addEventListener('focus', onFocus);\n    window.addEventListener(\"blur\", onBlur);\n    // Specify how to clean up after this effect:\n    return () => {\n      // window.removeEventListener('focus', onFocus);\n      window.removeEventListener(\"blur\", onBlur);\n    };\n  }, []);\n};\n","import { useDispatch, useSelector } from \"react-redux\";\nimport {\n  applicationSlice,\n  setOperation,\n  setSelectedCategory,\n} from \"../../store\";\nimport { ToolType } from \"../../types/ToolType\";\nimport {\n  createdCategoriesSelector,\n  toolTypeSelector,\n} from \"../../store/selectors\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\nimport { ActionCreators } from \"redux-undo\";\nimport { AnnotationModeType } from \"../../types/AnnotationModeType\";\nimport hotkeys from \"hotkeys-js\";\n\nexport const useKeyboardShortcuts = () => {\n  const dispatch = useDispatch();\n\n  const categories = useSelector(createdCategoriesSelector);\n  const toolType = useSelector(toolTypeSelector);\n\n  // /*\n  // Undo operation (Ctrl+z)\n  // */\n  // useHotkeys(\"ctrl+z\", () => {\n  //   dispatch(ActionCreators.jump(-1)); //undo should be allowed only if user did an accidental delete or an accidental modification to the selected annotation\n  // });\n  //\n  // /*\n  // Undo operation (Cmd+z)\n  // */\n  // useHotkeys(\"cmd+z\", () => {\n  //   dispatch(ActionCreators.jump(-1)); //undo should be allowed only if user did an accidental delete or an accidental modification to the selected annotation\n  // });\n\n  // /*\n  //  * Cycle lasso tools (Shift + L)\n  //  */\n  // useHotkeys(\n  //   \"shift+l\",\n  //   () => {\n  //     switch (toolType) {\n  //       case ToolType.LassoAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.MagneticAnnotation }));\n  //\n  //         break;\n  //       case ToolType.MagneticAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.PolygonalAnnotation }));\n  //\n  //         break;\n  //       case ToolType.PolygonalAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.LassoAnnotation }));\n  //\n  //         break;\n  //       default:\n  //         dispatch(setOperation({ operation: ToolType.LassoAnnotation }));\n  //\n  //         break;\n  //     }\n  //   },\n  //   [toolType]\n  // );\n\n  // /*\n  //  * Cycle marquee tools (Shift + M)\n  //  */\n  // useHotkeys(\n  //   \"shift+m\",\n  //   () => {\n  //     switch (toolType) {\n  //       case ToolType.EllipticalAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n  //\n  //         break;\n  //       case ToolType.RectangularAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.EllipticalAnnotation }));\n  //\n  //         break;\n  //       default:\n  //         dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n  //\n  //         break;\n  //     }\n  //   },\n  //   [toolType]\n  // );\n\n  // /*\n  //  * Cycle learning-based tools (Shift + W)\n  //  */\n  // useHotkeys(\n  //   \"shift+w\",\n  //   () => {\n  //     switch (toolType) {\n  //       case ToolType.ColorAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.ObjectAnnotation }));\n  //\n  //         break;\n  //       case ToolType.ObjectAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.QuickAnnotation }));\n  //\n  //         break;\n  //       case ToolType.QuickAnnotation:\n  //         dispatch(setOperation({ operation: ToolType.ColorAnnotation }));\n  //\n  //         break;\n  //       default:\n  //         dispatch(setOperation({ operation: ToolType.ColorAnnotation }));\n  //\n  //         break;\n  //     }\n  //   },\n  //   [toolType]\n  // );\n\n  /*\n   * Select arrange tool (V)\n   */\n  useHotkeys(\"shift+s\", () => {\n    dispatch(setOperation({ operation: ToolType.Pointer }));\n  });\n\n  /*\n   * Select category (1-9)\n   */\n  useHotkeys(\"1,2,3,4,5,6,7,8,9\", (event: KeyboardEvent) => {\n    const index = parseInt(event.key) - 1;\n\n    const selectedCategory = categories[index];\n\n    if (!selectedCategory) return;\n\n    dispatch(setSelectedCategory({ selectedCategory: selectedCategory.id }));\n  });\n\n  /*\n   * Select color tool (W)\n   */\n  useHotkeys(\"shift+c\", () => {\n    dispatch(setOperation({ operation: ToolType.ColorAnnotation }));\n  });\n\n  /*\n   * Select quick tool (W)\n   */\n  useHotkeys(\"shift+q\", () => {\n    dispatch(setOperation({ operation: ToolType.QuickAnnotation }));\n  });\n\n  /*\n   * Select hand tool (H)\n   */\n  useHotkeys(\"shift+h\", () => {\n    dispatch(setOperation({ operation: ToolType.Hand }));\n  });\n\n  /*\n   * Select lasso tool (L)\n   */\n  useHotkeys(\"shift+l\", () => {\n    dispatch(setOperation({ operation: ToolType.LassoAnnotation }));\n  });\n\n  /*\n   * Select polygonal tool (L)\n   */\n  useHotkeys(\"shift+p\", () => {\n    dispatch(setOperation({ operation: ToolType.PolygonalAnnotation }));\n  });\n\n  /*\n   * Select magnetic tool (M)\n   */\n  useHotkeys(\"shift+m\", () => {\n    dispatch(setOperation({ operation: ToolType.MagneticAnnotation }));\n  });\n\n  /*\n   * Select pencil tool (P)\n   */\n  useHotkeys(\"shift+d\", () => {\n    dispatch(setOperation({ operation: ToolType.PenAnnotation }));\n  });\n\n  /*\n   * Select rectangular tool (R)\n   */\n  useHotkeys(\"shift+r\", () => {\n    dispatch(setOperation({ operation: ToolType.RectangularAnnotation }));\n  });\n\n  /*\n   * Select elliptical tool (E)\n   */\n  useHotkeys(\"shift+e\", () => {\n    dispatch(setOperation({ operation: ToolType.EllipticalAnnotation }));\n  });\n\n  /*\n   * Select zoom tool (Z)\n   */\n  useHotkeys(\"shift+z\", () => {\n    dispatch(setOperation({ operation: ToolType.Zoom }));\n  });\n\n  /*\n   * Select intensity adjustment tool (Z)\n   */\n  useHotkeys(\"shift+i\", () => {\n    dispatch(setOperation({ operation: ToolType.ColorAdjustment }));\n  });\n\n  /*\n   * Key shortcuts for special selection mode\n   * */\n  // useHotkeys(\n  //   \"*\",\n  //   () => {\n  //     if (hotkeys.shift) {\n  //       if (toolType === ToolType.Pointer) return; //pointer tool has its own shift handler for multiple selections\n  //       dispatch(\n  //         applicationSlice.actions.setSelectionMode({\n  //           selectionMode: AnnotationModeType.Add,\n  //         })\n  //       );\n  //     }\n  //     if (hotkeys.alt) {\n  //       dispatch(\n  //         applicationSlice.actions.setSelectionMode({\n  //           selectionMode: AnnotationModeType.Subtract,\n  //         })\n  //       );\n  //     }\n  //   },\n  //   [toolType]\n  // );\n};\n","import { useEffect, useState } from \"react\";\nimport { ToolType } from \"../../types/ToolType\";\nimport { useSelector } from \"react-redux\";\nimport { toolTypeSelector } from \"../../store/selectors\";\nimport { useHotkeys } from \"react-hotkeys-hook\";\n\nexport const useHandTool = () => {\n  const toolType = useSelector(toolTypeSelector);\n\n  const [draggable, setDraggable] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (toolType === ToolType.Hand) {\n      setDraggable(true);\n    } else {\n      setDraggable(false);\n    }\n  }, [toolType]);\n\n  return { draggable };\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nexport const useStyles = makeStyles((theme) => ({\n  appBar: {\n    borderBottom: \"1px solid #3F3F3F\",\n    backgroundColor: \"rgba(50, 50, 50)\",\n    boxShadow: \"none\",\n    left: theme.spacing(32),\n    position: \"absolute\",\n    opacity: \"50%\",\n  },\n  content: {\n    backgroundColor: theme.palette.background.default,\n    width: \"100%\",\n  },\n  toolbar: {\n    ...theme.mixins.toolbar,\n  },\n  parent: {\n    cursor: \"crosshair\",\n    width: \"100%\",\n  },\n}));\n","import React, { useRef } from \"react\";\nimport { Stage } from \"../Stage\";\nimport { useStyles } from \"./Content.css\";\nimport { NativeTypes } from \"react-dnd-html5-backend\";\nimport { DropTargetMonitor, useDrop } from \"react-dnd\";\nimport { useBoundingClientRect } from \"../../../../hooks/useBoundingClientRect\";\nimport { useCursor } from \"../../../../hooks\";\n\ntype ContentProps = {\n  onDrop: (item: { files: any[] }) => void;\n};\n\nexport const Content = ({ onDrop }: ContentProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n\n  const classes = useStyles();\n\n  useBoundingClientRect(ref);\n\n  const [, drop] = useDrop(\n    () => ({\n      accept: [NativeTypes.FILE],\n      drop(item: { files: any[] }) {\n        if (onDrop) {\n          onDrop(item);\n        }\n      },\n      collect: (monitor: DropTargetMonitor) => ({\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    }),\n    []\n  );\n\n  const { cursor } = useCursor();\n\n  return (\n    <React.Fragment>\n      {/*<AppBar className={classes.appBar} color=\"default\">*/}\n      {/*  <Toolbar>*/}\n      {/*    <Typography variant=\"h6\" color=\"inherit\">*/}\n      {/*      &nbsp;*/}\n      {/*    </Typography>*/}\n      {/*  </Toolbar>*/}\n      {/*</AppBar>*/}\n\n      {/*<Divider />*/}\n\n      <main className={classes.content} ref={ref} style={{ cursor: cursor }}>\n        <div ref={drop}>\n          <Stage />\n        </div>\n      </main>\n    </React.Fragment>\n  );\n};\n","import useResizeObserver from \"@react-hook/resize-observer\";\nimport React, { useEffect, useLayoutEffect } from \"react\";\nimport {\n  setBoundingClientRect,\n  setStageWidth,\n  setStageScale,\n} from \"../../store/slices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  boundingClientRectSelector,\n  imageSelector,\n  stageWidthSelector,\n} from \"../../store/selectors\";\n\nexport const useBoundingClientRect = (target: React.RefObject<HTMLElement>) => {\n  const dispatch = useDispatch();\n\n  const boundingClientRect = useSelector(boundingClientRectSelector);\n  const stageWidth = useSelector(stageWidthSelector);\n  const image = useSelector(imageSelector);\n\n  useLayoutEffect(() => {\n    if (!target || !target.current) return;\n\n    dispatch(\n      setBoundingClientRect({\n        boundingClientRect: target.current.getBoundingClientRect(),\n      })\n    );\n  }, [dispatch, target]);\n\n  useResizeObserver(target, (entry: ResizeObserverEntry) => {\n    dispatch(\n      setBoundingClientRect({\n        boundingClientRect: entry.contentRect as DOMRect,\n      })\n    );\n  });\n\n  useEffect(() => {\n    if (!boundingClientRect) return;\n    dispatch(setBoundingClientRect({ boundingClientRect: boundingClientRect }));\n  }, [boundingClientRect, dispatch]);\n\n  useEffect(() => {\n    dispatch(setStageWidth({ stageWidth: boundingClientRect.width }));\n    if (!image || !image.shape) return;\n    dispatch(\n      setStageScale({ stageScale: (0.95 * stageWidth) / image.shape.width })\n    );\n  }, [boundingClientRect, dispatch, stageWidth, image?.shape]);\n};\n","import { makeStyles } from \"@material-ui/core/styles\";\n\nconst settingsWidth = 240;\nconst operationsWidth = 56;\n\nexport const useStyles = makeStyles((theme) => ({\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n  },\n  root: {\n    display: \"flex\",\n  },\n  content: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.default,\n    padding: theme.spacing(3),\n    width: \"100%\",\n  },\n  settings: {\n    width: settingsWidth,\n    flexShrink: 0,\n  },\n  settingsPaper: {\n    width: settingsWidth,\n    right: operationsWidth,\n  },\n  toolbar: {\n    ...theme.mixins.toolbar,\n  },\n  settingsToolbar: {\n    alignItems: \"center\",\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n  },\n  operations: {\n    flexShrink: 0,\n    whiteSpace: \"nowrap\",\n    width: operationsWidth,\n  },\n  operationsPaper: {\n    width: operationsWidth,\n  },\n  operationsToolbar: {\n    alignItems: \"center\",\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n  },\n  logo: {\n    flexGrow: 1,\n  },\n  applicationDrawer: {\n    flexShrink: 0,\n    width: theme.spacing(32),\n  },\n  applicationDrawerHeader: {\n    ...theme.mixins.toolbar,\n    alignItems: \"center\",\n    display: \"flex\",\n    paddingLeft: theme.spacing(3),\n  },\n  applicationDrawerPaper: {\n    zIndex: 0,\n    width: theme.spacing(32),\n  },\n}));\n","import { createMuiTheme } from \"@material-ui/core/styles\";\n\nexport const theme = createMuiTheme({\n  overrides: {\n    MuiDrawer: {\n      paperAnchorDockedLeft: {\n        borderRight: \"1px solid rgba(16, 16, 16)\",\n      },\n      paperAnchorDockedRight: {\n        borderLeft: \"1px solid rgba(16, 16, 16)\",\n      },\n    },\n    MuiListItem: {\n      root: {\n        \"&$selected\": {\n          backgroundColor: \"rgba(60, 61, 62)\",\n        },\n      },\n    },\n    MuiListItemIcon: {\n      root: {\n        minWidth: 36,\n      },\n    },\n    MuiSlider: {\n      rail: {\n        color: \"rgba(73, 73, 73)\",\n      },\n      thumb: {\n        color: \"rgba(201, 201, 201)\",\n      },\n      track: {\n        color: \"rgba(159, 159, 159)\",\n      },\n    },\n  },\n  palette: {\n    background: {\n      paper: \"rgba(40, 40, 40)\",\n      default: \"rgba(50, 50, 50)\",\n    },\n    divider: \"rgba(72, 72, 72)\",\n    text: {\n      primary: \"rgba(190, 190, 190)\",\n    },\n    type: \"dark\",\n  },\n});\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { CssBaseline } from \"@material-ui/core\";\nimport { ImageType } from \"../../../types/ImageType\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { CategoriesList } from \"../CategoriesList\";\nimport { ToolOptions } from \"../ToolOptions\";\nimport { Tools } from \"../Tools\";\nimport {\n  addImages,\n  applicationSlice,\n  setActiveImage,\n  setOperation,\n  setSelectedAnnotations,\n} from \"../../../store\";\nimport { Content } from \"../Content\";\nimport { ThemeProvider } from \"@material-ui/core/styles\";\nimport { useStyles } from \"./ImageViewer.css\";\nimport { theme } from \"./theme\";\nimport * as ImageJS from \"image-js\";\nimport { ShapeType } from \"../../../types/ShapeType\";\nimport { loadLayersModelThunk } from \"../../../store/thunks\";\nimport { ToolType } from \"../../../types/ToolType\";\nimport { v4 } from \"uuid\";\nimport { imagesSelector } from \"../../../store/selectors/imagesSelector\";\n\ntype ImageViewerProps = {\n  image?: ImageType;\n};\n\nexport const ImageViewer = (props: ImageViewerProps) => {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    const path =\n      \"https://raw.githubusercontent.com/zaidalyafeai/HostedModels/master/unet-128/model.json\";\n\n    dispatch(loadLayersModelThunk({ name: \"foo\", path: path }));\n  });\n\n  useEffect(() => {\n    if (props.image) {\n      dispatch(\n        applicationSlice.actions.setActiveImage({ image: props.image.id })\n      );\n    }\n  }, [dispatch, props.image]);\n\n  const images = useSelector(imagesSelector);\n\n  const classes = useStyles();\n\n  const [, setDropped] = useState<File[]>([]);\n\n  const onDrop = useCallback(\n    (item) => {\n      if (item) {\n        for (let i = 0; i < item.files.length; i++) {\n          const file = item.files[i];\n\n          file.arrayBuffer().then((buffer: any) => {\n            ImageJS.Image.load(buffer).then((image) => {\n              const shape: ShapeType = {\n                channels: image.components,\n                frames: 1,\n                height: image.height,\n                planes: 1,\n                width: image.width,\n              };\n\n              const imageDataURL = image.toDataURL(\"image/png\", {\n                useCanvas: true,\n              });\n\n              const loaded: ImageType = {\n                avatar: image\n                  .resize({ width: 50 })\n                  .toDataURL(\"image/png\", { useCanvas: true }),\n                id: v4(),\n                annotations: [],\n                name: file.name,\n                shape: shape,\n                originalSrc: imageDataURL,\n                src: imageDataURL,\n              };\n\n              console.error(\n                images.map((image: ImageType) => {\n                  return image.name.split(\".\")[0];\n                })\n              );\n\n              dispatch(addImages({ newImages: [loaded] }));\n\n              if (i === 0) {\n                dispatch(\n                  setActiveImage({\n                    image: loaded.id,\n                  })\n                );\n\n                dispatch(\n                  setSelectedAnnotations({\n                    selectedAnnotations: [],\n                    selectedAnnotation: undefined,\n                  })\n                );\n\n                dispatch(\n                  setOperation({ operation: ToolType.RectangularAnnotation })\n                );\n              }\n            });\n          });\n        }\n      }\n    },\n    [setDropped]\n  );\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div className={classes.root}>\n        <CssBaseline />\n\n        <CategoriesList />\n\n        <Content onDrop={onDrop} />\n\n        <ToolOptions />\n\n        <Tools />\n      </div>\n    </ThemeProvider>\n  );\n};\n","import i18n, { InitOptions } from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport { de, en, fi, hi, hu, se, gr } from \"./translations\";\n\nconst resources = {\n  de: de,\n  en: en,\n  fi: fi,\n  hi: hi,\n  hu: hu,\n  se: se,\n  gr: gr,\n};\n\nconst options: InitOptions = {\n  resources,\n  interpolation: { escapeValue: false },\n  keySeparator: false,\n  lng: \"en\",\n};\n\ni18n\n  .use(initReactI18next)\n  .init(options)\n  .then(() => {});\n\nexport default i18n;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { ImageViewer } from \"./components\";\nimport { Provider } from \"react-redux\";\nimport { store } from \"./store\";\nimport * as Sentry from \"@sentry/react\";\nimport \"./i18n\";\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\n\nSentry.init({\n  dsn:\n    \"https://756e21ab7263457eab9bc2f65edddc79@o71028.ingest.sentry.io/5668724\",\n  release: \"image-viewer@\" + process.env.npm_package_version,\n});\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <DndProvider backend={HTML5Backend}>\n        <ImageViewer />\n      </DndProvider>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}